<!--

Yagols V3

Copyright (c) 2018 John Erps

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribut	e, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Yagols - Yet another Game of Life simulator</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="description" content="Yet another Game of Life simulator"/>
  <meta name="author" content="John Erps"/>
  <meta name="keywords" content="yagols john conway's game of life simulator cellular automaton"/>
</head>
<style>
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
::selection {
  background-color: #FFAAAA;
  text-shadow: none; }

a {
  text-decoration: none;
  color: black; }
a:hover {
  text-decoration: none;
  color: black; }
a:active {
  text-decoration: none;
  color: black; }
a:visited {
  text-decoration: none;
  color: black; }

body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
* {
  font-family: 'Verdana';
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
#cpyr {
  font-size: 0.8rem;
  position: fixed;
  bottom: 6px;
  right: 18px;
  text-align: right;
  width: 100%;
  color: #505070;
  user-select: none;
  outline: none;  
}
@keyframes showdiv {
  0% {
    visibility: hidden;
    opacity: 0;
  }
  1% {
    visibility: visible;
    opacity: 0.01;
  }
  100% {
    visibility: visible;
    opacity: 0.8;
  }
}
@keyframes hidediv {
  0% {
    visibility: visible;
    opacity: 0.8;
  }
  99% {
    visibility: visible;
    opacity: 0.01;
  }
  100% {
    visibility: hidden;
    opacity: 0;
  }
}
#footer {
  font-size: 0.8rem;
  position: fixed;
  bottom: 6px;
  right: 18px;
  text-align: right;
  width: 100%;
}
#pattern {
  visibility: hidden;
  flex-direction: column;
  justify-content: space-around;
  position: fixed;
  width: 50%;
  height: 70%;
  top: 15%;
  left: 25%;
  z-index: 20;
}
#patternt {
  width: 100%;
  height: 80%;
  border-radius: 10px;
  border: 5px #FFAAAA solid;
  color: #CCCCCC;
  background-color: #444444;
  outline-width: 0;
  font-size: 15px;
  padding: 15px;
  white-space: nowrap;
  overflow: auto;
}
#patternb {
  display: flex;
  flex-direction: row;
  justify-content: center;
  margin: auto;
}
.patternbx {
  margin: 10px;
  width: 160px;
  height: 50px;
  line-height: 50px;
  text-align: center;
  vertical-align: middle;
  border-radius: 10px;
  border: 5px #FFAAAA solid;
  font-size: 20px;
  color: #EE4400;
  background-color: #444444;
  user-select: none;
}
#crule {
  display: none;
  flex-direction: column;
  justify-content: space-around;
  position: fixed;
  width: 30%;
  bottom: 5%;
  left: 15%;
  opacity: 0.8;
  z-index: 30;
}
#crulet {
  width: 100%;
  border-radius: 10px;
  border: 5px #AAFFAA solid;
  color: #AAAAAA;
  background-color: #444444;
  outline-width: 0;
  font-size: 22px;
  padding: 15px;
  white-space: nowrap;
  overflow: hidden;
  text-align: center;
}
#cruleb {
  display: flex;
  flex-direction: row;
  justify-content: center;
  margin: auto;
}
.crulebx {
  margin: 10px;
  width: 160px;
  height: 50px;
  line-height: 50px;
  text-align: center;
  vertical-align: middle;
  border-radius: 10px;
  border: 5px #AAFFAA solid;
  font-size: 20px;
  color: #44AA44;
  background-color: #444444;
  user-select: none;
}
</style>
<body style="overflow:hidden;">
  <canvas id="canvas0" style="position: fixed; left: 0; top: 0; height: 100%; width: 100%; z-index: 0;">
  </canvas>
  <canvas id="canvas1" style="position: fixed; left: 0; top: 0; height: 100%; width: 100%; z-index: 1;">
  </canvas>
  <canvas id="canvas2" style="position: fixed; left: 0; top: 0; height: 100%; width: 100%; z-index: 2; opacity: 0;">
  </canvas>
  <div id="cpyr">
    <a href="http://erps.me" target="_blank" tabindex="-1">&#x00A9 2018 John Erps</a>
  </div>
  <div id="crule">
  <div id="crulet"></div>
  <div id="cruleb">
  <div id="cruleba" class="crulebx" onclick="crulebut(1);false;">Accept</div>
  <div id="crulebf" class="crulebx" onclick="crulebut(2);false;">Cancel</div>
  </div>
  </div>
  <div id="pattern">
  <textarea id="patternt"></textarea>
  <div id="patternb">
  <div class="patternbx" onclick="fpattbf(1);false;">Patt!&nbsp;&nbsp;/Add</div>
  <div class="patternbx" onclick="fpattbf(2);false;">Patt&nbsp;&nbsp;/Replace</div>
  <div class="patternbx" onclick="fpattbf(3);false;">Patt&nbsp;&nbsp;/Reset</div>
  </div>
  </div>
</body>
<script>
var title = [ "Yet another", "Game\u22C5of\u22C5Life", "simulator", "Conway\u22C5s", "\u22C5  Enjoy  \u22C5", "\u22C5   With Yagols   \u22C5", "\u22C5        \u22C5       Click  ?  For Help       \u22C5        \u22C5"];
var font = "Verdana";
var gennum = 0, gennumc = 0, speed = 20, run = false, runcd = null, runcdn = 500, runcdc = 0, runbc = 0, runcd2 = null, runcdn2 = 100, runcd3 = null, runcdn3 = 800, runcd4 = null, runcdn4 = 1400, runcd5 = null, runcdn5 = 800, posx = 0, posy = 0, posx2 = 0, posy2 = 0, cellisz = 0, celliszm = 5, cellsz = 0, scale = 80, cells = [];
var canvas0, canvas1, canvas2, canvasos0, canvasos1, canvasos2, ctx0, ctx1, ctx2, ctxos0, ctxos1, mingen = 0;
var titlefd = 0, titlefdt = null, titlefds = 1000, titlemode = 0, tmet = null, titlex = 625, titleh = true, titlecd = null, titlecdn = 37000, titlecd2 = null, titlecdn2 = 7000, titlecd3 = null, titlecdn3 = 1200, titlemf = false;
var mdown = false, ton = false, toncd = 0, tonx = 0, tony = 0, tonw = 0;
var scl = false, sclx = 0, scly = 0, sclr = 0, sclpx = 0, sclpy = 0, sclbx = 0, sclby = 0, sclbw = 0, sclbh = 0, scld = 0;
var spd = false, spdx = 0, spdy = 0, spdr = 0, spdbx = 0, spdby = 0, spdbw = 0, spdbh = 0, spdd = 0;
var diffx = 0, diffy = 0, curx = 0, cury = 0;
var dspgrd = false;
var runt = false, runtx = 0, runty = 0, runtw = 0, runth = 0;
var dspvc = 0, rsct = null, frpsn = 0;
var gts = null, gtsd = null, wts1 = null;
var chgcsz = true, chggsz = true, chgpos = true, prvgsz = null, prvposx = null, prvposy = null, drawbackg = true;
var dsppost = false, dsppostx = 0, dspposty = 0, dsppostw = 0, dspposth = 0, dspposcd = null, dspposcdn = 200;
var patt = false;
var fpatt = null, fpattf = 0, fpattpos = 0, fpattd = null, fpattnt = 0, fpatth = 0, fpattw = 0, fpattnl = false, fpattm = 0, fpattnum = 0, fpatthx = 0, fpattnr = true, fpattx = 0, fpattnx = 0, fpattz = 0, fpattzx = null, fpattzy = 0, fpattzxp = 0, fpattzyp = 0, fpattnn = true, fpattz2 = 0, fpatta = [];
var dwrld = false, wrldx = 0, wrldy = 0, wrldw = 0, wrldh = 0, wrldm = 24, wrldcd = null, wrldcdn = 200, wrlda = false, wrldax = 0, wrlday = 0, wrldaw = 0, wrldah = 0;
var grb = 4;
var dsppxct = false, dsppxctx = 0, dsppxcty = 0, dsppxctw = 0, dsppxcth = 0, dsppxccd = null, dsppxccdn = 200;
var ngen = false, ngencd = null, ngencdn = 700, ngencd2 = null, ngencd3 = 0, ngencd4 = null, ngencdn4 = 200, ngencd5 = null, ngencdn5 = 200, ngenb = false, ngenbx = 0, ngenby = 0, ngenbw = 0, ngenbh = 0;
var pgen = false, pgencd = null, pgencdn = 700, pgencd2 = null, pgencd3 = 0, pgencd4 = null, pgencdn4 = 200, pgencd5 = null, pgencdn5 = 200, pgenb = false, pgenbx = 0, pgenby = 0, pgenbw = 0, pgenbh = 0;
var genbbl = false;
var cruleb = "3", crules = "23", crulebn = "", crulesn = "", crulem = 0, ccruleb = [false, false, false, true, false, false, false, false, false, false], ccrules = [false, false, true, true, false, false, false, false, false, false], ccrulebx = true, ccrulesx = true;
var hist = [[[[[],null,0,[0,0],false,0,0,0,0,0,0,[0,0,0,0],0,0]],0,-1,-1]], histh = 0, histhm = 0, histod = 0, histcr = [cruleb,crules], histi = 0, histp = 0, tarr = [], tidx = {}, histgp = 0, histgn = 0, hupdc = 0;
var cellsn = 0;
var hlcrcd = null, hlcrcdn = 1500, hlcrcd2 = null, hlcrcdn2 = 1500, hlcrcd3 = null, hlcrcdn3 = 1500;
var gnpsd = false, gnpsn = 0, gnpsg = 0, gnpscd = null, gnpscdn = 1500;
var captx = 0, capty = 0, captw = 0, capth = 0, capcd = null, capcdn = 1200, capcd2 = null, capcdn2 = 2500, capcds2 = "";
var ffw = 0, ffwm = 0, ffwstp = false, ffwstpc0 = 0, ffwstpc1 = 0, ffwstpc2 = 0, ngenfx = 0, ngenfy = 0, ngenfw = 0, ngenfh = 0, ngenfcd = null, ngenfcdn = 200, ngenfcd2 = null, ngenfcdn2 = 200, pgenfx = 0, pgenfy = 0, pgenfw = 0, pgenfh = 0, pgenfcd = null, pgenfcdn = 200, pgenfcd2 = null, pgenfcdn2 = 200;
var ffwsbcd = null, ffwsbcdn = 500, ffwsbf = false, ffwsbm = 0;
var osctlx = 0, osctly = 0, osctlw = 0, osctlh = 0, osctrx = 0, osctry = 0, osctrw = 0, osctrh = 0;
var orulex = 0, oruley = 0, orulew = 0, oruleh = 0;
var tfs3 = 0;
var slidh = 0.45;
var cidxb = [[[null,null,null],-1,-1,null]], cidxbi = 0, cidxbx1 = 0, cidxbx2 = 0, cidxby1 = 0, cidxby2 = 0, cidxbb = null;
var cellslen = 0, cellsa = [], cellsan = 0, cellsfs = [], cellsfsl = 0, cellsx = [], cellsxl = 0, cellsx2 = [], cellsx2l = 0, cellsf = false, cellsxf = false;
var frl = [], frll = 0, frlfs = [], frlfsl = 0;
var ddiama = 0, ddiamb = 0, ddiamcd = null, ddiamcdn = 800, ddiamx = 0, ddiamy = 0, ddiamw = 0, ddiamh = 0, ddiamcd2 = null, ddiamcdn2 = 1200, ddiamf = 0;
var swzmt = false, swzmtx = 0, swzmty = 0, swzmtw = 0, swzmth = 0, swzmcd = null, swzmcdn = 200, swzmcd2 = null, swzmcdn2 = 200, swzmf = true, swzmsw = true;
var hbcksl = null, hbcksll = 0, hbckslf = 0, hbcksm = null;
var stpgn = 0, stpgn2 = 0, stpgnm = 0, stpgnm2 = 0, stpge = false, stpga = false, stpgax = false, stpgcd = null, stpgcdn = 500, stpgcd2 = null, stpgcdn2 = 500, stpgcd3 = null, stpgcdn3 = 1000, stpgsf = false, stpgnc = 0, stpgnc2 = 0, stpgssx = 0, stpgssy = 0, stpgssw = 0, stpgssh = 0, stpgssx2 = 0, stpgssy2 = 0, stpgssw2 = 0, stpgssh2 = 0, stpgdx = 0, stpgdy = 0, stpgdw = 0, stpgdh = 0;
var tickc = 0, tickc2 = 0, tickct = null, tickcr = 0, tickcm1 = 0, tickcm2 = 0, tickcmf1 = 0, tickcmf2 = 0, tickcmf3 = 0, tickclp = 0;
var msgl = [], msgll = 0, msgf1 = 0, msgcd1 = null, msgcdn1 = 30000, msgcd2 = null, msgcdn2 = 2000, msgl1 = "", msgl2 = "", msgl3 = "";
var genbtcd = null, genbtcdn = 250, genbtl = false;
var fbutt = [], fbuttcdn = 200;
var strimgt = {};
var mstabu = 1, mstabd = 1;
var keyesupp = false;
var dmsgs = true;
var clrucd = null, clrucdn = 1000;
var dhlpn = 0, dhlpn2 = 0, dhlpq = [], dhlpql = 0, dhlpcdn = 2000, dhlpcd2 = null, dhlpcdn2 = 180000, dhlplf = 1, dhlpcd3 = null, dhlpcdn3 = 400;
var cwidth = 0, cheight = 0;
var histmax = 500;
var maxl = -9999999, maxt = 9999999, maxr = 9999999, maxb = -9999999;
var cellsl = 0, cellsr = 0, cellst = 0, cellsb = 0;
var stmsgn1 = "Y \u22C5 a \u22C5 g \u22C5 o \u22C5 l \u22C5 s                ", stmsgn2 = "Yet \u22C5 another \u22C5 GoL \u22C5 simulator     ", stmsgo1 = "", stmsgo2 = "", stmsgcd = null, stmsgcdn = 1000, stmsgcd2, stmsgcdn2 = 1300, stmsgntm1 = null, stmsgntm2 = null, stmsgotm1 = null, stmsgotm2 = null;

function clrvars() {
  gennum = 0, gennumc = 0, run = false, runcd = null, runcdc = 0, runbc = 0, runcd2 = null, runcd3 = null, runcd4 = null, runcd5 = null, posx = 0, posy = 0, posx2 = 0, posy2 = 0, cells = [];
  mingen = 0;
  runt = false, runtx = 0, runty = 0, runtw = 0, runth = 0;
  chgpos = true;
  fpatt = null, fpattf = 0, fpattpos = 0, fpattd = null, fpattnt = 0, fpatth = 0, fpattw = 0, fpattnl = false, fpattm = 0, fpattnum = 0, fpatthx = 0, fpattnr = true, fpattx = 0, fpattnx = 0, fpattz = 0, fpattzx = null, fpattzy = 0, fpattzxp = 0, fpattzyp = 0, fpattnn = true, fpattz2 = 0, fpatta = [];
  ngen = false, ngencd = null, ngencd2 = null, ngencd3 = 0, ngencd4 = null, ngencd5 = null, ngenb = false, ngenbx = 0, ngenby = 0, ngenbw = 0, ngenbh = 0;
  pgen = false, pgencd = null, pgencd2 = null, pgencd3 = 0, pgencd4 = null, pgencd5 = null, pgenb = false, pgenbx = 0, pgenby = 0, pgenbw = 0, pgenbh = 0;
  genbbl = false;
  hist = [[[[[],null,0,[0,0],false,0,0,0,0,0,0,[0,0,0,0],0,0]],0,-1,-1]], histh = 0, histhm = 0, histod = 0, histcr = [cruleb,crules], histi = 0, histp = 0, tarr = [], tidx = {}, histgp = 0, histgn = 0, hupdc = 0;
  cellsn = 0;
  ffw = 0, ffwm = 0, ffwstp = false, ffwstpc0 = 0, ffwstpc1 = 0, ffwstpc2 = 0, ngenfx = 0, ngenfy = 0, ngenfw = 0, ngenfh = 0, ngenfcd = null, ngenfcd2 = null, pgenfx = 0, pgenfy = 0, pgenfw = 0, pgenfh = 0, pgenfcd = null, pgenfcd2 = null;
  ffwsbcd = null, ffwsbcdn = 500, ffwsbf = false, ffwsbm = 0;
  osctlx = 0, osctly = 0, osctlw = 0, osctlh = 0, osctrx = 0, osctry = 0, osctrw = 0, osctrh = 0;
  cidxb = [[[null,null,null],-1,-1,null]], cidxbi = 0, cidxbx1 = 0, cidxbx2 = 0, cidxby1 = 0, cidxby2 = 0, cidxbb = null;
  cellslen = 0, cellsa = [], cellsan = 0, cellsfs = [], cellsfsl = 0, cellsx = [], cellsxl = 0, cellsx2 = [], cellsx2l = 0, cellsf = false, cellsxf = false;
  frl = [], frll = 0, frlfs = [], frlfsl = 0;
  hbcksl = null, hbcksll = 0, hbckslf = 0, hbcksm = null;
  stpgsf = false;
  msgl = [], msgll = 0, msgf1 = 0, msgl1 = "", msgl2 = "", msgl3 = "";
  dhlpn = 0, dhlpn2 = 0, dhlpq = [], dhlpql = 0, dhlpcd2 = null, dhlplf = 1, dhlpcd3 = null;
  cellsl = 0, cellsr = 0, cellst = 0, cellsb = 0;
  calcWrld();
  if (!clrucd) {
    clrucd = performance.now();
  }
  dspmsg(["Universe      ","\u22C5      \u22C5","      Cleared"]);
  msgf1 = 0;
}

var patttxt =
      "#  Welcome to Yagols, Yet another Game of Life simulator !\r\n" +
      "\r\n" +
      "\r\n" +
      "#  https://github.com/jerps/Yagols\r\n" +
      "\r\n" +
      "\r\n" +
      "#  About Conway's Game of Life :\r\n" +
      "\r\n" +
      "#      http://www.conwaylife.com\r\n" +
      "\r\n" +
      "#      http://beltoforion.de/article.php?a=game_of_life\r\n" +
      "\r\n" +
      "#      http://web.stanford.edu/~cdebs/GameOfLife/#rules\r\n" +
      "\r\n" +
      "#      https://youtu.be/C2vgICfQawE\r\n" +
      "\r\n" +
      "#      https://www.google.nl/search?q=conway+game+of+life\r\n" +
      "\r\n" +
      "\r\n" +
      "#  See FURTHER DOWN this text for GENERAL INSTRUCTIONS.\r\n" +
      "\r\n" +
      "\r\n" +
      "#  This text box is used to paste text in (Extended) RLE format\r\n" +
      "#  (Run Length Encoding) which encodes a cell pattern.\r\n" +
      "#  See http://golly.sourceforge.net/Help/formats.html#rle.\r\n" +
      "\r\n" +
      "#  This preloaded text is already in Extended RLE format. Just click\r\n" +
      "#  \"Run!\" to start decoding the text and, when decoded, add the pattern,\r\n" +
      "#  named \"Gosper glider gun\", to the part of the universe that is in the\r\n" +
      "#  center of the current viewing area, by switching cells on and/or off.\r\n" +
      "\r\n" +
      "#  Cells are always two-state (cell is on or off). Any given dimension\r\n" +
      "#  or rule with line \"x = ...\" is simply ignored. Only the actual encoded\r\n" +
      "#  pattern data is relevant, which is decoded into a grid width and height,\r\n" +
      "#  and the \"on\" cell positions in the grid which constitute the pattern.\r\n" +
      "\r\n" +
      "#  The decoder is very forgiving. Blank lines and lines where the\r\n" +
      "#  first non-whitespace character(s) begin with \"#\", \g=\" or \"x \"\r\n" +
      "#  are ignored. All other lines are considered to contain run-length\r\n" +
      "#  encoded pattern data. Only characters \"b\" / \".\" (\"off\" cell), \"o\" / \"A\"\r\n" +
      "#  (\"on\" cell), \"0\"..\"9\", \"$\" and \"!\" are processed. Any other character\r\n" +
      "#  and whitespace is ignored.\r\n" +
      "\r\n" +
      "#  Clicking one of the \"Run!\" buttons starts the process. It can be\r\n" +
      "#  stopped or restarted any time by clicking \"Run!\" again with an\r\n" +
      "#  empty text or a different text. As long as the P at the top-right\r\n" +
      "#  of the screen is red the process is still running. When finished\r\n" +
      "#  a completion message is added to the beginning of the text in\r\n" +
      "#  this text box.\r\n" +
      "\r\n" +
      "#  There are three \"Run!\" buttons. When the \"/Add\" button is clicked,\r\n" +
      "#  the process just adds the \"on\" cells of the pattern to the universe,\r\n" +
      "#  centered in the current viewing area. When the \"/Replace\" button\r\n" +
      "#  is clicked, all the cells in the target grid are first set off. That is the\r\n" +
      "#  grid positioned around the center of the viewing area having the\r\n" +
      "#  same height and width as the decoded grid/pattern. Then the \"on\"\r\n" +
      "#  cells of the pattern are added. The \"/Reset\" button first resets the\r\n" +
      "#  universe.\r\n" +
      "\r\n" +
      "#  Although allowed, a concurrently running simulation interferes with\r\n" +
      "#  the process. You might want to stop it first before clicking \"Run!\".\r\n" +
      "\r\n" +
      "\r\n" +
      "#   -----  GENERAL INSTRUCTIONS  -----\r\n" +
      "\r\n" +
      "#   Use a mouse.\r\n" +
      "\r\n" +
      "#   Double-click to set one cell on or off.\r\n" +
      "\r\n" +
      "#   Click and hold button to set multiple cells on or off. Release button\r\n" +
      "#     to stop.\r\n" +
      "\r\n" +
      "#   Click and drag the universe to change viewing area position.\r\n" +
      "\r\n" +
      "#   Click || (stopped) to start the simulation, automatically calculating\r\n" +
      "#     new generations.\r\n" + 
      "\r\n" +
      "#   Click >> (playing) to stop the simulation.\r\n" +
      "\r\n" +
      "#   Click > to calculate one new generation. Hold to repeat.\r\n" +
      "\r\n" +
      "#   Click and drag left vertical slider to change simulation speed.\r\n" +
      "\r\n" +
      "#   Click and drag right vertical slider to zoom in or out.\r\n" +
      "\r\n" +
      "#   Click position (x,y) to go to position 0,0 (center) of the universe.\r\n" +
      "\r\n" +
      "#   Click # to switch the grid on or off. The grid only shows when not\r\n" +
      "#     too far zoomed out (>16 pixels/cell).\r\n" +
      "\r\n" +
      "#   Click P to show a text box with instructions and to add a pattern\r\n" +
      "#     to the universe by pasting RLE formatted text. Click P again to\r\n" +
      "#     hide the text box.\r\n" +
      "\r\n" +
      "#   Click W to show the whole GoL world, i.e. all \"on\" cells in the universe,\r\n" +
      "#     fitted within the viewing area. Click anywhere within the GoL world to\r\n" +
      "#     change the viewing area position. Click W again to hide.\r\n" +
      "\r\n" +
      "#   The default rule is B3/S23 (born with 3 neighbour cells, survive with\r\n" +
      "#     2 or 3 neighbour cells). To change the rule just type \"b\", \"B\", \"s\"\r\n" +
      "#     or \"S\" and one or more digits \"0\"..\"8\". Press Enter or click \"Accept\"\r\n" +
      "#     to accept the new rule. Click \"Forget\" or any key that is not \"b\", \"B\",\r\n" +
      "#     \"s\", \"S\", \"0\"..\"9\", \"d\" or \"D\" or Enter to forget about it. Press \"d\"\r\n" +
      "#     or \"D\" to accept the default rule. Doesn\"t work when P (text box with\r\n" +
      "#     pattern) is active. The new rule will be applied and set when the next\r\n" +
      "#     new generation is calculated. Going back or forth in history sets the\r\n" +
      "#     rule that was set in the visible generation. When a new rule has been\r\n" +
      "#     accepted (but not set) the previous rule shows next to the new rule,\r\n" +
      "#     in darker green and smaller font. Double click on it to re-set the\r\n" +
      "#     previous rule.\r\n" +
      "\r\n" +
      "#   When Yagols is (re)started (refresh page) the viewing area shows the\r\n" +
      "#     initial cells at a certain size. A bigger viewing area will show bigger\r\n" +
      "#     cells. Cells of that initial size are considered to be 80% zoomed-in.\r\n" +
      "#     The top left of the viewing area shows the number of pixels per cell\r\n" +
      "#     (px/c). Click on it to recalculate the initial cell size, using the\r\n" +
      "#     current size of the viewing area.\r\n" +
      "\r\n" +
      "\r\n" +
      "#   -----  Tips -----\r\n" +
      "\r\n" +
      "#   To clear/reset the universe click P, delete all text, then click \"Run! /Reset\".\r\n" +
      "#     Or refresh the browser.\r\n" +
      "\r\n" +
      "#   To clear the viewing area, click P, replace any text with, for example,\r\n" +
      "#     \"100b60$\", then click \"Run! /Replace\". This will clear an area, centered\r\n" +
      "#     in the viewing area, as large as 100x60 cells.\r\n" +
      "\r\n" +
      "#   To let this text appear again, click P, delete all text, click \"Run! /Add\"\r\n" +
      "#     and then click P again.\r\n" +
      "\r\n" +
      "#   To accept the default rule, just type \"bd\" or \"sd\" (uppercase or lowercase).\r\n" +
      "\r\n" +
      "\r\n" +
      "#N Gosper glider gun\r\n" +
      "#O Bill Gosper\r\n" +
      "#C A true period 30 glider gun.\r\n" +
      "#C The first known gun and the first known finite pattern with unbounded growth.\r\n" +
      "#C www.conwaylife.com/wiki/index.php?title=Gosper_glider_gun\r\n" +
      "x = 36, y = 9, rule = B3/S23\r\n" +
      "24bo11b$22bobo11b$12b2o6b2o12b2o$11bo3bo4b2o12b2o$2o8bo5bo3b2o14b$2o8b\r\n" +
      "o3bob2o4bobo11b$10bo5bo7bo11b$11bo3bo20b$12b2o!";

window.onload = function(e) {

  var x;

  (function(window) {
    var timeouts = [];
    var messageName = "yagols-0tmomsg";
    function setZeroTimeout(fn) {
      timeouts.push(fn);
      window.postMessage(messageName, "*");
    }
    function handleMessage(event) {
      if (event.source == window && event.data == messageName) {
        event.stopPropagation();
        if (timeouts.length > 0) {
          var fn = timeouts.shift();
          fn();
        }
      }
    }
    window.addEventListener("message", handleMessage, true);
    window.YagolsSetZeroTimeoutFunc = setZeroTimeout;
  })(window);

  // https://developer.mozilla.org/en-US/docs/Web/Events/wheel
  // creates a global "addWheelListener" method
  // example: addWheelListener( elem, function( e ) { console.log( e.deltaY ); e.preventDefault(); } );
  (function(window,document) {
    var prefix = "", _addEventListener, support;
    // detect event model
    if ( window.addEventListener ) {
        _addEventListener = "addEventListener";
    } else {
        _addEventListener = "attachEvent";
        prefix = "on";
    }
    // detect available wheel event
    support = "onwheel" in document.createElement("div") ? "wheel" : // Modern browsers support "wheel"
              document.onmousewheel !== undefined ? "mousewheel" : // Webkit and IE support at least "mousewheel"
              "DOMMouseScroll"; // let's assume that remaining browsers are older Firefox
    window.addWheelListener = function( elem, callback, useCapture ) {
        _addWheelListener( elem, support, callback, useCapture );
        // handle MozMousePixelScroll in older Firefox
        if( support == "DOMMouseScroll" ) {
            _addWheelListener( elem, "MozMousePixelScroll", callback, useCapture );
        }
    };
    function _addWheelListener( elem, eventName, callback, useCapture ) {
        elem[ _addEventListener ]( prefix + eventName, support == "wheel" ? callback : function( originalEvent ) {
            !originalEvent && ( originalEvent = window.event );
            // create a normalized event object
            var event = {
                // keep a ref to the original event object
                originalEvent: originalEvent,
                target: originalEvent.target || originalEvent.srcElement,
                type: "wheel",
                deltaMode: originalEvent.type == "MozMousePixelScroll" ? 0 : 1,
                deltaX: 0,
                deltaY: 0,
                deltaZ: 0,
                preventDefault: function() {
                    originalEvent.preventDefault ?
                        originalEvent.preventDefault() :
                        originalEvent.returnValue = false;
                }
            };
            // calculate deltaY (and deltaX) according to the event
            if ( support == "mousewheel" ) {
                event.deltaY = - 1/40 * originalEvent.wheelDelta;
                // Webkit also support wheelDeltaX
                originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );
            } else {
                event.deltaY = originalEvent.deltaY || originalEvent.detail;
            }
            // it's time to fire the callback
            return callback( event );
        }, useCapture || false );
    }
  })(window,document);

(function(window) {  
/**
 * Copyright (c) 2015, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * @providesModule normalizeWheel
 * @typechecks
 */

// Reasonable defaults
var PIXEL_STEP  = 10;
var LINE_HEIGHT = 40;
var PAGE_HEIGHT = 800;

/**
 * Mouse wheel (and 2-finger trackpad) support on the web sucks.  It is
 * complicated, thus this doc is long and (hopefully) detailed enough to answer
 * your questions.
 *
 * If you need to react to the mouse wheel in a predictable way, this code is
 * like your bestest friend. * hugs *
 *
 * As of today, there are 4 DOM event types you can listen to:
 *
 *   'wheel'                -- Chrome(31+), FF(17+), IE(9+)
 *   'mousewheel'           -- Chrome, IE(6+), Opera, Safari
 *   'MozMousePixelScroll'  -- FF(3.5 only!) (2010-2013) -- don't bother!
 *   'DOMMouseScroll'       -- FF(0.9.7+) since 2003
 *
 * So what to do?  The is the best:
 *
 *   normalizeWheel.getEventType();
 *
 * In your event callback, use this code to get sane interpretation of the
 * deltas.  This code will return an object with properties:
 *
 *   spinX   -- normalized spin speed (use for zoom) - x plane
 *   spinY   -- " - y plane
 *   pixelX  -- normalized distance (to pixels) - x plane
 *   pixelY  -- " - y plane
 *
 * Wheel values are provided by the browser assuming you are using the wheel to
 * scroll a web page by a number of lines or pixels (or pages).  Values can vary
 * significantly on different platforms and browsers, forgetting that you can
 * scroll at different speeds.  Some devices (like trackpads) emit more events
 * at smaller increments with fine granularity, and some emit massive jumps with
 * linear speed or acceleration.
 *
 * This code does its best to normalize the deltas for you:
 *
 *   - spin is trying to normalize how far the wheel was spun (or trackpad
 *     dragged).  This is super useful for zoom support where you want to
 *     throw away the chunky scroll steps on the PC and make those equal to
 *     the slow and smooth tiny steps on the Mac. Key data: This code tries to
 *     resolve a single slow step on a wheel to 1.
 *
 *   - pixel is normalizing the desired scroll delta in pixel units.  You'll
 *     get the crazy differences between browsers, but at least it'll be in
 *     pixels!
 *
 *   - positive value indicates scrolling DOWN/RIGHT, negative UP/LEFT.  This
 *     should translate to positive value zooming IN, negative zooming OUT.
 *     This matches the newer 'wheel' event.
 *
 * Why are there spinX, spinY (or pixels)?
 *
 *   - spinX is a 2-finger side drag on the trackpad, and a shift + wheel turn
 *     with a mouse.  It results in side-scrolling in the browser by default.
 *
 *   - spinY is what you expect -- it's the classic axis of a mouse wheel.
 *
 *   - I dropped spinZ/pixelZ.  It is supported by the DOM 3 'wheel' event and
 *     probably is by browsers in conjunction with fancy 3D controllers .. but
 *     you know.
 *
 * Implementation info:
 *
 * Examples of 'wheel' event if you scroll slowly (down) by one step with an
 * average mouse:
 *
 *   OS X + Chrome  (mouse)     -    4   pixel delta  (wheelDelta -120)
 *   OS X + Safari  (mouse)     -  N/A   pixel delta  (wheelDelta  -12)
 *   OS X + Firefox (mouse)     -    0.1 line  delta  (wheelDelta  N/A)
 *   Win8 + Chrome  (mouse)     -  100   pixel delta  (wheelDelta -120)
 *   Win8 + Firefox (mouse)     -    3   line  delta  (wheelDelta -120)
 *
 * On the trackpad:
 *
 *   OS X + Chrome  (trackpad)  -    2   pixel delta  (wheelDelta   -6)
 *   OS X + Firefox (trackpad)  -    1   pixel delta  (wheelDelta  N/A)
 *
 * On other/older browsers.. it's more complicated as there can be multiple and
 * also missing delta values.
 *
 * The 'wheel' event is more standard:
 *
 * http://www.w3.org/TR/DOM-Level-3-Events/#events-wheelevents
 *
 * The basics is that it includes a unit, deltaMode (pixels, lines, pages), and
 * deltaX, deltaY and deltaZ.  Some browsers provide other values to maintain
 * backward compatibility with older events.  Those other values help us
 * better normalize spin speed.  Example of what the browsers provide:
 *
 *                          | event.wheelDelta | event.detail
 *        ------------------+------------------+--------------
 *          Safari v5/OS X  |       -120       |       0
 *          Safari v5/Win7  |       -120       |       0
 *         Chrome v17/OS X  |       -120       |       0
 *         Chrome v17/Win7  |       -120       |       0
 *                IE9/Win7  |       -120       |   undefined
 *         Firefox v4/OS X  |     undefined    |       1
 *         Firefox v4/Win7  |     undefined    |       3
 *
 */
function normalizeWheel(/*object*/ event) /*object*/ {
  var sX = 0, sY = 0,       // spinX, spinY
      pX = 0, pY = 0;       // pixelX, pixelY

  // Legacy
  if ('detail'      in event) { sY = event.detail; }
  if ('wheelDelta'  in event) { sY = -event.wheelDelta / 120; }
  if ('wheelDeltaY' in event) { sY = -event.wheelDeltaY / 120; }
  if ('wheelDeltaX' in event) { sX = -event.wheelDeltaX / 120; }

  // side scrolling on FF with DOMMouseScroll
  if ( 'axis' in event && event.axis === event.HORIZONTAL_AXIS ) {
    sX = sY;
    sY = 0;
  }

  pX = sX * PIXEL_STEP;
  pY = sY * PIXEL_STEP;

  if ('deltaY' in event) { pY = event.deltaY; }
  if ('deltaX' in event) { pX = event.deltaX; }

  if ((pX || pY) && event.deltaMode) {
    if (event.deltaMode == 1) {          // delta in LINE units
      pX *= LINE_HEIGHT;
      pY *= LINE_HEIGHT;
    } else {                             // delta in PAGE units
      pX *= PAGE_HEIGHT;
      pY *= PAGE_HEIGHT;
    }
  }

  // Fall-back if spin cannot be determined
  if (pX && !sX) { sX = (pX < 1) ? -1 : 1; }
  if (pY && !sY) { sY = (pY < 1) ? -1 : 1; }

  return { spinX  : sX,
           spinY  : sY,
           pixelX : pX,
           pixelY : pY };
}
window.normalizeWheel = normalizeWheel;
})(window);

  document.getElementById("patternt").value = patttxt;
  canvas0 = document.getElementById("canvas0");
  canvas0.width = canvas0.offsetWidth;
  canvas0.height = canvas0.offsetHeight;
  canvas1 = document.getElementById("canvas1");
  canvas1.width = canvas0.offsetWidth;
  canvas1.height = canvas0.offsetHeight;
  canvas2 = document.getElementById("canvas2");
  canvas2.width = canvas0.offsetWidth;
  canvas2.height = canvas0.offsetHeight;
  canvasos0 = document.createElement('canvas');
  canvasos0.width = canvas0.offsetWidth;
  canvasos0.height = canvas0.offsetHeight;
  canvasos1 = document.createElement('canvas');
  canvasos1.width = canvas0.offsetWidth;
  canvasos1.height = canvas0.offsetHeight;
  canvasos2 = document.createElement('canvas');
  canvasos2.width = canvas0.offsetWidth;
  canvasos2.height = canvas0.offsetHeight;
  cwidth = canvas0.width;
  cheight = canvas0.height;
  calcICellsz();
  calcCellsz();
  ctx0 = canvas0.getContext("2d");
  ctx1 = canvas1.getContext("2d");
  ctx2 = canvas2.getContext("2d");
  ctxos0 = canvasos0.getContext("2d");
  ctxos1 = canvasos1.getContext("2d");
  ctxos2 = canvasos2.getContext("2d");
  ctx0.globalAlpha = 1;
  ctx1.globalAlpha = 1;
  ctx2.globalAlpha = 1;
  ctxos0.globalAlpha = 1;
  ctxos1.globalAlpha = 1;
  ctxos2.globalAlpha = 1;
  
  ctx0.textBaseline = "bottom";
  ctx0.font = "" + (x = Math.trunc(cwidth/1000 * 80)) +"px " + font;
  ctx0.fillStyle = "rgba(0, 0, 0, 1)";
  ctx0.fillRect(0, 0, cwidth, cheight);
  ctx0.fillStyle = "rgba(170, 110, 110, 0.6)";
  ctx0.fillText("Y a g o l s", (cwidth - ctx0.measureText("Y a g o l s").width) / 2, cheight / 2 + x / 2);

  titlefd = Math.floor(titlefds/3);
  titlefdt = performance.now();
  titlecd = performance.now();
  msgcd1 = performance.now();
  msgcd2 = performance.now();
  stmsgcd = performance.now();

  pstrimg("W-23-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAACRklEQVRIS9WVO2jUQRCH7wQbJYqFIpJCND5I5KKgjZVImqQIiDY+gkdCsFFRA1pYaCkKKXyUiUQhEUVBxDTRUiISEghqREERFVESLAwoiMbvJzMwt7dXXuEfPnZnd3ZuZnZ2rlio41eso+3C/298HelZBN9grkaqXOcX++9r6KxhfQn8gE9Ky1J4C6tgAHphITm8HPm16Uh3ixmIarL1CHbDSyhpQQxC2X4kd3Abe5PB0kbmbxIHViBPgCLsg36/0EMIN015k3kZz3ZbVL62l8m9xHh0YCd74258M8KMKe9nvBUOSmcIusLaFebHE+PuwFfWW2DWjSvvz6DZPIx5X8baFKyE29ADad5l5w4oogewB37HOr/MwjE72Mo4b55tNeNPGI/Ac1tfb7oS3QHl+yhc02I03ol83w4qLN24vjJcB6XiBDyFHRDzHvOtPV1shfG1yO/M4AHGEdv3fO9DvgsX4AxcgtOm7/n+iFwCvZcK44uRFbp+2eu9gbnyrXC9ijqYPwTP+0/m7oAK4SD8SY1LPg/n7KAutwmU43iBjcgf4DvoPr7AtDlwmPGGRVPVuNrYGLPNDRbFMONVUOnp5cYIFYVS6WWsB/iilvHVbHy2TeV9O5yCtPY9wrMWle5H0SkSRfTvS1uumtdj2OUKNqavtp31UTOkJpXtS7l+fhLl/mA816g879GHNLrsn4X6gqpG4alacp0y5t1/oKon5TxXd3tloepglUdmzfMuMduGc8bTRhVfa0xDrKyLbOhhVXx1/Q/9C+iIhRvc/zIHAAAAAElFTkSuQmCC");
  pstrimg("W-23-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAC5klEQVRIS9WUS2hTQRSGe5O0SB4rRYq1otIUK6LgwpWCi7rzgUGxXYhUcVUaEpPsFIIgtHls1E1EtHTV4qKouFF0ozvfm1bBJoJU0YLGklDUPPzOZW6YTNKVdOGFYWbOnP+fc/4591gda/hZa8jd8R+T1+t1K5vNHkMej2VZC7FY7LUple7DeiWRSDxoJ2c6nT4IxwZ8vuPzxBofH9/idrsLGF0AFkul0tZkMlnRwVzeX6vV5pVP1ePx9EQika+6DxiX3+//ic3P+NPV1RWwxOjz+T4B3ISxykW90Wj0iw7MZDJj7K86NnyHyHBG9yHqXdjfYHMznsXj8QP2gwK+w3RC1qQ0TErTBvl99oc12yTgkdUCgOMiHFcc8tM4TinyaQ6GHaDKbJGoujWyPJH3Yas7NgK0A4C4hn0fl7+0ydG0F+MCy05T91QqFXS5XPPY5U0+M3pEPl13FcA3SNdzVkTv7nA4/MsmV9XwgeV2AaJ7H7p/VBePcn6d9QrzGAQ3FSZEhrOy1gIQvR8T9aDYGz8RD3ID4HkFPAvwtqxJ9y7TUUY+EAjsWObDbx37hu7Gg8Mdz5rkRwDdUxrO4DCk603UU1x4hiDm8Btg/x6fAdHd0VuyZuzGPtdEPjExEUBb0U2isuvd6/VuU3q7nSqCSCQadXQvFotLlLL94PgslcvlzQT1u4lc6S5/5x4BQrqxWq0eVxo36h/yQ5w/lKdihCqVyiseN89aApglu5DKvrlxkXIWsgvq8CSz1P4pQAUi6pc/18jwGufPGXYZgz1Hid5qS05U+zl46ugO6V4AQeZG7esZsn4h/UgCkGzZB4m80JY8l8t1Ugw/APgcB5nNv5YgpBVIS+CIzrdKX2rp5wAlcsnA+Vr6DfINQvjICKDpz256UMcR4CWAl9WDyeUtndLQ3Ya260ktkUt3w/etSlVALREZlSXcbdtwC7nZqLhkhAqY1CWQtVFZ7/DZqTeytrKYJP+y/wucJZfkxKi2RQAAAABJRU5ErkJggg==");
  pstrimg("W-23-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAADCklEQVRIS9WVPWgUQRTHZ3YveGAgWgQhRSBBCWJyEQU/EsHb24gGxUosBEFEUMHCLwQ/IBCIYJEIFtHGRrRQsNDCgLndVRAjRIu7jSKBkEqjHsGQxBRyN8//zO2cu3trmcKFsNzM//33vd+8eeFsFR++it7sPzb3yEuRT1eBJ8UZn7Yy1qM4qphmBZpbSTidonMOHs3gMZ/ryt3h+am8ZQjDgVgi+slN3mptsZbDwZ7vHSKi51JDjIRpmLuyndnJiGbWS4slsQDzNdBW0izdwj0s0iLNwXqdCmTmnmwmOxEOdIvuPfw+rdeI05DdZd+ImBe8I4KLxzA3YD5td9sd6kDdgvsO5juVmNjNXHfuejjQKTgfOOfbQmuvcpmc9a8EkORDO2Mfr5oXXcnwStWb3mKjVwfKysSi+AbzppoZsRLP8BaLW2W9FkoAFuwEEnygzfeiFAcGZpy767sHJW+UK7UL+Fsf567QLlEJe43QroB3W2937w9lrrqhSF+BplkGGszYj47IB8hGsX4W67/xexQfOR9kOwA0g0rzNwEDWX9E1p1yvXaJgEaa2UHgCAIvBcje470dQaVKY2WTuWyWENWAtRr3yIETuw/zU1HzgnsNQUMB9wlw74nxfo0PZsH2C/C1QDfHu9C24K55y6o58aMwfxox96a8jVShT0FWqt9JkDwLyVuWq7oInTUGzQHNndaSHzrwJdEg2vo2981HzcFd+GIGRq0yMMVSW8usfFIyDvc/EFxE4LBqLMYGhCHecMHzqr8ZTaLiHbqDIoMLgc+wcTjYHIR4H4J2S948xdvlzQ1XiP0x7PvQqzbGcxvo5MfVEzF3fOcMmN3V3PFuR/CGcO/LztIV4qOzuK1z0PTI6uDWj5v7MtF8fGa8yfhlfJfzQQvUO3ZrMaBeQNMfoNFJ1s2lunkONJ+h7tDmSfMGmgvYHwknEL/ZdVjkAgLlyD0WZJU4KWOdVf1Gwkyqy9zDdAPHJ/o8kjKKcFe+yWO43jw2qNDnwxiflyNnUK0w3Fm1CxXWrer/0D/OWK2YUJT5+wAAAABJRU5ErkJggg==");
  pstrimg("P-23-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABF0lEQVRIS2NkoCFgpKHZDMPDcFlgELGjBdNvIP8HEH8A4p+kBiEsWDiAGq8CsRIeAyYB5TqB+BmxliAbfhKoSY8IjfpANZeIUAePUJDLYYZXAtlTgJgNiFmAWB6IS4E4FGrgPSANsuALIQuwuTwHqGkqmkaQuoVAHAsVNwXSZ6hlOMgceyA+ADXQAEhfpKbhhkDDztHK8AagwfWUBksq0IA5aF4OB/JXIEWoDpD9nZxg2Q3UtAeIQRlKCoiDgFgMySBnIHsfIYNB8qSk889A9f5AvJ8Yg3EZDoq0nVADQJa/hUbkcWKCAtlibC7HFubEOhZFHbGZaIQazg309ykg1gJibGULRcECStOHgRhUIFE9QslyGSFNAJAGPBivRcqNAAAAAElFTkSuQmCC");
  pstrimg("P-23-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABYElEQVRIS2NkoCFgpKHZDMPA8J6eHndgEPEiB9P///+/MzExvf/58+fNqqqqt6QGIThYuru7xRgZGZ8Bmcx4DLgHVJNSXFy8n1hL4IYDNTwGamYjQmNmSUnJDCLUQSIU5HIkw08xMzOH//v3jx+IOYBBYwsMmnKgvAjUwL9AeZXCwsIHhCzAZvheoMtckDU2NDSwcHNzg3wmARUvAqrpp4rhIEOAEd4KpKqgBmYDDZ9GNcOBQZcDdPlkqhsODHfG3t7e80CD9aGGAx1e0kuOy7cDNXrBNEINXgrkR8IilIWFRbqgoOAlyYYDDfsM9P5VIA1KlqAUIgPkMyEZ1AW0HJR6CAJS0vl/oGmdQIMrCZoKVYDN8J9AubtIBnwAso8Ag6KPmKBAthib4ShhTqwrsakjKhORa8EQNxyYQWSBSQ8UiaxAjFG2UBQsbW1twqysrE+A6ZkDaBB1I5RclxHSBwCJ/58YCIx7rwAAAABJRU5ErkJggg==");
  pstrimg("P-23-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABeElEQVRIS92UsUrDUBSGz03iIi2COPsEaYO4CA62N4O7ik+gUBA3H0HwARRd9Akc+gImcVS7mNiObl3q4qQ41Bz/G1qJNCFpTAcN3Cn3/85//3PuFTTDT8yQTf8A7vjOkRCiGo9JkHhn4lfS6F6a0p82wigWN3BXAXkATEsDMPMLihzbNfs0b5FvODHdoQNGlhAmzuy6fZi1T/1Pgj/jBC24XILbeRRdx75drIoSAB5qpG02682brAKTcKaetKQZF3o9rxIOwz56shAVYL60LXu/FLiCOIFzjRPtREBB57ImD8qD+84FnLdKh3vsGeFTqHqxHMGZrhDdXhHnjxCujIUKzAHfIgrV2KihuqavNcxGZ3o40QdEfVAMFlyF28XxVI3gbYziVhY4bRTTdDBNbZxqOw84Gc40BGUwAqhRfUMkXURxkieKeOGkOf+ReV6XSftyXaKiBf4+fAPvhYMbqGMiJt6W38XSdS36pA6mYg7wchta1FmW7gsn8MUY5XCRLgAAAABJRU5ErkJggg==");  
  pstrimg("\u2317-29-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAABUklEQVRIS2NkGADAOAB2MoxaStNQHw3e0eClSggMqoRUBPRSNhAbAPFnJO/JANkHgbgSiFeR621cPp0KNDAEiDWA+D2S4apA9i0gzgFikBqyAC5LJwFNCx8RluIKXhWg729TI3hBiSYeiH9CI+gvkLaAsi8B6adALA7EL4HYGIjFoHI7gbQQlC0PpHOJTVygOO0A4nKyUgSqplQgdw4x5sASEjtQMciHIACi5wGxFxDrA/FrIAap+wPEukAM8n0xEPcBMQtUDxOQ/kWMhSA1o6kXFM/RQKwOxN+Qgk0ByL4PxETHH7YgBwWvJhDLAvFvJAVToGKgVA0qkUDqQPJGQDwRiFcDMagAYYXqAcXtHaiDCEYtyLAdQOxOUCVhBTVAJa2ElUF8MCA+xea4LqAgKGgVgZgmcYrN0pFT4K8Eet8BiNHrUxD/OhCXAHEvMYkGmxoA31hUHoCbefIAAAAASUVORK5CYII=");
  pstrimg("\u2317-29-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAABuElEQVRIS+2VvUvDUBTF+xJpIhUHXZyqSwUHQUEEQaqDLuIoLqKbnUvT/hP92hzsJE4WJ3Ho5ODXppNYF9FBpAoudajVwfh7JYFSCz5qS8W2EN59Nzf35Jx7Xio8bfiJNmB6uqAtVb0rb1fepijwN4xk27ZIpVInUJohDsRisXuXXjKZXCTOkc+SX2uU9jemDugdq1/X9YlIJHLlNk8kEqtCiCz7o2g0utBs0FtARwAYp3n+X4NW5K1lykxXYL3/a3lpdArANI0+XRkBM2VM/oO4TGhwvbPvY685da/svU4s1z1VcwnMkafRWKOmqHoux/yXVPpU3JtOpwd8Pp9k5CkUCmXiB8IhmARN07wwDEMPhUJvHKVN8ttcZ5ZlBTOZTK98plQqecPhcJGXt5VBqwudI9Mh7sVc10g1qmnaMB+HR1cJ5F1GiUP5VVKdXz25RTwe3wBgUrpTFjhzsQh7ANhhfeKSjpUzn+f+HOsL97ZYKy4n52V/jHsPlGYKqyKF/SrFP9Rcwn5KpU97mNa+mXQv7G/IB/jg+1sy03qgGKZzjswzCgzW/p8i+zr5XUZwjlNnVUxTr+YLnhgoLXRnWhoAAAAASUVORK5CYII=");
  pstrimg("\u2317-29-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAABxElEQVRIS+1VO0vDUBQ+N33gUHTQoTiKIEXT4A8Q22ZychL8Cw4uDoIggiiCCv4QQVychKQW0cFJEzoogij4GERBBCWVHL+bmg61JaUPKrYXbnJfOd893/nOiaA2NNEGTOqCtpT1Lr1depvCwN8QUpazYddy8ygbw+hTuqof+u6ZlrnAxNuCxWlGy0zU6/YvTyUoW/wIwH702Yya2fWNG5axJkgsE1MeoGPNBn0A4ACMz8D43r8GLdJb5iliugqvVxqm17gwLhGnIRjjUowERbwx0xeeBXQ5L+AiPXj7OvjEfsg7JyiM8Umt4hIAvRdCDNYritJ3TOcAHa/FjnfrnJVTXXZfvQ966ZnfPPX2gYG5KEf3HXKilKQntnkHJ+aZ+UpJKqNkUfzH0xipdJ0WaclMYKuWMh2iXlSkW9AbD3EoldJSx6WKZJtLEMwGes3xq8S1MG1zi11OIH6OfwClbhriUhC7I6y/SH1izcFFNMwTmL9j7wDjaFHkHMHemZ7U1wMDKo0h9z7wlqnQWGO6gXpl6gW29nhafi2v4Nt8h/W4wspkS2JaEdTiDkkZ0CsVGyv/n0J0m1hflBVJ1/SRQMVUOfAN/GIgLfqdcIwAAAAASUVORK5CYII=");
  pstrimg("\u29B5-31-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAACL0lEQVRYR+2VS0hVURSGFRJLcWBEEycOdKBISeKgRBBn4SNEKTSKJhGGTqJAHAk6qQZGaTQKMsQoCISCIDAQhSBKUmpQaCCKgyIEExRK/X7ZJ45yHus48CLcBR9737vXWv/e6+xHZkYKLTOF2hlp8ZRUP132dNn3tQIHZsPlUJZiKIC/kAVLMAfLeymZZeV5JG6H2xECGrsDv5NMIk78FMk++hJ+ov8EfsJRaIUq33gt/XfWCUSJ1/gSLdCvh88BiUv5bwROuLEG2leWCYSJ67tKUPYAboC+c5gdYkCll5+sCGbjJhAmfp/ATngObfAvLhHjyvUCmuEZXISNqLgg8WMEfIEjUAbzBmHPpZDOD1ixxAaJnyFwEgbc6hNob6/+MVyBs/DGunKdYdl56HOlu0V7GPRNLbaO0024DnfhoYtfdNXYkcNbuTbId0v2PfqcJu797lhPvJCBXvgFFVDtHO/R5iYQXMNXG1U2DR/gOHTB1zBx//+N/BgFHZv+BMKe6zU6j+AyPI2KD9pw+vbfQHd2OWjnWk33vTZrpYsNupT+5woS1wYbdwk6aAetyvjpThh2Ez9J+yfpyuXvlV59ff8JwwT874DufF00kRZ2w/nPqxJccivaDMnWxP8v3Zj5Vox6WLJJpnv9qkuqndsNM66cOgUl0AM1zuc17QVYjVu1xuOeVG/VQ4ZkOh16EyzvwHY6i7j88uEctECdm4je9ikYg7egNz6RWcUTJbU6bwFDPFwgVWsj+QAAAABJRU5ErkJggg==");
  pstrimg("\u29B5-31-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAACzUlEQVRYR+2WT2gTURDGu4lJ1BAUqodqBYn2IurFix7EgwVBLIKVWr15kCBCNOQPERGiYDDknwpKEQUvgkXNwZOC3iKIHhQvKqgV9VCsl4IR25isv5GNrMlu9qUHg5DAMm/fm+/7ZubNvhetr4s/rYvafT3xrlS/V/Ze2f9pBf6PhisUCqvr9fpeSrNB1/Uq1qdp2hvsg1gs9nohJXPMvFgsBmu12k3It9oJEMwr1sbj8fjLToJoK57L5Y5DdsFEOIfQEzKexq7EbmNtiWn9PFU4qRqArXg2m01D3iCqQRiG+EozMX6HmZvA12usTeB3VCUAS/F8Pr+TzB4aBO8DgcCmUCj03Y6QAPysPSeAIcNnlABKTgG0iCOqIf4WYJDxjM/nWxMOh+eciFKp1CK/3z9NAP2Cq1Qqg8zNt8O1iLPPWwA/hUSju3cnEon7TsKNdSowAuwe77oKtkUcgtMQnCWAKUq3jrGuKk6mLrL/BGYV+Et0vzSs7e+POKU+QLQ6wATekv0M9hDvy5s62p5M02bBXcRhLVbOgLjgGZcJZKoZ+FucUu/H3FbNcAF+p6hi2lKcrPcQ3TWebzgMEO1SceT9HcanKgZOGixoYOd5l+r5sZFoNHrDUtw8yZ5fxfkIc2Wi3a4q3PCjitKgu3hK4Efb4a0abgzxSUA1Mh+y2is7wkwmE3C5XF/AL8bnmNWhZMZafWorEJWOFYJHEAyrZk/VJsGNSeBut3t9JBL50FHm4mwqvez7GbJPOQUAJoywdLpgboE56ISxPF7N36tBdpcTa5z5n82EciKyz9cRljNehJVPRduLJZ1O93s8nheQDhqkPxhf5ilVq9XPlHWA+RGeE8zJ2S7Cs1y/m5PJ5EenrGW97ZVqnPN38NunQFb2er3DKvdAg8vxz4TRAxvJ7hzB7MAuM8By2Xxl7jFzORrzmUKAf7koiXdKqur/CzXwLS8ETM4nAAAAAElFTkSuQmCC");
  pstrimg("\u29B5-31-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAC80lEQVRYR+1WS2gTURR9b0xNkaIiFcGFEIlgsUnQhQpB4c0EWlHc6MIPdKcbQYoIVil+UFciLhStrhQRFERcZRGcmRaqYnZJGyF0IYK00CJIK2Ixmet56URiMpN57cIgZGDgzcw959x77vsMZy28eAu1WVu8Je63bW/b/k8d+D8m3GhudJ+jOceYw7YSoxLnfDVs+swZT4u4eL0SywIrt3N2P3G6C/KonwARTWuadk7ExIvlJNFU3Mpbj0B26g8hsRISmcLzN058LcbbULl0YOki9kpP6EdUE/AVt3LWS+z8FSLY7MDmET2mn6knRoK3EXAWsSH3W0aP630qCXiKmzlzEGJ33GrmUN0ukRBf/AjHC+NbFsuLWcRtkjHAXkULrgUl0CBukx2iPE2jko0AL4QpHE0mkrNBRHbB7qIyzSCuS+KcDieS6kl9bYZrEIfdAxB+7FZ9AT28FSRc/Q7sJWBvLnWKBWIbxfPWM4BPADzH43yz4KKkKm5/sjtpHtVzth6YNHp/UKlyc8K8IfPFLD4JcERah/sKbknUqZIAsPOgGAS+G/Ez4LuH8TqQmkbMyNRzVCrHjJWT47KKwEpisA88NRLGgLf4hHURAUPI9Ke0rLp28W62ZgkF6qLysjtRZddLGC+AIwzgA4if9xSvfQkX3uDZwF1Ez7YHKtYFmHkzh+TjEM1CcI9Sz6tBAF8HeFhuLMj8gFev/AjtSTuK5fYRuA7c9702pVpsw2wfK4ztLJfKHyoExApYar2q1cO194jdKxPXmNaHA0e66Ht57nA11jPY9xz2HQ9KAJiHiDkt4yD+zogbySCMp3jdepUJZLWQZogd4ns9odwRnbyTwZYq3G/Ku6L/wTJpJcghC/3fUCEl9gutSGOUxrk+pZEWQVL9eD6MGDmjZZI/aBUdSvWm7KCq5femR6pb1VtUtVuBrIhzYL/KOVDlCvyZkIH4oTiKXWoIlfUgkTWuE5V1jHER63sEp94ThQT/ClESXy6pavxvvIEqL8Q7tz0AAAAASUVORK5CYII=");
  pstrimg("\u2AA2-60-170-170-255", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAECklEQVRoQ+2YS0gVURjHz/iAlMhFrVy1kcpoIQXRotpUFNUizYygInqImFL5yKTHJSoLtYcW0QuTFuYjohKJqE2uWkSb0kURrVpUi4pwIej0+2Qu5Djn3Ct074zjXBi4d845c/+/8535vv85lpplH2uW8aoIOOwRjyIcRThkMxAt6ZAFdApOFOEowiGbgWhJhyygUdKKlnS0pEM2A9GSDllAoywdLeloSYdsBqIlHbKAmrN0T4/9gh5rua4NDamGWMwaD9sETFrSAPcDuNmBHLVt1Zmbq45s3WqNhAXcBBxntPnyOCtLVRQXW99mOvgk4O5uu9Oy1B4NlIC/zMhQldu3Wx9nKviULN3ba29gKV8EqMgA9YaJqSsttQZnGri2LPE+Lwf8MmBrDFAf6FNfVmYNzBTwhHW4r88uGBtTrYBvAcqzP9BfaIsB3hl08ITAcQAingfYDcB3ci9TA/adPk2AXwkquDtLH0ZoG6IfZGerOq+sHIvZGYWF6jp99gE/xwuMtt9Sy4eHVSxotXwSMAmrCrFtDoTNd0lKp4jYazeYgC9Zos5xvxLweZqISi2/RXvtjh3WaBCi7gauQWCLW5i8o4huQvRtL9GUs1ruH6fPAl1J4xkPMTEH/DYx7iW9EWFPEZ6tW6q0ddBW7xUxwA/S1kifhTpw7g9kZqrqkhLrsx8R90xaLO0zgFchaL5JOCbkqJcJYXwx488ydqkh4oNMzDEm7m06wY1ZOomIKcDeOyXpkVs44Ktpb+b+SgPUO1kVgD9PB3hSZQnhmxB+HkEm9yU+u41dVpM7M1PLF4+PTyTDdVy6//xE2wnA+1IJnhRwXADCixB+kt/bDMIlG/fn5Kjd7gTV1WXn8/7KxO01jJeJiwF+MxXg0wJ2zMcl3r1DBsET5Yw+mxH951/R4tqYsAvcK9GNZ+wPcsN5fPpV34DFV/PnrVxyOKD7/KLhPteUDO6Mb6dtlW5wuuypMcLOu3sJkcsMoB8lMWFO7rj7JDk+rRsQT+AksvPE3thJMlPKChHdJe8hV4FhonzZYrqdlpSRZ4jM8xIqHlmMBwmp0csxMVHVjBPHla8B9f0QISlriXg54WjRWUsiepp2gdUaFSbrCRuScr+PiRJtHl4RrQYvN+RsHlpoLwc0VxNR2TyIh67w20PH9XltD1sQ2YHIGi+RTmmSkxA5+8rSgI7wjHtB2iV5AhsSjHJMwzX6iOnQHQD8BLQ9iPvgpIGJ6CI6iy1cz6U74vkq73iQTzoSAuOKVjj+13ezYFp5023zOqaVjUIis5FWszBdKFN/d9LaT+e7QTMLKQN2nWnF/8d3s5AuYNn1BMIspBJYDvGa5Zg2SGYhZcCUoLmcWIwE7Sw5ZcD/88FBfdZfpq26THKECycAAAAASUVORK5CYII=");
  pstrimg("\u2AA2-60-0-170-255", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEAklEQVRoQ+2ZTUhUURTHz80+oGhRVKTtpBaBiyASWhS0KCowFzkakW0qaiFqo6IZpUIolUoUtYu+sJw3Cn0HtaioRdZGKmgTrayIPhYt+jDp9L/vzSxm3rv3zUAz8+Z5HzyZN/fd4fzuOfec/7kKmmaXmGa8ZIDD7nHjYePhkK2ACemQOdSFYzxsPByyFTAhHTKHmqRlQtqEdMhWwIR0yBxqsrQJaRPSIVsBE9Ihc6hPlo5xDG9sw32EammAhOCwLUBqSFt8GYD1NiTTL/wdxFF9D9WKybCAq4GThEx/8fE8/aFW2iW+Fzt4OvAAgKIKKIbX4zSTmmm7+Fis4O4sbfFqgMlQXq+Bug+/t9AO8brYwNVlyeLlCfAqDdQYzaAmqhFjxQLuX4dHuZSmqM9OZgJ4XhfTG4y0UETcCzq4P3CS4BbPpZ/Ui8cG3CUKsPdYlHaADwUVPBU4zhHszWEYfYomUY68sjKzQOrqRri34L15CrCvGO9CLT8XtFqeChzjWkBI8eFUYqbbeD6MOvzKBeaAN+L7o7gXKkJd1vJeWoItsUFMBcHr6WVJig4pPlIvuUeJOqlOXPc0Os67ERl9WJwyBbis5Wcx3lpoEZMKPMxrkHyewrjZCm98w/eDtJiOe3osztUJ8JVKcEFDSIJttFN8KoTHvZNWjA/AGzJUS7WGlyBBeYmQOK/DdujH3EoFVHK7ROHxt/kE12dpP485O/0ZFqcDhj92GT7MFYgYqd42aaCeJETMi3yAZ1aWLK4E2Ekf9TVhNxo10N3pXZbFy2wRQxhV1XKilxhrQkl7lEvwzICTFoxyOfZfBx73aESIzMxXMN7gSlBDvABavBPjUQ34BBanGQlyNBfg2QFL8fGDDtkZW626ZEa+Q/MpQlvF7xSjHdXWhe/2aeZ/wFgbFutq4YClriY7CVUrjWD6YgsWrwzuzD+De7Nmfl7kqd7Dcu8SIIjWalZ7HKDd2Hs3XO9kNj+vDYg3sF92dg4FRhIqzF1WLN6I8RO4V2kW6gF+JZrvFjNdeFQA4iHuRQpDHeFByNhexz4W12FMNhjlivkFP0TITFoSjSNz9mik5X6MdwNyqSeojAhBF9CQRAt9TKRuHhwjZWno9FRDTvPQbo8TcrLXJQ8CBTomQmYPyEGguz1kumTLQkHHPI10SpMsLQfxziwFqDzs6w9Sl5S0M/M67IgG2RHtxWTVAcBnO/QD2AdnDnyNy4A3CJCIRh29s5uNAJ90+AOP8Ars4tNBEAua0pb1kNcxbSZi4zm6oMZiOq309nCMqxCaN4MmFrJ2o2aC7kwrOa3gYiE/wAESC7kDtrge2fii3fUESCzkDvguz6EtEIAh/L+wf1n6n8saoN/6B5pwTkzNhM0OAAAAAElFTkSuQmCC");
  pstrimg("\u2AA2-60-120-120-120", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEOElEQVRoQ+2ZTUhUURiGHVFnxBZhbcyNRVQrV0GLWkQFFa2qTUQLiTI1rMa/+TFlpKb5rbEoKyF0ERG4iSDKaiHYInfVJqSkIKpV0sb8SWd6jlzBmTnnzgg5c+d6Bw7mPfdM33Pe73znPUdb0Rr72NYYb5EFbHbFLYUthU02A1ZKm0zQNBxLYUthk82AldImE9QqWlZKWyltshmwUtpkglpV2kppK6VNNgNWSptMUP0q7XK5bvNGXXFxcWMgEHjIvxNmm4CklAY4YrPZ2gRkIpGYAtxrt9v7fD7fvFnAlcDLAOPAXysvLw8A/qfQwZOA3W53O0BhGRTQIr375ubmumOx2GShgqdVaY/Hsw22IEBHVVD0PyL1O4PB4NdCA1duSx0dHZtYw1cAOq0D9SIej7eEw+GPhQKecR92Op2VZWVlLq2YFSvAxgC/BPhbo4NnBF4CaG5utldUVLSQzj3AlyrW+SeeN4dCoWGjgqcWrX0E+ormdjgcdxRV2UZxawTcD/h6BfgPnjsBHzLaXp4EzLrdz7p9re3DCYAG5ufnr0aj0S8SMAF+gufXaVUK8Cm+o2ViYuLB0NDQghFUT1X4EEE9lwQ2RuDtuK9RWdAYlsP036JvqwIqzvNusiaUbxOTqvB2FH5HcA5F4D9F4Cg2IFMM8D2AR3lnlwqcpXBjdnbW39vb+zsfikuLFql6nGCEAdmiFzgmJCAzIV6vt3ZhYSEM/EFFqi8uFyp7F5VdrPecfXSrdBaKCc8tloCHAvU+NWomrkYrbidVRPQ/obkBH88FdVbbEu5rh/DTBKTnvkTALsCf8jPplNXa2rqxpKTEh6qN9Kn28lGy4kIkEhFLatU+WQEv/e+kahVBNRG4VxW4OGXRF+Ow0ZNaoPh93czMzDltuUjBGT/O9zdgW0dWg3pFwJr5OEsgN3WUEhV5cHJysqG/v//v8qA113YRoMs64z/Tdx7gl3kD1nx1DwGc0QniO30+WQUX44EM0U7pjM+JPdVVWKxdKmmUQI/oBDpCGnaxdt+kvpPl+JweQKTAWVRncSlwVxQy2baCojvZzyNMwF6d6vyYifTk+oiZ6rRqCFAoVa0IdNF44JgGZY6JbegA/cJq1srGG+ESIVtrOYIa3SpriaLHhMOibVZMlMiIIJXbn+9rIuXhgcBFtb3HGvYr3JAN0DoNtFKhqDg89JARsXx76KX40o6HwvnQ6UGN+7Igta2pifcCwNgViv7iuddIpyQpsN6+J0zD9PS0uOTzqC4A6PvGRLQZ8RycNTBbywYgfAxooqls4Qfe6TDyTUdG4M7OzmoO/0EjmAW9zFtpn+yaNqPZQM1hmrOQbiulCpO+uwFJc0xLL9OXF7OwUhX13tfblhbHGcEs5ArYMGZh1YCxhuIS7xlNXNMaxiysGnB9fX0pZ1jxp1HT/V0447b0P2fVSN/1D68fB1tROsodAAAAAElFTkSuQmCC");
  pstrimg("\u2AA2-60-170-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEGUlEQVRoQ+2YW4hNURjH/2PcQqEkHjx4QSGeFKW8mEhC7nLJnTBqTEzjEk2555ZLuZZcZlyGCEm5JKFMuYbyNA8UHjwgd35r2qecc9Za50yNc/bZ9qqdsdda+3y/9X3r+/5rFek/a0X/Ga9i4Kh7PPZw7OGIrUAc0hFzaBpO7OHYwxFbgTikI+bQOGnFIR2HdMRWIA7piDk0ztJxSMchHbEViEM6Yg71Z+lT0kJGVPyWpk2QbuN+/oxWSwrpGmkWLw4FiPXQLuT/V4H/GRVsH3ADI9Bfmklz+Pc04N8KHTwVeDQvzjmgfvC+9It0dLr0qVDB07I0+7gLMGYvr3FBManyu3RgivS+0MCdZQk3dyB+ZzJgmwdqC5t7x2TpdaGAZ6zDR6W2raXx7OF9DObP9EbfYfo2sMdfhR08I3AC4IbU/K00Ksji7R1gl0hwleOkx2EFTwI+I/UmRB9g7GQ6LtuyMt4sYp+X0L+Dcb0cHr/DuPKJ0v2w1fI04F/S0wDiB0YvZ8AxwN+lggXgg+jfQt9Ah0dNLZ/9XLq+VuLT+W9JwNVSP0LyoQXucDFghOoLm8l4vD/v1/MMd3jc1PLpwNfmW8QkAZ+VuhLSdRjd1eGLu0xY/Uy6YfMY4D2DqJjlAuf9ojZS9Ujpcz78bU1aGD4AY9bxDPMZ/lWqsYmQk1I3PFrKx8sdUA3bpaV0ZIz0IZfg3iydyWPGUAzfzEf2EKr1qYafkDq1kOYyxoS7tdFX1ZySN1Z6kwvwrMpSEOoLMMipvui7gFerMLwuNTOzcO3onwbcNk8t30vfJtvCNeVCZAWc+EGjvhDUI0i3B12GM7beSE/gqlMT1GWpFSJ8GPOrPfMv0F8xSSK5N31rFLARH4jnoRhU6/EU5wtV0r8rFThQbaNYjEMe4CvMX8HcJ02Pi4jI5qPGsxwWZjDWiA1XMxcG62wZPNDl8+nf6NnLOZGnXmCzdwnhpQxa4QHdTd9uPPIydUyW83N6AHGVpYz1lIllZOCTtrJCkuoOfBnPYo9HV1Lz9+f6iJkEbMoIJaIWIwc7DG0QHuzBmzbFhFLrQ6ZexVxktLXl/RIhK2lpQhaQPR5paYRKFU+JDdNcE/FD8+iryfc1URKwOS0lDg/BXdYyPH7CFrbB4WEIH9gJSF+HR83hweSAi/nW0An7bMDn6VzCc81mZHAuHs7Eg4zp7PDoI96Xh+mUZAX2ZGIZ0fBRQkhpL4/rAuCWEQ1hPAdnDWxkIWE5lQnbPWKhhj2+Psw3HRmBj0sd2b/zwiAWfJHX2L60OpyNWMDjWwnd7YV0W2n1MHW0B6GZppgSgwHNi1horBd9451l6a9JeRcLOQEOk1j4Z8DmEg+X3+MHzDVtaMTCPwOmBBWP5zoVWBwczZbVeThK6H8AwkMuTH+zBpYAAAAASUVORK5CYII=");
  pstrimg("\u2AA2-60-0-70-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEaUlEQVRoQ+2ZX2xTVRzHv+feYiQOJ6JxhgRDognGhEDYus6nuXVb8MEX0JgYUGOQBxiBLXMMdVswM26IMgh/JGIiPBjjIoEHwNFIIXG0owxMjNH4QvDBFxISYiKsd/f4vd1m6HruaU269vZy79Pa7rbn8/v+zu/3/Z0r8IBd4gHjRQDsd8UDhQOFfRaBIKV9JmgOTqBwoLDPIhCktM8EDYpWkNJBSvssAkFK+0zQoEoHKR2ktM8iEKS0zwTNU6VbEh9CyB2wjQ2Ihc+AL/wWgOyUbk12AXJoGlLeJvhWLA5/i+/ElF/ANcAziFJafD7Ricmao4gvv1vp4NnA0cTbMPCVC5QNiX6EMIyzkTuVCp5bpaOpZRDWLqq6WQO1DyI0hB9q/6o0cPe21Jh6AgusDoL3aKCOw5B9ONdwo1LA8/fhtYlHYWETi9gnECKkBJM4A2F2Y7TuF6+D5weeJViTWoDH02/y5QGCP+wCnuI+b0cskvAqeDZwS7IWsC9DindhPfWNuipLgWjiVRhimFA1LmC/8/12jNbHvNbLs4Gbx+tg2uMzEE5VHoQROqAuTgRvvtIGw97Pff6cGtzp5WITYvUnCW57QfU5fXj8RSr8U87CnD0qzQ8Qq7umXHRr5r79/GyNOtWdXi62oLr+WLlNzJw+zJZkpFl4xCKXPfoHP+vG+fAppWIt46sIPkDFX3YHN3Zhsuow4i/8XQ7F1UWrNdkEaX9KVVZrF27KL5QmpG3sWdrSXoJv0JiYQaRDnyFee6uU4PoqnU+xzErl1yxyAzgfofpzrrbU05DWe3x3uwbqKOzQAGK1N0sBXlhbapp4BuZkj9Z9SSQBg+ledymnMkdT1XRv2xgcqu7Wy+X3vG+nMnBFjERhwLM/2Jxcwir+Bqv3XteFO1MW6LmrIwdzClTD2EIsMl/jdvlSY2KSDOwWjEauFpHzv6/6f8CO+VhirYOUJzRKWVRqD9L/9CL+Ev++73JcW1psZIf63D1gIKgkcAMzpvhXYcCOr34ozX0o3ndfgvwNkhVYVcEzvjzNLSE6XO8vkT3VA0/v3X6m2FuaWI8QlEUrfD3nfwq7v6QDiBo4X3V2DgUgdrOtsJ8q2kr08vO0nrsZgPUaRYfp4gZLPWJmA2faSPpHwqxQ919MG4/HwqeVjqltLMz+O8iMaNT037IeIhRmLYER2ObH7tbSMSqSlRt0WorLyQgpujiQHCn3MZH78DCdth8xbQ+p3ZAzNSVf4cHmQRajpWpFM8NDJxbXHy+3h55dX+54KGwez3K0q46MKBeZmYut19k6DhG0yiV1/4SNHV6aktTAurbnmIZHzHfYQ/doDgB+ZVpv9+IcXDiwYxam5Da6qz6NO4rz8x4vn3TkB1478SSsezu9YBaK6bdy+3AhZkHiBEwOAhV0WqlWuDmxEiZ+9ppZmD+Fs8+0Zn/HF08cXBS+7xDPQ2Zh/hR2DuPk1MXMMa2HzML8ATdeCCHeyEej/nsunL8tFTOsHvqufwEsVJlMn8RtBQAAAABJRU5ErkJggg==");
  pstrimg("\u2AA1-60-170-170-255", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEH0lEQVRoQ+2YTUgVURSAZ1IhN0XUJoNoI6WtLKhVtSmoyCBNzWwTZUaF/WMZ5CPN0sw0LKHARWH+FgQhRYQLaRERthEhI6JFC1sULVwIOn1HZuC9cWYatfucxrlw4b37e75zzj333NG1BVb0BcarRcBht3hk4cjCIdNA5NIhM+g0nMjCkYVDpoHIpUNm0ChoRS4duXTINBC5dMgMGkXpyKUjlw6ZBiKXDplBgx2lu7qMGBJe0HVtpLBQz1Gh/Hl36VjMWJSdrTUahlYG6GKB5Pf7oiJ9U6iAu7uNpQA1UQ9RU+PhQgUM6CqAWrHmHiAdPYz+V1h4539tYUA3AnCbus0DZAhFXC0o0J+pgJU1lZ9hAtFWIBrZS4DdyjvGXAR0QBWota4yYCy6n01qqZkuEAau+0ZAicgfVYMqA8aipSxeCcgaD9DnaWlaWV6ePpos0H8OjEUvYbHzgK5wgRin/Ul6unYyN1cfs4+RqM38OuYfEc/A6lUqlDEnl5Y7NCtLu4FgxxF0iYuAY4A8oL8CCIFOKL29Rs7kpFZH43YrpjC+nihdERhgE/S+aY2EOzROyF8I3ozgMSfBsehBcX3qent/YIA7OoyMlBStGQH3UVOcQBD2O4qox5oyLqGYiqqh/xgdy13mT9JeiqLa5s3CWGMtm9+l7rDczkGYz7RdA/Sxg9tm4rY3ad9LdfQIFPWbvtbhYa0yFtMFWknxPMM9PcYWBLnFzps9dh8U1wT0pX0M83cBKhbd4DbfyyNUEDsCi6Am6LTzZQohd+gAIOcA/WAXjKtJAk45/RkeQg+xRhWu+1QFmNuaCcAIWoyQ4nqrXSYIaE9qqnY5P1//Ej/GPJ+PaMu3Xj0Oa0wlG7THAH2bTFBrrwRgM3I20LnSwwX7ALpiz476+43U0VHtBX1yvTgGNNoFuBM3rywu1r/OO7AlAC6dh2CSFkqwciuDwJ2257+mpWvpO8pEx0hsLpi0/DkewE/QusME18QfxXyiv9LpLJr5dIx+t1ggsoxQq52iuwoP8JVp+XzafQO+BvCHdkHJptZNTGj1WH23m7tLtKavgfmiYGXFF7C1u5/HO2N/UBuxmAS/hOLT3cckg+OodKqgnhFwHLgk+vcQ7ICHxTwTib+klk1Y+mxggC1BzA9wLcAf9riKxulvkwDn8XioZk35pDMV3QOTS7tp3AS/jqAnPF5NU1cS7+AzTu9g6+XF/FNylgP5PHRSgJllybdlt3exwbw+HiHl9uRFhQvb15zVGfYjmM8vH67pqZ89ZjNGGbAljN8khvHygeD1bCBmMkc5cBy4vLxmncTMBMprbNKA4640P9+n5V0dvG9ac9G6VxIT+GtpjuDTkphQA9uTGP6XAtwSyExrLpb1mtvebiwrKdF/qlg/6UFLBcRM1vwDiu2WTCmKf6EAAAAASUVORK5CYII=");
  pstrimg("\u2AA1-60-0-170-255", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEFElEQVRoQ+2YTUgVURTHz7Xa5CoXgbYJCSIoiBa1kgysrSE9LbEwcBNFfuVXpb7sVWalUZbQRoge2TxbRG4qXJQ7g4qIIIhataighdAHpp7+941j6sy9jT6vvsZ5MKBz5945v3POPfd/RtAy+4llxkshcNAjHkY4jHDAPBCmdMAC6sIJIxxGOGAeCFM6YAENi1aY0mFKB8wDYUoHLKBhlQ5TOkzpgHkgTOmABTTNq7TFR4ipHV/LX1OxyDPh/KVPaWZBCToJ0CaAZk5CDgK4IFjAD3k1/aAzgKoE6KpZcAECtjgL0ewE4EGAZnhGkamPSsSB/zvCFm8AwGVchRqQYTjhBEXEkAlYuab5PWzxFrznGq58DcQTmqAa2i/emAJ11jUHnOB8pG4XXrRVAcG434+rAQXqo2lQc8AJLkS0LiB3Nin25wTGemkUES0TI4sFuvDACT4M0BhgchSgv3C/G+OnENFR1zN21W5KRjyDqrCPb5pwRmopLc/QfkSKcY4SZSlAZRQv0lrqoF1izPXMfc6lMWQE0b6pqm0XrivpAyxBLWpLRsN9hjp2fsUfrYhmj6fhFu/G/Riu7a7xtAGO8xpamdyfFTByhSICH5JpGxF9rnFbVR1POoooWzF/HPP3Yv7A0kX4LucArxOpG1GKBYL+ZaqHYHjkkbbZSFupqso1GfEN82NUTFdJCFnBjfz0e7iPN6OAyL20R/P2IRSrWpyhz13PWCzTtQPXTs18dUYYQPYGtg2VYmGH4p2MaAwgWjXYo+89QMtxrxlXrsbmYYzVY/5TA1zKJWcC3+MCQHTj6Y0a0B4aR8EqFZ9nPGPvzy44omJa1zN7GUdsRAH6djFBnXfNBJaVk+kWDF6vNIbpDsZbXOooyhmQGnGMRTBXVdBkZnSjN4pRkfiy9MCOBQnOw75E8aBtGvBnMP6oS//aR1YV5tZhrqoSy2UfT+594/p5OoOfonUdE/I10XiJsWrPvWjr6XZNLZDLvsIzjZ7V3UAK+FNa/lq7d4hqA87PBx5FbB2gzmG8TJPuslq3YH7cAOfUkv6Ancf9NO9En2B4MwzvdRnuJ92ZRnAUFmH+oAnwuQE7Fkih/5PO499jmojphYQtLc96pjtDqZUIuf6C/+YH7JhhH0VRpGut8ihikl3SJTQPbcrmYRxrEJVOOS9ttLTK33bXVAlwKTZUXdMExm7Qbzrt2Qf/7bxa4bzG9GwPvRxgcflkgVL1xfIDQBzaus4lXhY8gd0LppbSOgP/9eWD4BadPDUEbw7YMdi/iKmGiHlhiHOex1Iq1tid1/xFTCrvnjbXfIRnG+pHxAhI1rT8ppWK13UiJu2PpVTAvURMoIHdIkZ+qo2mp9JKJbK6ubc5kw6J7yaWX/yiZYJiDmv+AQEcOExMKPFPAAAAAElFTkSuQmCC");
  pstrimg("\u2AA1-60-120-120-120", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAERUlEQVRoQ+2YTWgTQRiGu2ltU6og6qWeVDx4kCKoeBEULxX0ICr+0pMVrLWUpEk2aa2mtvlpUtu0CHqRepAiRtCDl+JBwZ+D4sHepNBaBPVS0ENtCk3iO2UWks3sdBM76XY7gSVhZ3b2e+b95pt3olSss4+yzngrJLDdFZcKS4VtNgMypW0maAGOVFgqbLMZkCltM0Fl0ZIpLVPaZjMgU9pmgsoqLVNaprTNZkCmtM0EtXaV9vl8ZxVFuY8o3/f3958SMflWSGnF7/dfyWazccBuJpD4/RTA520F3NbWVlNXV3cDcCGA1uTC2QoYabsJgDdxeQDpMFBxJBqNtq9phQG63eFw9ACi2QgEyo5XVlb6wuHwhAhYMqbwNezxeHZWVVXF8a4zHNAnUDwAVb+JAtXGFQbs9Xr3Qa0hvOgoCwJqZklFTqfTvfF4/JdoUGHAqqoeBsgAXnDIACID1mhtbW0oGAz+LRfoigMHAoGTACGK7jZQdA4TcdvpdA4DdFHfh1btqxhjAP2akN5JEZPxvymtQNHLCDCG4OoNApzNZDLq9PT0o2Qymdb36ezsrEdad2GMFq1qA7oJ+/BjKwETs9BK1cjbQ3OC/A5QdywWe8YKHFX7ACD7cDXq2y0DjFTcOD8/70WAAQS6wUCBCYB6APqK0U4m6gLu9+HaZfD8IoCPQOEPq6Yw1udWBBFEANe1tGME85aCftS3uVyuLdXV1S7c9+pdVU7fn6Qda3cM31kRsGRM7hqGGjuo9btkFADaX+DyQ9Gv+j6YqD2YBGIdT3MAeBmx4txMYBIorbjHWW+ke+goYLoB+kPfB4XsBCDDuN/AmahxtKlI3S8rTsUZMA8Yiu5HX3I8O2gEivvBhYWFkUQi8VvXh6xPPybDp5169GNoZgOGJBYKhWbKCaq9Kw+YVE743VE07uUEcxfbyIDeHaGgOVKp1BCgWowKGgXuxvc9KPtn1YG1ALA3NiBdiYk4xgnqOdrcDP9LlCZr/g4uo0pMzrxjmJiucvjnXIZlixY6E5vIM/6v0e5irUXqpyNoZ9YCGsgbYkxQCwqqu4gMMOW0zBztENwnqOYG+Dt9oB0dHdtwYiL7t4u3f5P1j+dJMRP2MQWsvd3M4R1BT6IOuCORyEtG1GbSfRbPNSLVP4ugLgpYC4AafTfgejiKcY0ELZC9rHRHijcjxR9aBjgnEKJYCzUnS3/A6T9om8M9dWpq6gHn8OBGn3Zt8izjpTkzTk5NF+k52OjUlMHzt3A8HDI4By+dvNBnGONcs+rxsGAOqMtKoIF5LsZ98gfAIMxLiGFeRGRx3pglrWEzUS33z8dy9tTMO0rpIwxYC8asiYF7U+HeJkuBKOYZ4cBaMOTkhd8lm5hioHh9ywasBWHSxJxbM0XLrBI8E7MWtiWznAX9WCbG1sAMEzMI4FarOq2SleU9CGPixJUSMXjZi5YIiGLG/AehF/BMvz1vRQAAAABJRU5ErkJggg==");
  pstrimg("\u2AA1-60-170-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAELElEQVRoQ+2YW4hNURjH/+N+Kx5QHihPvJoXueSBiCR3ZqaJEiaXiFzKbeQaCRlmQhoUxi2J8eDBJQkvCqUkJR5EFDVpYlx+a+yTM9ta+2xnzj5zbHvV7tT+9lrr+63vW9/lFOk/G0X/Ga8S4LhbPLFwYuGYnUDi0jEz6B84iYUTC8fsBBKXjplBk6CVuHTi0jE7gcSlY2bQJEonLp24dMxOIHHpmBm0sKP0BWnod6nmh1Q/W9oYxeG3uUsDVwToaH4PAjjYQKLUxpnStlgB35Q6vJcmAnoEsL7pcLECrpW6dJdKAK0BrIvDihWzfh1EzkfeXPqS1OurNBeC/S4KDmEPd/hAqfQ656TegpEDn5P6sMliYDYHgK7/hkXLJLw82hEZMKADUH01z1IHQhObL+cgTuG+n6LF/L16zoEBHQTEGhaeZ4NA1ohsIbKzgH7JF2hqn5wB10nF7X6lkgkOiFdstgzgq4DiwS2HF7XHIj/OPZ5cIt2P4jBaBezl0JH87kK5YQ6LPmKTlU+lW1xiWFoOL5iVssbeVNTmdxR5+E7BAHug4401UKpFDk1T8jYWXztDemBTHNcfyPzFwK3yywsG+JrUuUGajoLVPD0dFjjL++247RO/3BwUoMMB2oBsvGN+AwdVzEE9bzMLo2QPlC1HgX2uYgF5tXFL7t4Lv6Inpe5dpSlGHuAR95CtwZXvsgefRjMC7/BpqXdHaQG773Btj2xrB6omzP7G/81FqV+TVMEmlQHqOz0iCmQrsFGUMLqCDU0etY0mk3o6SbVTpY/+D2gGhhCd1vKepsc+TFXF5lW4/qsowFxrtgD2AkklL00JaAXlZTnueWWS9Dn9A+9+TmOuSU3NXY9lNBcb7cnB06QP+QRN7fUHMILdPMQM55iP5IK/OjLA53F/b74roBngMjqGev+B5Qve6tJnpP5EylWmUAhQZAv3s8pf/3rgI5i3nscViU3Pu45m4mg+6ud0hjBBa0mGwr+KRfbY7qJXT5ta2hULjC4Hue/7bdE9CquHqrRCtnYnWGwn4M/8ipq05l0T0xo68zdetYO79DgKUOsdzrRRbbjmvR6LbcJiD/3rhXF3vnnE/Cn0xC8z6ZONPJSF/QubQv8dBT6TjwVYLLCQMBmBuYsc7j4GT7mRDVCmOVkBpxb1UtE4FjGu6kpFJs9W0Dxc3+xoHugRTTozVVizuxdMLe06vTRXNSnN1TU1ckfn8O1lWx+c1nkdwqUXFmR7aDsAr8rajszaFwPWiGxJN6muLXJxq1w66L5k+ueDuYHlaaa7mK08MuCUQn9RxFRThLzNFiTsvMiBU4p4nVfWRUxYoEzf5Q04pUiYIoagNeyfCVqZTjglDypiCj4thYW0fWcrYmINbCli+EdIpQVZabXGskFzD0sdKyS6x9yPvAet3CP83Yo/ATCSEkxmW4YsAAAAAElFTkSuQmCC");
  pstrimg("\u2AA1-60-0-70-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAEZElEQVRoQ+1ZXWgUVxg9d3YrtrUKKqR9EkGhJS8txs2mVJAmm/iDUKlFELSiRdRKUKGatGo1MaIV1KC2GvHFFB9Uivhgm00CC4LdTZcihYjQPumDPii+9CHdn7k9s+suxpk7jpq7juMMLMlm7r3zne98P+ebCLxml3jN8CIEHHTGQ4ZDhgPmgTCkA0aoDU7IcMhwwDwQhnTACA2LVhjSYUgHzANhSAeM0LBKhyEdhnTAPBCGdMAI9XmVTow0A8WzECKJZHyDDuf7IKSlQGLkMwj5IwG+WwYpjyPZ1B4swPOyb2BGcRWkeYKMThkPLkiAl2XfwlhhE1k8SKBRRxal+A6DjQdebYYXZmdiUn4rQDCqS6IfhtmFgY//0QHWOlN/Drdl34PM7+ajyKrikuiFET2EgYa7uoBWztUHOJGeS3daYblCAcKExD6Y4iSGGx/oBqoPcGLkQ8DsIdglzvkpC5DiGxTqTiE1e6xWQCcecHNmASLyKA+e5wxCPgSMbZgW+xkXRdG2plS1C59DyjNkfjmGmoZ0OOMFQ9rqoZnFNOwYGZ2rMPAO87cdydgV/jRta5ozM2DIzazae6pVW2IpBuNXfQSYQFszK0ts2HroIzMlbpLRdgzGhh0Nb/n9A+7tpKNW2+77BnDT9TfxdmQ9iTpMYyc75yhSVE0dVEoZ+306qvmPNhjFA9z/kYLBHIqYj+H4Xy+P4cXpqSjKdubW92qxIH+BEdmDgdiozdDy/rXcz2L2pKqqRsTf/G0rBcevDH2pA6x1pnsOl3poYUfJEPXVBzPag6GG27Yln/45C5H/Oghyo3K7dIuIiYftDNgyNJrr4uPWKB5p9dBDyEePINVw37amJf0JXdnNz0IXoP28183iZDFbs2s84Nbs+0CerUUsUgI15RYUpvYjVf/v+DVWxU4zv0U3//5o6rGdUhYbeaMPqdi9mqF87EHjAVuV0xCneX+Bmhm5E6Zx1q6OSmNeJ0XHbmVB402euwm5d87bHVYb+M4h3XZ9DqSxnyasdAnJ09S/++z6t9Kb5X6XSmwdy94d/aEW+vlxDB6K1tOEv7zAFNjlmItlPb3LpRZYtlyCMPY6VncNpHtTWl5GO8jfICOdFBo37EUsOw2i8BXVlMW6un9LdGIontaAs3qkN8CV5Z6Gd2Q5AW1njl+zG+4p3ClFo61INtzSAfzZAFcssIT+9PyX/HrchTF3IVEukB3O4S6WI9l42T+Aq5aQsZb0FzS8V92KrCmJlTkZv6gcHiJYx3dbXVXn+UZLq0s2h4n0Is65vcqpSXIOFuJr5OrOOc/B1XDvY69e69Px0MEDlsoy2HJUc3EJuPEtclN+ehm9+Ply2EtyPe3NhyVC3OSpl2c8xxp9gCvGeBUxwujhSwJWaL2XfsBV4F7eXrqImAnyQ+0AVwz2ImJMmXh1ipZXJtxEjP/bkleUDuucREygAT8pYgT471JjtU+V1gsw67a1fnQSRutzOk6vfdHSgeIZzvwfCh58TDrDJtcAAAAASUVORK5CYII=");
  pstrimg("S-20-170-200-170", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACB0lEQVQ4T7VTS0gbURS9b0ZiMGC7ULRauhAKNYqgaIyuXHbbWN9UArq0FLoRF26EgAuXLkRcacAugi8KrtwGpJgYSpAaB6FQKZUgBHGjBSOZ55k4aoqTmQg68Mhn7jn3vHPPZfTED3tiPnp+QpEWzcxgn6SUDZLJS8bYGU5mJDCyU81t7hSKHdFKCm0C1GsHlCSvGLFM0VMMjfaM5iqRlwhFRjTSJf2FAbV3hZLOoZCBxFcGllKRQ1pA23YmTIoNkIWsou+qqo4P9w3/Nn/HMrEWtaCOkaTPqHnjShiREcW/6z8G9hVAf/Sg3hZhEcNOwVpqbcbwGMuOV04kEjV5bz6H7o0gzFM9veYdvFDNAOxqSh6icxJeBa2CX7BuuuArJMJd4bPHEt8MJS3ek0Fb+PpfLjHZC6g+wr9pprAFHuB7bg3uY7MrPgAcBeCFAyjOg5w7kT7YlHgyHjKYMQgLugH04zSVK0fg57UBbdIxNk4dzRS0p9oXsS0TFvEeVJrNbJ+qdtmK1ikYXuIcgLCzIqFVfIgBfNOC2qxdYfQo6q07qTN32ov3zgrLgw1/cgCtKqTEsv3ZrEmO0IcxrDlMurXUTNISH+Bf3BTeXsctFT/1fr270iaZ4JscpsRHfEzhmGZ7bFj/QdkKlH116/hgKOs/1t8Vr4pvFab4YAGsJZ0P8n03otv31/KEvRU9PPQmAAAAAElFTkSuQmCC");
  pstrimg("O-21-170-200-170", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAACWUlEQVQ4T71UPWgUQRidmd3zByWVFkfAFGnMXiWE2ztNCgVFLGN2llgIIhaiEBQCphAunQoSSEQsgoXYZO6ClYg2h825qxgQNQQsFJEoJ6k8BOPdfr5dN4t3t7tJirjN7s68ed9735sZzrbh4dvAyf4vqXqv9oqGOMg8pnnk/ZSH5dvNuupSqhw1zohdgYe+f0mI0W/8v9Z07dzo4OhyWoGItEQlYbjGc4CHNlBEnPEJq2DdTsJFpPPO/GOAT0VAYk+gdloIsUJEQ+TRdfz3hvOE79PSlI/iiAPSilsZ9DzPAVCDTQ9DF+yCfb9zQVthYp9lUba1aB0fkKKPz/A67n9D1bRdtK/GKQha5BgfUfxAAGV0FsUfdmJ5CPwG4H4E9EsXeu+IObKa1C/lqgngbgUCON20TftaF2m1WtXru+tf0c99UPkKKvNpQS0sLvQ115ofgM9A6VMoPdlFCusGKr+BUn0zpJWXlZzX8ny8loTnWyVVNZVngrlh/2OdcZycHfSDvsNODxTXkOiRLdivwv6x+KBc4wsmsiBtsB6WlTnZSAnqPHBzqUGFW8rB2wyJJmVB3kgkddQ7zOVC++MIdqZLqT9Qdson/CTDyTUu+FErb9U6weqFmkVAl4NxYvWlwlK2xEv+YWl7omOKBYtYcCicRbB0JyMyU/6e9U9ci1qz6HthfTX26EXs0XtxjiLSYL/uqi9zzvvTgvorku4ioEtJuLarzz9dA+7AHCd+Bqp3di6C+hVcMJOWaT1IK5x485fd8jBupn7Y3COYWG1S0xkrjn3ayIU//wefZA0lt/5qgQAAAABJRU5ErkJggg==");  
  pstrimg("\u29BB-49-240-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAExUlEQVRoQ+2YS2gWVxTHT6IBaX1i8UG1gihU3ahpfSBJkErVheLCQBDcdFHdRFJMpBDsokoVX5FWEcVGdOELQUEEFyJGJEJtaqshRnFlFz5A2lSx0cbH74Q74c733Zn58s2NFZkLwzdzv3v+5/zPufecM1Mi78EoeQ84SEbiXYliFoksEh49kG0nj85MBZVFIpX7PApnkfDozFRQWSRSuc+jcBYJj85MBZVFIpX7PArnReIfkdGvRb4cLnKcP7kNj79FJjO/hD8WcX3O/Th+H+gq7m9zf2WQyIVhIr/w/CJXHvyPVBb8Ey78YriFSPwlMhKQP5j8hOu7ESKbAtAukTko383z/AIV9YBRh7EH+X2uMga/g+fxYNWPEtlZIFbssj4SgJZg6FFW11gSDRA5wPx25r4uUmE3csu42tDxuzrIwinHa78VidsnFhmJBODmUpFDGNWBp9khMlgvbnRrVXH/A9eYBIy1ENifloDZxmEYjBiG51uYneVQcKhMpPFDkftxyjWqT/D+S5EjeIlghgdz65j8yQcBJwmdhMQ8DLlqK+H5Pp77uD+H8ZnIRE72PQfOBHBeDRgJjC2FRCsK5jqUNEJEt0riAGcoOJddEWUrVrANrySCFLggL8WSQVYweTpGPpGIIXAdjCkROHfYTjPQ01OgnbHLQiRQXob3OizlG1C2l9pwKyerNBCRHS5kFwE9A3j+MDj3gjNCNJYzd9Y7CQ5jFYfxkgJjTBeGTkJpl10/LKV5RFwE7HoATh14TQbDWzRyU+yPTNQaJRsgofWhdyQRSSKgGFqtOc1/cjtEn4nGNKLRmTYadrHTrXQDwE+5ukmlk3NTqYuIehqy+5BtM7K9Nrkqsimo2/i73hhejewpnyS0PtwFcAzKngKuaZCp8IiISGhRXEuB/Ffg/qwCua1NsWTsSHzAwbtr+poWSHzBPUckf8QRgcB6eqJdUQah4zP+u2ZIbCRxbC7W+EDOSUKVAD4/ioQKE6KpGHwnx4BOkzojCxnJYwaeaf/fSZjWRBu3vDqQFAmiOBPnaA3R7eQ9EqEzgY6JbAuiHx5KgMn2nLrxzpyJULuBsbMh0euxYEQQaIBQM/vnuk0s6nDjgG/B22Iw/WYnBUWB1oUg/Z1kf9cEDV8Egb4WxH7hsUiHXnzMNuzNgLqGN8DpvAHe8nawzWENda9BMUoiEBjhImK33SSD1WAdMesf46Tx/P+fVxKODvYEc2tRpCnRPsSRTWAEkVrtnYI6ZIxeQxo/kJaASRBhGFJgJSmwJQY8sYvVjw1g3NSa48Kx+7IBIWFag5OAr3QoSCQQyMQRgdwqttIxHwSckdBJojENT2pLbo9HZg8X/EYWgaNnYWxcIe0vuVAXq8K6p5m8yG3eOzZROkdGqU/qPDWaRGIxbPXb1dt9xy6kuTNeOs9vM9evWPiYX/1IVobhYyFQxX3i1w47a/XX87nr7d7J9d2pESN3YNxWjPumSGU9yFbzTaeVd1H97mQf9oH57mSl09AhNo2bFsOlhZLB+O9Z2xS0L3b61ZcvHLSnUKy4dc4zgcBCcviZoFrbAP/yBY+9U4mBC5gv57fPs6x/yPNViuQ5zs1lnvlqEx4ma1VA7IwPApHZyRf428J5A/T7dEFmoYFbAAAAAElFTkSuQmCC");
  pstrimg("\u29BB-49-170-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAE5UlEQVRoQ+2YW6hWRRTH/0eztJLu2SEtkIL0vFR2k9CQohsURZ2SoJce0pcTSibCoThUVKRldCGSUurB1G5GCD2IlIhBZnfMpIeoBy04lBFlZtZvnTN7s/d8s/f+vm+PJrIHhvOd2bP+s/6zZl1menQUtJ6jgIMaEkeKFRtLNJaIuAPNcYq4mbWgGkvU2r6Iwo0lIm5mLajGErW2L6JwY4mIm1kLqrFEre2LKNxiibel0/6Wrr1DWsPHf/213pKmHpSu58M1fLuUfhZ9j5v3LeNbkNvI/x+Dsd+XXy2dPg7Z26W1IfxuuOVIvCOdDIEvADoHZR66U3okAV0nXcbvZ+gz21zoABgLJkov3yj9ZTIOfwc/e1l4Ub/0VJtYpdNSEizYg6KrGZibSDD2AKRWHCstZezebhYEYx9yNx2QtmOBz22DEhwsOoPFPu0GNytTaIkyYBRbieAq5uw4Q/rte+mYE+juaF3F38foZ5ZhID8fS7xUl4DJt/jEu9JEbP8h3y7yF0D5VWg6eJu0u4JkzxvsPnNeo5/kz2XR+yDwXAwCQRI2uEa6Yoz0kbfIbhY+uxNnfF2aMlb6wcfBKSYPSZymOK3FEoCPmS5tBf7ygCUGcXY7KpUN/zqRSZtDFmVsFpFrSyVImxNaSKyVbmGQQBJuHKlKIo7AZyCcF0IBYxcO0zdHwt/rtxwJvGzcKThrZvHFE6QX/pS+YSyNKha1sMiy0PIhAuYD+NmrRDk7WiM+AsbNYLxXn4Ln2ChgkeUDB7yXv+di9r3Z/JEsGiJSQCDNBzj7AuSWOxLRrJGzBEfpWQYGnKKLIWD5YaRVEakiYBiWrXH0H1ljvP1P8JhG5t5Z1xopCXeUvgTwAktQhNKpfigNEbHMi0YvcuS2m2yiUCgju4T6pH1z8/rZqDejkXD54TsALUn9Tp9sR8lfIETEn1NWUmDte/j+ijtSudKmWzKpJfCw49lNI9FLt2R3NST+CQFXELkfuaeLFGLbLyFBbLPvLP4guefRbpXPWH30Z5YEZt/GAjOLSNh8lDkfZXZ5CuwktPUNlSQy5PqQ+/p/J+GOnhVuoTxQagkCwIXIWQ6JbwnfJ6g4p9wq/eqb2s2znUzzxhHjExyBXLlB+LuY8DeyY0kLEbB8wdFb6XY3JVbk3FhiCXMfd5hxo5OBEjmWJuEP5dbhE3OTgq+AQFqCZC88GYfLXXw8a1sFOJ37hFUDtVou2fnVa5KMqggkGhQQScturHA3c608tzb8C5FwnsS9q17LkfCPlBkH35jPKhYSUycuKwJDRJAdOI7aifopyUOm9TwsvaKe+qPSoSp2NoOWJ4KtnSrWHhsoT78CwHJOqKV12SEhYaUBhRqWF36db+0QSCTKiIBzFxUsd6Y4rcUSBotvTMMfrCTPtp8Z6B3q4EZWgDMM6KSyRNoptRYS7kxvAqjljs3YBsgtqqo8nTWvG92Pw3zHbqe4c7v0vuUGlP2E17FhHH//qVyocNxJfG/3tSPaY0FqiYJ3p0EmLOPbE/xd2KmZ3Xx7ROsnym3F2e3dKXX2Q/nuNBJOfSd2hZtdkm7ogMzDKL88KV+88DuAXzzfAVbh1CKfmEOJvD7J1llpwpY9cc5m7Er6DOZkw+hPjNlTzwbu5pt5ePrDX9m99c4iOq2PQcAwgtEpFvjhwvkPLGR4QSATQAQAAAAASUVORK5CYII=");
  pstrimg("\u29B5-49-170-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAEZklEQVRoQ+2YaYhWVRjH/+MSoUQKNTiQS2GMjH2JPpgOoeMCSX2QJHODHAkXYiAIhJQmdwVBkWhAscSgoinaFCQSl0ZtEb+IW+IyJBQhIspEI47L73nn3JfrxHvP3XRE7oHDe+57n+f/7Oc551bpIRhVD4ENKox4UKJYRKKIRI4eKNIpR2dmgioikcl9OTIXkcjRmZmgikhkcl+OzEUkcnRmJqgiEpnclyNz5ki0SsPQZwpzPPM55pPMS+73H35/Qcie29L+GdLVHHUvQ6U2AuVrQdnEnJpAsQ03pHVzpCsJeLykiY3YIvUfJK2A8T0vemWCmUTlywz8d7EmMgLvD4H7N6alUHmQKq19pK14+fh1lzIDpX43pSf6SuMgfJ85qgfPjmrprQapK6sxsY34WnoWpY7B8GhI6O5bUtNM6ZxPEdzeAO+30D0eoj3K+iWi8p+PP+p9LCOQPAgv/wEQzuseML75uvRpEuHbcQAR+hie2QGfRRGs2RiCj9INrxEIqSKNtpvSToSFvx6hv6cRaXhfSUvhXR3inwPe52nwnEOjWRE4DsGHQp6b+Ia0L61A43OO2YZj5jucDn6fSrsFR0bCCWuDqN4J24igd7MYEPB+Jg3uL50OpegSsDekwY404gtpKLvLn857nRAPQ5A1slwGxT4fTKsRG2dpHnULJcov2Yg0AiHT3I5iKdBCGr2dDD6amiKwLfii2/G6WNdOl84nlVHRCJdKmyFocqCTiMLepAKi6F2R/wDNqy7aL+OoH5PK+J8RVGw/AznDLjJYamM5htnF/vfMLLyWVICPnp1vMTQtju4DHLXSx9PzfdkIwB7h5QnmyKQg95D+ANiWAZE9pGzE99JjHBnOwlRuaCHl/mZdcw+VrQSdzIid0gB6/4UKRvSC/qV+cgQvj40dCdMyqAdbt1MbHBEOsnzBnjkjjeSQ185lwdvlA4sNI8r6edJ1mulcaILjy5qTUvPw7tQujUap0+dB3+70IQSlbRWvpNo5ohRwO2BZhsv/xDugr0/MgKB07kfgDsLayDPLfIZLYavDGkA7CdvoXPuEqcmO9TQ/peZjQjCgFkNKHTyPEW6m4F2mY9fk3rGXS33qpMMIsF5hhrSekmbxPyWSbbjd0I73pV0P7GYa3ao0qN4ixVuTIfopAGc9nXvEN2mEBTyuFlrAWuT+6yCVRrxGNNLgeo3oeTQwITA1YMj+NAJ75T5hitpBDU9ZAZavliizgPqwO0HsQnc3u83gLAg5YBfrab5eEOUwbyQCZoq8Dm2PuhNn8HcbxdEY545NP5gA/3dhR7C+f3fskCH2lePXoBhDOW735C1E6zhfx66N4MDY3t0sq1H8Rd6tgPaurx08H/iX3hOnmfnSNnYkAiBLiQF8AIPxHR94pfcYtoxdbv3yHHY5V6PpVOETzvOk0kdwj42LgPKfMNfGSb+4mJmMCIRgzCgUe4U5lVnvasa+iPzFs32POsI8yP8/p/0Q4DMocTr5AHvj/R0Krv4y0nup1gAAAABJRU5ErkJggg==");
  pstrimg("\u29B5-40-170-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAADrElEQVRYR+2XWUhUURjH/25hGwaZZIUkBFJBEAkhhGLZg9HqioEWvvRgbxUFRQ5IBVFPQj2VFWhoUVRYbxkGBZlERCuULRRJWAwtLq2/c7tj0zBz7507Lz7MB4d7557v+5//+bZzJkUTXFImOD8lCSYaoaQHkx5M1AOJ2idzMOnBRD2QqH0yB5MejOaBC9LMn9KKX9Iy5mcxxowe+TLE4w7jdo0UTNR7NqZ3mC4p77fUDJFGNyv0WtFrgegHN12neU9FwmIpkGtA+VQUsH6+vWXMZRiP/ifYVFZLON2fuBIMSKkLpZMobglbopvw7ieGD7ZJ30Pf26TMqVIhvw8zikLf2eCRx9JusDCLTxwJ2p5rC5Hj90iqVI5HbjgtY+zOS7U8z4bpHSDc++KjZ+V1bOmUalDgYUnwh1SwWRr0uggkF1NMd8HINDY8i9ncTa/2tk109YvSDGL3lNkc4znA8/HA+3jAjS4kC4lrn21nqnwOOFbVe5GYHqQo6gE4Y4NUA8pa/oQQtLCQFV6ea/DiNa9IUQmaHDondQNSzvuzHEJVKhFhf8JmZ4MzYELN8xib3c47r+4SleAVacowgCa8KOxkx0fdoWJr2Bu+jMbaeDc8TrBHSv/IqUBSjwK0iGElM4C1KF3ldZJPkmkk3GiGtMuE2eRzGnnJIu8mSxm8D2+QPsfCtgja7cR0/iafJHybsfbBWmmvK0FyDieqxPdKPg09ETTYlOhSlLN4HaMtLMGbx23vtvK9g1BYvcxFoqYBeF/B24HtJoYptkZ+D4KbQeN/WSU9dPRg5OQlaTo58obvWYBsJQSn3Zi5zdNqApBqRm/ok5QbfkQ62Uat4gDnL1VyC8PlEOxDqYjWQP34E9oM9aDnjFzwujiX61jD07ns1Kj3AHjIprQKgtf90bPOyvEjkwUbaVvcK7yJE8F8IF7YMMERrlMN5JI32H9apknz64lJF8aXdGl+xd+LrSdxuyyMH1GgdXN13hjPiQK5adjdYywwbOL1nm0TeyP2/c5cGPJsrQGqubRSeuW2fcgVoNPL4KS0em0PBFfHm8uOHjTALGT+c9xn5IaRMi3jRLT/HR1SNqdGE4QCYfr9VEnxOumb28Yi510J2iRNqNoZ6yMAuiFijsQg/SybsiwBsCxCp5O2Uu+1rfgiGDLitKmARLu5lbh5wr5DVuFlcyvyLZ48GI5uLhX8TSuDQB3GK5mbZ8+/5pvpdb3mcvGImzQx9tTrnNjHTdC3K3wa/gFTot4piypf+wAAAABJRU5ErkJggg==");
  pstrimg("\u29B5-40-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAADmklEQVRYR+2XTUhVQRTH5+nr4UfPj3JjVGARUqB9LSKo0BZhVJsKo0UPF7UKCmoR9gFRQZsCobaRGC0KisBSiCRaRQVFEBWCRSWVij01FXvqs9+RuXG7vXfv3HdbuLgDw8y7c85//vM/M2fmRdQcL5E5zk+FBINGKFQwVDCoAkH9wz0YKhhUgaD+4R4MFcykwNCQ2jMzow5EIqqatph2Wuzoj9N/Q/daWZl6GFQ98fe1B4eH1eF0Wp2ExCKvySH7CbsTEL3lZes2bkSQyaKQE0XqnWBatQnaAggVZRi/X16uduVK0pMgE88npN1MXmmbJMnv1lhMtRQWqs/W99FRVTM1pY7gs5/xYpt9T2mpWsO3Ub9EXQmKKpD7YCM3w7c2FGlym0gr/gCbbTa7bsJd/V8JQq4TwAYNmoZoAiVumk6STKrz+Jyy7XU5PAdN/V0PCXtuO0q0Y5QvB5SJmiDX5gdcbCHZgu9R7Tedl6dWlZSoblOcrCFGvS5AtmqgDla+wxTUaQfWe75Z4b0N1j5TrIwEZe+h4DdAyqgpDsPyoiLVawrqtAMrAWarhJr2CwSXoeqUCV5Ggqx4Pc7PdHhfAbjOBCybjV7wV8bL/S74D8GxMVWZSqmG/Hw1SDLeCdAhPWEn++aiBvfNE6wCnH5Qr+owSya4AKYIEGe8j6zwOBvwLEFJC6jWg+xLfTMI7uCafiyCku/6IRgPPp9vBG+CAgnBSyhZAclf/KyhbtTqyp3awdg/15iTCnaxLPTkBtlNXSgBo0pI+6gxcN8R4jOuIXYOkrvqmewR3/MEjENipRvf8lgOCPCW/kqqvHxWgPnRBCxbmpH797vcp/IYiEZVVTyu+k0AM9mw4LVgPWcsSh0g4UuaMbqXsyZqQF8DUqvDfIMwJHIlaL8yWfATsOpMsdwIHoPgZQ2UJi1s4op6agps2ekkfV1vlzRtI+G9Y4rj+ppxXFFJbpRaPzfKyIjaTJ6TvTx7ePyqJz6uBHnfreZ99wK7eXrFk6h6nD10xUsBlDsNobPYyWNDyP3kEqgiCoNevvZxzwcrKjbiIE8s2eBWeUmnOdP/Duz3MnaOKid2tshBY4vUsTBZrK/iSVDQdKju0V3gQE/K5Y+qY7QljC2hL629DPBjg2lacbI3Img5cbLbISDPLhM/Sch3ISaK5lxMJvoLfHxcLeZRIad7C7WCaoV+EhUnWEAvbRfEmk1znRt73wRzliJHx98pRCk4U2hXzgAAAABJRU5ErkJggg==");
  pstrimg("\u29B5-40-0-70-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAD9klEQVRYR+1XTWhcVRT+7stMYk1CjGmNitiWGkSDtZo2MwlCE8xMSksXGjfugsYSd61F6KYrNxWKupGItisphAakFFScJPBIwEymI1JoComoUUyiYqKk2sxPZm6/+94knTQz8+6b56KLObMY3ptzvvvd75x7zh2B+9zEfc4PFYJeM1RRsKKgVwW8xldqsKKgVwW8xldqsKJgQQW6Yo+iWvYCshNS7oIQKctP4i8IOYmMMYbxwLJX9VS8uxoMRVsY8xGjjjouLuVloOYURl9cdPQt4aBJUAqEYycp0QcFsOap3B8k3czf9mz/XQwgErhYLkkNgtJAOPolxT6yuYhEHMI4jYXaKGZa7fQqOx5/EIn1rpzKSm3bJD7HaKCfGFm3RB0IKuWiX22Sk3KdC/RhtONq6YVU3PTb9Pn4Lkl5gXFv/b8EQ9ODLPohWwWZQFq0wAz+pr3Iy7FDMDLf8hD5ckoew2iQG9a34gp2xXfCn/6Z4HUktw7p34exg7/qQ+c8Q7HDzKyZe7qNVHMTzL0JXZziBHuiJ2HgQwsoK09grOMzXdBtfuHop3y3kd7XEQkO62IVIWjV0DWCtFG9P7HifwLfHUzrgm7z64k/CZH+0Uq1lF8wza+xrqUOXmGCXTN18K8u2ekV7/MEntEBK+5jHbYoSbW73fBdgm1xPxqMx+FbWwOMNoLZxSzFIGTVMIxkTVkkRU0VkEpCGuesNFudwOiAz/8LkolqZHf8B/OFf4ph5whaKR2hU19ZJLwESXmR7WfAmWBo+ganwbNe1iorVo8goXuiL7FuH2YqkjCyh5ji9+wUc6YKcYHfO5wJGIXLICtuoSpzlpidqifwc5qYC2w/1chUzWG8XR3IglbkkHz/EPwJdUgeIOg7nKV2u/Fioakh4g0S4jYW6hu3jMgSuMXajJq/syT3FOfoT0ivPQ2zW4258ix8vZa8lohXT4AJbrhbdy4Xb9ThKd5cxCmbkXiFoFfKY8eo/JGZxbsYC57XxSoxSaaegSFu5uowAZ9oxtfBVV3gTT+7Sc/a5YIUUsZumO2/6+KUvs3kjyh1xVrxdbqaKD3xBhjpH5iBXRYhl+pZuSu5E3W/S6Z5exGNtpJYRpYncTww56hAKHYAyExa08i2GTQEnseIyDjG5jk4X1h7449BMkV2gW/YOWTE+YL/O2x/1VLUfXDD5pGqfw5m679uyDkruIGmUiXWv6HegS0LqLRDTvD933z/CEkd5vf+e3xMLNb36raVezfgrGB+RHj6TcjsJ5sX0FJyqJkr0I9IxyW3quX7uyOoItWloin9Ki8Rb/ApQBINNqCkimKRE4d1Z4wg0m7q9rpSG3BP0IscZcTeAVaoQzhKfKlvAAAAAElFTkSuQmCC");
  pstrimg("\u25C9-29-0-70-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAAEZ0lEQVRIS9VWW2wUVRj+zkx3awTaJgRFhBgRjKaxQbq021aSms4uUaOGKBIRSIxCDBHjA/XBBDXeQsAnTUShJl4fpF4jQe3NtdHuTl0VNG3wwUQLFI2KUAzSvczxO3Pdpd1eH4h/ssnOnDn/93//XeAiiLgImPgfgN6evhSjcimknA+h/Q7klkCKv2HJY+iO8nlqMgWmUsAw74CQrRCiaQK1x3j2LCrrX0O7yE8EPzGokboJmjwEiHlUYkFiPyztI+jaL2Q5B5aV4dlyGrOWgdpoA0mZoxfWoqP+YCngEqBkF0u9SGUP22AQO5C5bC8SV58vyUC5/t/cNmjY44K3oSr60Hisx4KukzpOm2lavoJmH0VOGuhpPFEEZqQrkdOdu4kVZ2iU9M+b+xcibH3O5xp6Jo3heU0YqKZHArkAlAzjZjuP76KbPqCl9/iWrulbBqnt5PsN9EBZgQ56Au0824XOusPOe9tT+/jdgzZwVX20kHExaMxcR6MPUPGH6IzeTQZUaBuym5p2TJqbytBLQpvwSeScC/y+HW8LreiKvuDdD0CbB+YiPDJMy0LIVixAovofVA+Eseis6bh6qiL/QKZiqX2/+fsqhM8P0fhyZMquRCLyp9ISgMaSz9Gqxwm6mSzfchk6rp6+9DJ7b7Y9ZZgbWAHvUO8z1PtEAajUEE/9xIMKnAotxreRLGLJJhrx1fTx3BuWXI+uhgNQiXnGPE4SOk5ULFZJ5TC95bsFyI0Okfdj6Gh4yWX5DU9qZwwqMcgEqrETKJbaSd1PIY8b2LkGHdCW/lXQrX4yvY0uOAQV39DISTKdO3NQNol8+TL0rPwV8f5GlvvXnn4H1Ejdz6zdBxm6Bl2RIbSkaqDjyIwBvYseCc+TELtJ6kkHNG62QlrPI6svQaLuN5/5bFEv9BzwOjobtntMHyXTPQGo2QBd9s0Wc0y4ikCdmKaQK7sWPZGfYSSvhyYGZwWqGn8+dJ2tzwuXy7w4kSy5lWm+P0hzLJwFcAZ5sQjd9X+xHLdSz6us2xbWb48Dag/nLGtJ/OgXtZPmT88YVMo2xm+LW35fsrWuQpm4HJ9GRwo6UuoVgmxh4661G3f8yBzg3El3lk4PW7nWT0qvEuRn6IjeqiZSABrEMWhhXn1ND5LksIml8bbPEljN/1E2HrOgDbpa4xxHUGy9/sunWJKrivh4irhqzK0no/ecUkzeR2YK3Gc5FjSIbSU/jqmg25edwcz2CI67EiKRQN7a6A98I9nMCviCX2eQ0a6y69+VsZuDcrPAD/agtuQ2ZvNeH0Z1luzoaq4k3ArYIgV9IiUHRajD7mSexM0HyK7NeXQyttDU8XckVbdavs/dEHohw/eic+XwpC5ek74CMvsmgQx7QbP0RnTXqcFRJKW3QcUqn3mXX3MuKpFvMPFexvHKw0U7T206hPm5Gn7wCH+bXe29yJTficSNp8czdPK918ngXbzMDPREnqVjT5FRFV3M+Pvvj3I12c6QdE3klf8AHeffLRva8eoAAAAASUVORK5CYII=");
  pstrimg("spd-14-200-200-200-2", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAOCAYAAABZ/o57AAACb0lEQVRIS8WVTWgTQRTH3Y3FDZXk0hyiWIhKC40WpLLJEqsHT9JbKejJm1Qt2EJBD3oWeiqC6KU9iSKhUOhBRJS0FvIBUUEM7aWEFrFp2urBHIIkqb8XZsvSSw6d0IXH+5iZ//vPmzezxrE2fKlU6rhlWWWgS47j9OlIYegAOYjhEjUM41c8Hr+gI4d2okJSiFHRLdSW1opmMpnHgI5TgRB6j28H+w3VmMhms3P4l4l/JzaENvH/ou9B4rWQUhVcYtzBNRj/gx3EXtFW0VwuNwTwAvIP4EUSnMR20BskOQvRJeJXhRDxVeImZg8i888x5ydzVrF7Gd9mvCA2EkYK2ohSzSnAHwL6CtDbngoNU7GkInqFOSOxWGxexlnzDv8GxJ6bpllAv0TWmH/es76stUchMgJ40nNkayTNkPSBJGX8M74NodMQ3VVEm5sjPkt8B/2I+As2OtY2oorMGMnukjyC3ykx99haEWXNJnOfsH6Gzd1pG9F0On0xGAwWo9FoRZLQsxGSfsPsqNfrEZ/PJ5fJDgQCXe4cjv4jBK8Tf4puKKJJiN4UjGKxaJVKJenXdW09SsWmwR4n6XuAl9FR/FvI72q1esrv93/CHkS+Il+QfiQuNxvy3ZVKJSSXTDaGfMCW9hgGy3JPRZ3QoZRBBUcbjcYzgE+4SOp5uU813npu/R7jzXeX8TK9KZdrWXzmTBKTvvUpjE38EP4PMC4diqFavP/gQ3gQwmGOete2bali85MeRQ2QtBvd/B26BL0E8vl8uFarXWMD2971OkgKRss/kyIao1/PJBIJ+X8fydeSKBdnQSpKpfrd5+komP4HJQdQHri1IDYAAAAASUVORK5CYII=");
  pstrimg("zm-14-200-200-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAOCAYAAAA8E3wEAAABmUlEQVQ4T+2Sv0oDQRDGc3/EO4PxASRKQNEHMN4dkRQ2Cb6AbUArGxsFfQjB1lIsLCysRBA1aJEEQYJdsAk2mj9oc4WHJJy/hbtwhuSiEFK5MOzs7DffNzO7UmTESxqxXuRfcOgTl0ql0j6se67rOpIkKfgt/Bb7pyzLJv4RZnIuc7/GLnNu4oucDXaLmITfUFU1m0wmy2FVCsEtADtCwBObh0SH4CMWi83atn1BPO2RPLOPYQmfFFwFfJRzHP/BsiwjVDB4WSgU5ujqiZhGcobkawq647yC5UzTPMnn86qu603OUYTWDcM4r1arWq1WEzGX/ASx936inV8qkur1+hvAKWwX8gORhOA94ssQTftExWLxEbFFbEbERBGapr2KTtvtdiKVSjUGCkJcAbQA+TGd5fyEXoKia3CGX0RQ0C8iVJCKLwFmAV3RWSYI7iP4o+s/CUJ4iMC2mD/rFOFxdjFq23GcTd7rtnuk3UV47yqeY2LgSEm+AbjaYwRfJMcVRTnjbik4Ku8jdWJehy/gJn/9acK+8jDvvgFWD+UPzeHOagAAAABJRU5ErkJggg==");
  pstrimg("\u25C7-91-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAABbCAYAAAAcNvmZAAADRElEQVR4Xu3aP08UQRgG8LmACQTwoDEWNnR0+gH8CJpo7CwsLS1MbLC2oTEmdJbG1ljYW1ljYmJjZ2NiYo4TQnMFvkuELMvc/pl957nZeR8SAsfdzTP747nd2dsbOX7BBEawJAY5YgNLQGxiAwWAUWw2sYECwCg2m9hAAWAUm01soAAwis0mNlAAGMVmExsoAIxis4kNFABGsdnEBgoAo9hsYgMFgFFsNrGBAsAoNpvYQAFgFJtNbKAAMIrNJjZQABjFZhMbKACMYrOJDRQARrHZxAYKAKPY7FyxDw/d+9NTt7a15R4AtzGZKFizC2jZ6sfFlgv4JwG/n4wCaCIQ7DL0+XZZBI+O7YO2Ch4Vuw7aIng07DbQ1sCjYM+Dlv30/mjkpoL8snpMsrAPV8euafTbzU33tECWx+zJjxfWwFWx20CfA1sEV8PuAm0VXAU7BLoJXO7/KLudh6DzDUhMb+w+0NbAe2FrQFsCD8bWhLYCHoQdA9oCeGfsmNC5g3fCRkDnDN4aGwndAvyDLAsfQdZriiGtsBcBnSN4I/YioXMDr8VOATon8LnYKUHnAu7FThE6B/Ar2ClDDx38EvYQoIcMfoEt0LuyIa88V0/eyWc8niguN9WGmkzcG7nM9qw6oPzt9XjsnqsFKQ10gX187G7PZu6LTHStPLZcG/y1vOzubGy430qZKsPIvFamU/ddBtuuzPdEbt+TgnxWCVIcpLob2ZaN+FYFl7zJ0pLbSQW8gJZX4g+Z5y0P9F2BPlA0UhvKd4BMGnyo0MV/bN7SL0nwIUPPxS7ukJdpUuBDh67FTgk8B+hG7BTAc4Fuhb1I8JygW2OXwL/Kcut6ZS0UZVmYG3QnbCR4jtCdsRHguUIHYccEzxk6GDsGeO7QvbA1wS1A98bWALcCrYLdB9wStBp2CLg1aFXsEviBnPiM6058LEKrY7cBX193f4f4xn+lPEE3Gz8RFTLq/7dnfQ3/I+PN5PtmeVxpenEpK9krLCEGvudEwW5o+KV5WIGOshspS9Y0/OxhlqCjY9c13Bo0BNsHbhEahl0Gl9+vWTgYQg+QvrCjI3dDPvCzsrrqfmod4Yc0TrTVyJAQUHMlNkpacogNxP4Hiq81eqQ4QH8AAAAASUVORK5CYII=");
  pstrimg("\u25C8-62-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAYAAABzwahEAAADMUlEQVRoQ+3ZPWsUQRgH8DliEYS8lYoWWsQmmJdCLSxEKxG/iGkCKkIQKxMQTDo/h2ChjSAiKBYaQQ4xYj5AmrxwXZTNf47bMDuZ2Z33Z2A3EI7dm73d3/xnn52567GW/vVa6mYdvG3Jd4l3ibekB7qh3pKgT5hd4l3iLemBZEO9KNiZgwO2Mj3NXubQt8ng+/vsO8CL6ICPMzPsFjU+CbxEl9gc8NHhMjoXfFS4Dp0DPhpcgf49NcWuY/+vXo+do8ZHgWvQcwD/w/09jvd3qPHB4XVoIWVyfFC4CToXfDC4DVrC/8Gwv5D6ng8CN0HzmdvhIXsxOcme8HudGu8NB/obEEvCTIxX72EhE3B8urqN7Uv438K0VWzPRgUvafJecAd02RfkeGe4jEZqfSS5UJO0PD0nxTvBVWgsPOZE2Wg1Vg5v3ZpEh99GB16MWfCs4QHRTcM+Kt4Kbojmk5PKRRssQZMnbwwH5isA14Th11cMbxc0SfJG8ATo5PhGuAL9E0lflQqZT9Km1T7oPV8LJ0AnS14LJ0QnwSvhGaCj40/BM0JHxVfgQH/B2W4I1eYHpqGLikJWWVAYPKd9mwR/zp/A9/bYJ0wTb2aILi9JGQJWfX00uGw7vR3CkfQqXtYE9P+xMXZ+YoLtilGh3Vts3/WNz/V4BLOJJe9D6ZruYPu9sK9Au3to967uPGLib3DAfaHxDg6ex76B0Jt8Xc17eNb14j2O+4Db7rZ4/GDA5o+O2Gdc49nR/gKvm2j3qOk8lXscw12FvyIvNZH8FvZVVmNNJ/J8PyiaX8upqp4hPjhaCec7M8JHQWvhmeCjoWvhxPio6EY4Ed4UvYHq/di1aDYuSxPjk6CNEi97NEHBS4a2gpsmz9s1/S6uGJ5J0dbwSPjkaCd4YDwJ2hkeCE+G9oJ74k3R63hkPXV9ZNUdZ/Q4q/sAk2ovFTxytHfiNo863hZL2mUsdV+JHalZWkZLujy3d+K2+BzQwRJ3wVMlHTxxGzw1OnjiDfjh11gqNH5Lf46fpZ7FqN66zwx2j8snUFT7v2jzAMjX4ndkFOhoidckL/ZPQYWODtdMcvhuUjS/gGNOsv9d1wVnUAAAAABJRU5ErkJggg==");
  pstrimg("\u25C6-83-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFMAAABTCAYAAADjsjsAAAACPElEQVR4Xu3ZMU4DMRCFYa9IQZMoOQIHQOJGNNQUtPR0CHEFDkXBBZCQUJQTBG+BlCLarL2/7Rnrud59nv30tpoh6GACA5akoCBMsATCFCYoAEapmcIEBcAoNVOYoAAYpWYKExQAo9RMYYICYJSaKUxQAIxSM4UJCoBRaqYwQQEwSs0UJigARqmZwgQFwCg1U5igABilZgoTFACj1ExhggJglJopTFAAjFIzhQkKgFFqpjBBATBKzRQmKABGNWnm4RDejsew3m7DA/gtzaOqY+734X0YwuP45RH0Y7cL980VoAGqYp5C/s/fE2g1zHOQvYFWwZyC7Am0OOYcyF5Ai2KmQPYAWgwzB9I7aBHMJZCeQXFMAtIrKIpJQnoExTBLQHoDRTBLQnoCXYxZA9IL6CLMmpAeQLMxW0BaB83CbAlpGTQZ0wKkVdAkTEuQFkFnY1qEtAY6C9MypCXQi5geIK2ATmJGyKe4/HqF9k21Yl7i1vO51mWn90xixmXXdVzLfsYXbloMl3pnnPd7tQp363X4SX2XeP7ibx4HXEXQL+ugI+TVVbjdbMIvAZOTcRFzDLUOagFydJqFaRnUCmQSpkVQS5DJmJZArUFmYVoAtQiZjdkS1CrkIswWoJYhF2PWBLUOiWDWAPUAiWGWBPUCiWKWAPUEiWOSoN4gi2ASoB4hi2EuAfUKWRQzB9QzZHHMFFDvkFUw54D2AFkNcwq0F8iqmOdAe4KsjnkKOi7rWu9sxnnIM3ttQV7aa9Yfg/5MYwwRhgwAAAAASUVORK5CYII=");
  pstrimg("\u29BB-34-220-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAADiUlEQVRYR+2WSUhWURTHj01mJCGZOGComWVCEC4aFhVEVmS1EqKNSRCR0UZr1a6gRS0CIyJa1EKIho0JlQsjqkWJUDRQNpnNReRHA2YO/c7z3df19vR7Xxi4+C7c9+5w7rn/d87/nPNSZJy0lHGCQ5JAXE8kLZK0SLzoTHIkyZEx4cgTkdSpIpk/RdImifT3iXyfI/IFgv2Kd0HU/YCsL0Sy+0XusrCTSy6oAgCU8apjrcZVOCjSx/px3kfmijzTfR7rmTdOEJlXJPIhKgiV84BwOOWpSBOTSv/wdt7olz0RlR1A7j79jK/vVrHIMvQNRDz/p+h1iuRg8jsczHIOdzHfAdibKP+K8sGXIhm9IssZnwiRj6ViyXyRN1FBBBYxB3DFApQ/MHMuf8TlZSN9mVoSd7QhX27OTBQpLeRcIiD+AoJ7DrFYbysBxAY40xymGOAr2b/q7O0FvOpJqNlkLYCscNZrp+nrjNn58k0QpsnW7IDoQuYGyrYg00NkFRWIvEsESUDW5yINKKulf+aLcuDMTICpiWeoQhuMDYL1b2yXcuYjbuKY5NAPM49KdA+vHTWXmVQQelWE3nndxFVwTu4ZMOomxt1cft0H54HAWq91DsBaZI4ybMOdSxnzLdGaB+STSHrMu1eyALIYILfNcReMWTeWMCB8IIbssekiedkkvmgwfIu8FZn2AyAoT8e/+bC+21bgJ7vATbqHXG6BwwNcU4KOx2z38J4NSL4xWvMsYoAwzKCX4N9X9vGw6MBya7Bciy3XiZvIRQ/HAogSbRVAWs0FkHg16XHYhWbPDW0tCaxphm2HI0sYgytaC0vxZ1GyWTOoDUI5MRlrAWqArub3oskGA5/2s7SP/m9k9Ym2DaUndcylxWTIPC685s+HRYdLYOTXToHglGK8LBRq2Y1VG6LZYkgqSGiQIo0yr1VU3RO0sOjQzdGiKYzw8UAFQFQQV1RghSvWoRiWmU8UvQ9T1DlUKNsd8FuxhmbmhFpcIFik3PxvuJopy7lYsRkli8we0bSRaLqYEArbNf5PTWhxQ+4SgE5h8g4s0MtlhcyrWK8Ou3C0QjkSwCBqAKIVs86PjoXk5kzGCsz9P3F19fipvwN5/SXI4n0M9+zSyItqmcA1/r9FPZw4Bydw/9CfGwC11FcyXsHSLLpmy1zmraw3Euotpqb4BK5m7WAidUbvGsaRqOj/h9xvGK0KMk7V/jwAAAAASUVORK5CYII=");
  pstrimg("\u29BB-34-180-180-180", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAADgUlEQVRYR+2XTUhUURTHnRkth4IWFkZZtigicxFEbtoIYg3zYWgwBAmRtSi0RVLUKgraCpFmhFnSos9FNOPMREiSC2kjFhWEuQosJSGk+Shpxn5nuO/15vGGeSMuXMzA5d537zn/87/n/u/HOMpWyc+xSniUlYiYV6KUkVJGCu3OkkZKGlkRjUQikc2ZTOaA0+msAvCPw+GY43vS7/f/LBTA7rgu1lAodIhAERyfEKBdAMLhcBdBL9CstQBc4jdN//VAIPBA2Q9Qn8THA8aIXRJilyUCoJNZz9LcpJxf0rcNwL02wd5hN0UJKrxfqVRqYzAYXLTp///Sg4iH4GEcy43O9C1CaMjlct3yeDwfaWfIVAP1Wewkc2b7NH2tZEmwbP9yzhECdBKgz+D9O5lMbsg3M8nk8PDwAj7rNR/aZ3w+3x3bDJShmYjM2Lwcg6z3aStgiPdg320aG8f+4LKJMLNjOD9Sa/yVAFu0tDPz+6S6wwhuJKGW7wfjW0VyiN7n9XpjxZDRxQqRzwTfBWja7XZXsyT7+Y5SXIqcTsZEIkPgNuzG2dIz2FaA8Qni9UUTGR0dLY/H47OAVQHyEJDjAkLAVqpnGhnag5R5yiVFLksCTbxQ9iPYNoER57sanKRdMtmMRKPROmbzXpYCoKsAX9MALMhkhwiWQ0IRyYpdssr3Hoh8KYpILBbbkU6npwBwAdSA2CaMAHLYGZdJxsgEMsjVAct7iqG7whP7RiY0tiwikhHIHGUmz40AeXZHP4Q7jXYQkbOlfyWIVABygwDntQCA99LuyjOznK2N7TnsbopGKisra5qbmxeKyoiINZFIfMNJjvjvpLRGTlAjCdEEp6uf+i96ihkFrJ0z2E/iv2/ZYlVCiwDuVUI8QV3P90UrYVoI+DbBh7B/i72D9muWt8luNsROP1m5a2oBEJXL8ug/q92hiJu3dtZH7K0EX4iU+YjvA0QXoGxDirelpeWVFZC6KEMm8iGW6kihwObxgkRw6NDeG2ZnlsgL8af0rzOM3YOIbOOifjoRQAcAtbzcyMo8Y/LQmaCdEkFS5GzZnida3osyHzvjw+gDRnVKE+3UO/m+Qsl5b1gALdEnp+kYxOTSlLNomqzslp1nNy16RtQWfoNjLyCPlfDk5dZD+7C82KjXUOShtJZ6jhKhv1u7U9i+bXxfpr+xmHtGYq2aP1j/AEdQ3DJx2zZHAAAAAElFTkSuQmCC");
  pstrimg("\u29BB-34-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAADi0lEQVRYR+2WS0iUURTH52WRymQRFokbpTIIksKGInHRpqQ2Wq3atAipTeNrTIIcDSRnnISIaNEiiKgoCiIooiDQiIyIbBFREiUVQWCBoxnz6HeGO9Od69R8MxW4mA8u332c87//87r32m3z5LPPEx62AhEzEgWPFDySrToLOVLIkX+SI0NDQ2WRSGQtYEtps/F4/Ivdbn/d2dkZzraB1fVUsg4ODm5E6RHtTEdHh1cAQqHQHjbto1uTAZCl+HNat8/nuyPrwWCwH4I+Wl17e/szqyRELkEEMDubTtCtUMqXmKsC0GMRbAS5MdohhTcZDofL/X5/xKL+r0sPj9Sh9JBWpCtD6Ls4x+VynfN6ve8gF4f06lgsdoD+YVOecRSdesIm3rX8pZ0jkNmN5tWkNoAYFi77nWXiSXQmIbRY02mCxA3LDJSgSeQx85sMjwwAfCQTMDnRBYkTxtptcqwxbyK4exsW3lMxfsUGVZrbg4D7dHCdhArfB3Sq6cecTufmtra20VzI6MkqWb4eoEhxcfGSmZmZNYzFQ04FmCJjeCJKvjSgN+ZwOKSsFyA/CnGriZ6ATxAhBxwlJSVi0QoATxEKSUIb8d/K70GSDGsDyHxmfFKRS5CgfCXJRV7yS/Ls69TU1HJwf1j1SoIIYalkk3EVioNYczYJYJLRgNNIKCLJZI8SnsrW1tZPORHB1eUoTGCtE/fWEN83OoA67PQw2ZDzmHkAzi4wbqo8qWX9RV5EUHIB1IBH5IBKfZmqg816CaFflwsEAs0QvPbXRFSiHYVIvxaaY/R7M1kmOaOXNoT3gnGF+W9ut3tlS0vLdE4ekWQtLS19j1IFIG8hUi0nKCHRSUSxdguXX4S/lGaimnQyyA8zJQmeX7IKINZcYPN90qcSdvBbx4ZBZZFZHWnVhEwfuhfRe8nfwfg6xjRb9YbI6bfvMqyTEpZzQP/mVIcs/qmaMiV8NlJpRzxl3AMZPQGjAHiw7mkmILkokR8xyJ9Hfn+2jc31rERw987ke8NUJpweSNxl3q2tBSDSlTcR9ajpzgSA1R8l7vyf4PZp/hsYN0FCroE5n1lNVkjpd40cWPImkffEdnXpnWac9j4xQeXMYE7COay8UyT3Dl6plcqzQkJkUqFRJXwL5RDPvPuyqN4b8gRooq2iLaTN0hYhJ+V+mTvlePJO4UCrx2M9zDXmcs+kEbHK/H/J/QT3S9Yy1D9TpgAAAABJRU5ErkJggg==");
  pstrimg("\u29BB-34-50-50-50", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAADqElEQVRYR+2WS0hUURjHHUVNRUKyIV9RMTnZaDrOoseigsiKtFZCtLEIIiraaK3aFbSwRVBERItaCNFjU0GPhRHVImV0tDFMJpLeDyLFhNF52O8b7r2cuV31jhi4mAOHe8893/mf//m+//ed68hYIM2xQHhkpImYI5H2SNojs2VnWiNpjcyLRlwuV25BQUFxVlZWXjQajQE6np2d/dvv90dm28DuvCFWj8ezLCcnp4+FR3t7e+8KQG1trYfNW3k9aAEYnZqaupKZmXkBQu9kvq6ubjfjjsnJSXcwGPxul4TY6UQc9fX19xg3ysd4PH4YwNW8nrQDBqGzDocjiO1Nzf5VT0/PJoGys14lkuHz+UogEADQaVr8gY2OjI2NvQyFQmPMTdXU1BThqc3YXrWwH43FYp6+vr7PdkkkEZGB1+tdC/CAAjDIyTwznEw82c28T1/D+ipCNZgKiX+IANrOxzYTSBNkHlgBo4mthPCpae4U9oKTUjPECugKQN/LakJxg8cu3e2M9yJg0ZDRTCQkfC+w349BmOcqvPI1FSaqWC+y8Bj9F0Al4XB4SW5urrh4sUbOIKOSgMAfNFFF/4H9MLYl9PN4xZbQjZBqLxLrR7w3ANzM6e/I9+rq6gpS+rVOhmcTG44g1OcauQSJ/v7+TzIGQw5yCYxuMDbyLjXHVkt4xO12F+bn54ckFACvR/Fd+moLMokp3RM6CfmmiH2UwlfG3LgtFhgliJC6+QCH6IX0ikAgMKICSLFTwyRzkC4164ACWIm33jIdBmc5Xvk5JyIsKqIqVlIVP6oAVtmB53bguSeqHaGpYvxmPoiI0LYhtE59A0hsJ5uSNlQ2T0pt7UqQCusHYwPPaEoeEU8rJf4WIPtEBioJ0QSEKicmJuIIWNyfyCaaQQaNnCFkp+csVk1ohwC5psXfRbkvY/xMxmZhWgh4ZyQS6eJG/oL5IuxPoA8pB7abUdDKy8vznE6n3KISHqNZZYdMzpRNVoKfjVHSPysxbkD1j5VFo4RizcDAwDcrILko2dSvkseTB8g6qcwptVmJEB6f/r9hRkYTpczLPeRV5vagsfspscBYvWvkp8bycuPUDznpdTYdok8yXsmzmd4yzYbTXpTTETTuGk7XDnCrpol1kCqW01r8b5ixpHg1YT8E2W7N/jJeOS46t+sZNTSSwm2A3SbGwxqAA93IVd/IBlv4tpQu1bKU3gmBDrJDakziThEBkzktfDunf5sLEbtr/ovdXypr0DLYs3tLAAAAAElFTkSuQmCC");
  pstrimg("\u25C7-50-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACDUlEQVRoQ+3XMUsDMRQH8BzUIl3ajoKL4qw4OIiFzm6C4Oji7mcQ3PUT6KyjH8KudlVBFzcHWwpOcvV/R66k17SXe5f0hRKhnOXMu/zeu+TFSKzIT7QiDhEgvlUyVCRUxFEGwqvlKLHksKEi5NQ5Ghgq4iix5LChIuTUORoYKuIoseSwoSLk1DkaSK7IcCjO41hcY14n7bZ4cTQ/47AkyGAgTvGEB3xq47H4xbXDjSkNURFZunzAlILoEL5gjCF5BKrQa7VEF2vlDZitBMRZGSOIDoE1cSQnX/MBUwhZhFBeqzxmFEViDxX7NN52Kv7hQogJwhfMXEgZhA8YLYSC4MbMQKogODFTEBsILswEYhPBgUkhyQEQzewuOTvJ3vCMPtGpuCOmwxE32Zpf8eu2/D7CtWv7bJZCUI0eLody4jGuOzZ7AOKfIeajkph7xL+wkagsRgpB1tbxsA80sQ1546deF7uNhviq+jBU4xjxnxBnTcbqN5viAM/6qxpbHT9ZIy4wOgQqsW8TMFURZXFaq8wyEcn8Z/qIjcosG6GFVF0zHIi5ECqGC7EQUhbDiSiEmGK4EUYQBfOOvX8z32d8QBhD5mC+AbvCLneL+/Ws2bnqE0W9p/BfXTWA3JrVyqi3+1yIUhXJNc08hhVBgmheM3YEGZJhsNBvcAC8tH0ALFoPuvul1gjlAcsaszKQfyS7UkK64gcCAAAAAElFTkSuQmCC");
  pstrimg("?-23-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABSElEQVRIS2NkoCFgpKHZDMPDcG5gEKkAsSIQiwIxOxB/AuIzQHyNnOCDBYsqUPMtPAZsB8olAvFLUizBZfhWoCHCQGyBZBjIcgMg/k6sBciGLwJqygXiC0D8B2qALJBeC8SmUL4lkD5BquH41GsDJa9AFYRALSPKfGKSogLQpPtQ0yKB9AqiTAYqIsbwZKC6OVADQcEDSj1EAUKGewNN2QI16R6Q1iEnQtFdwgUUKALiZqjEZyANSjkkpXdsLgd5/RSSbSAX2wPxE6LCAkkRNsOjgPJLoWqyoeH9i1SDQeqxGQ5KbquBeDMQ+wPxf3IMxmV4NFBiCRAfBmJHIP5LTcNlgIaBsvl7ID5KrsG4XE6JeSh6sYU5KJw3ADEolYB8AEqGZAF8EfoKaKIGNHioZngA0KT1QAxK16BCC1RhkAUIZX+yDIVpAgDCgTIYm44e6AAAAABJRU5ErkJggg==");
  pstrimg("?-23-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABiUlEQVRIS92VO0vDUBiGmxsxq+BSdRQchf4FEUU6iQEHEayTgRByGaJLcBCSJqNTO2gn62Zx090f4Cq46mSVIAiJ8T2SSNG0NOHUwcAhybk835fnXMJUJngxE2RX/gE8CIL5JEnq0FTDvcowjIh7n2XZnq7rZ3hPiir80tJsNmUM7o4Y/IpAq5Zl3RYJkAsH6AUQEQGnMhjqIkEQ5jRNexo3wDccA8inH0iS1FIUJSQAz/NWUHc5EOTQNM3jQvBRnaGsAXib9EH2HajZoQmvA95L4eeAb9GEXwG+ngJhxQyowH3fPwFoP4XFPM/PFp7Qn5m4rlvlOI6oqKVtCbLfNQzjdNysSb9f2x8TaAHkDUBiPK9Bx3UR8DB4F3A5ncCbKIpk27afi4Jz4fDcQcM2Sj8MwxnHcaIy4GHwCzRsYk2/iaI4rarqOzU4nC9DywbKIw6sozIHVpbM357ncN5C5D2UGGoWsCMfqGnJJhTgD6z1Jai5owaH8zY8N0jm+FEsAn5PDV4WlDfuE2+blBiN8Q7SAAAAAElFTkSuQmCC");
  pstrimg("?-23-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAABl0lEQVRIS92UP0vDUBTF70tS6OziJLhKbYNbJWCb9wYVnMWpILirqCjiJupWP4AoiE5+AUVMSh10EITWOrsLbv4BsbmexNaCtqUpqYMZX9773fPOPfcJ6uEnesimfwB3y24G95hmj4eEEH1MHINlL8R0qaW0NVvYH2EtDGxxys6mILHR8jDTGwueVym1F6ZAUzgzv6JYDDfx1Qcf1qq6ro9mh7M3nRZowFmswopDg4ztjJl58AGFu8ISbNqpF0GBI2WqXCh4u82wbBe3WKjtKcqUzEYGd0vuOpRvBdYQX8F3KzK4U3JukZ6RL+NpX5pyLhI4VJ9B9XhNtadrejp0Q38qcSuuRVU6BniwERbOo5nLnar29/0afwzTAdZnvyNI7KGhK2hkPgy4FfwaP9I1jytk0IxMyPuw4KZwRK8IpWP+IGmG1m8n7OduwG2VI3bvcY4PWKb1GCV8EbAJKH/Cg5Xr5sGqi/nb9xxpuUBlBVs8ZGlSJdV5ZLbUGxrMo0BSkvIkMjim0gFUBsqJpvCWnEYG7xbU7NwnZ1GbGM0ZlIIAAAAASUVORK5CYII=");
  pstrimg("\u21FE-13-220-220-220", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAi0lEQVQoU2NkIAMwkqGHYURo+v//P8udO3fWMzIyJquoqLzCFlCMQAViTExMkiBJoIZ/QPbtv3//vgdyvwP5eqqqqk/QNYI0nQYKmqBJvAdquAwUMwBq4semyRooKAuV+A901tt///5tAdJ/gWI+QCfux9CELgDy0927dw+ysLDEKCgo3MfqJ7qlCAASjDUOYV+JawAAAABJRU5ErkJggg==");
  pstrimg("\u2A02-30-0-70-200-3", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAEEUlEQVRIS+2WW2gUZxTH/99uEmwbogEDtpH6UutDaFRIs7tiISW7kWilor2BN1C0gqhRKKgULNJClWK1PijYSvHSglqKRbQmEaJEMxNXQSFiqSKIUqW0wqatJpPM6X9msruTzH6z60t96cBml5zznd+5z6fwjB71jLj4H/yfZb7EVItCynwFol4F7JehItWADNDLhxC5gs74TUDJ03gdDp6ffh4D1iYItkGpMq1hkSF2yw5E1U6ciWdKcUAPnmO8CVtOEzjOMyRnGNUh/u8aPxmo6AuETWWgH/B7yQjMhq2WojP2XTF4YXDSaEMEX3o8+RFS3obOhrtaY61GFYblEzq20TuDr9ARawtLfxCch9o0sAkd8T3FvM/JU+a77IFDbpYEhwlfroOPBqfMBqbuMg3ZdPswD78PRPbQwOaicAeq5BjPneK5pAu3ZTU6EwcKnfWB3c69ynrNYPcuJJu1U+95qVM7QuE5qKv9D4Fv0w57AkOISC3OzvpzLDwPbumZz7T8RIULaI81oe5GOWr7nejrQ+F+qMgT9sM0tx9Sxm7CNzD67SzXNg3YjfYUFedC2TF62Osq1vVVhMJ1UOfsnPSLsK27tPkI96smo69u0A/3InYBmXtM6e+YEKvHcTWcU9LBW4x3qHPcy4YvUr/1lMFGw2IGM43B3AqCm/oqUZ75jYJv0ZFYF2iGAFzus/61oVBH2GJ+RK92slUXcLudDIJz3Sx70Z5YHwBns/JS/wVGEMvJBX/AYjN2xe8VPJM0FnEfnGCd57HOp4PgZjOBqFyi4Au0x+ml5kmZH3Jk9vukB6m/UqvfbNQjimt6cDLNxW/dZvp2a8GjRybPChu1lLmGju7Tg7M1VugmeG5g24ztXqVm09jX7sy7zaWZ82yNhyOtONf4czDVkAhajF9obDKsqhp01f2VU9KNTLFRoze02c0gGjAYmYKuxgcFwPxXduAh69lge12lsDnNNpxuyTT3vo6ozX0gvcxigg5wDeef/OZqvVqDoQHvDWRNqkbFw7f4K3xOtfDGLRyl8xS/UWiUnGNjXhI9n7HBtjLl31NiUb5Muxz87vvT7oyYwj6KP+anD+Nj00ctpJFzo8HejYMzqaoJP0InbmFQvtHOaQCe+ZylrSB4LUU2hvEazsVvFBq34Ps4ZUxlXa6P3DxOcA5XlnadYTMlja2IqE+9TucbqiPhvHQKPoVvIN6C7yF8ius51Gb8be3Hxdn9AStNd8axHxYQdID6lfwegh2dxfFx3mzaJ+Sy54yDuX2kVp4Bgck/F3k5YB1lAn/PpFNJn/UfmKEVpWSo+PW2KT0R5dZG1m0VITXBEKSfDh2lbBf38a9hUfplxcF+7WR6POzBSpSJBXmuDI/LHqO7/lGpML/ev8zV1i4D1lDnAAAAAElFTkSuQmCC");
  pstrimg("\u2A02-30-0-170-255-3", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADpUlEQVRIS+2WWahNURiA/22WIXENuR6I6EpKuhHlJrOQ4riIF0IiFBkyXDwYHjwY8qB4QNyzL1dIhtyEzAkZH2QoMr0QD8b7+9bZ+569z9177XO88GKd/rOH9a//+9e/1v+v7cg/as4/4sp/8F+LfGGhVnWkSoaISimedUPaIt+QtyxWjaTkvDiO/onXyWBXDWA3wBSABlbDKrX0n5SGMl8mOW8KccAOdnVuBiqY89oTHDgC4BKY91yNU/2RKdybSJim/DZLubM6HzwenNa9GJvlD74PaLZMdW5ZjR3WzsRjH2NG+fjzuDMyKfxRcAA13u/F+zn5vM/2V2kFY9b6UbrJAg20wXPBVZpioOuH7IYfwjMyxRmXF57W9ehXoPcI6ZWBq+zA8cVxYwPwem0gveU1Sp2QNcgkpJ8/6FQiPIAa9Z84sJjl2clV5Zf0kGnOi/rwAFyly1HbisJzQtSd9GnB81MGd0yE50J/oTsAJ2+Lq+e4H4FU82wmkdM8sMlTVx4CKeFpKorpzHtXWybCbVAztlL7YO8eYvK9Aza/hMke2ACEFBExnV1Q+p5VssFdXYfOBl8vmGnYuqs3eCwFXiYp53IUXK0d5Ie8QuEy0GH1wxIz88/otEqEehPaz/9MZBV2t0TBwW6uQWF4BBxE5XEmInVN5St7d5BMdu7EjknrWiazEVnGjLdFwWmdQecBOk4DHhtrxIPv5H9hqP8q+oOt+mkdj90TdnClmnW4jpy1gnM3UphlT7W07sLmAjs4WONnpFJJpNrU370q5RjbBd3kvGnx8GCNlzCh7dFQX9BG7GlT+FuT/sUy3XmXVbLnaXKqeQXpOXaKkb6ATUXLtqCABAm/B6V5GY2kPK3bcLYik1Zzapl68FraS1cZ6vyMB1dqT04Yz6vGUkR6LeIuOU9t8JSMpyA9A9wVlUgqmWG5h4Srx3k3AbmNGA8HIPHFIex+uMiYFBM5g+WJXD8guQXJH5cLrtZ2fiFpRqm8xeCXRGGTNU+j8CO8asK4oVyV62jy19TsSIuex66WoVWDmC+Pu/yPLehzxttMhxhTnqGorORINIdObIv/AvEK/JXMLjcmRA4iy9l0byNWjmkb+S5Leb8C/cZo13I/Dag5163N/s1lZlAiR/21qjPwipsHGP/ItTV9Pbn2yFpXTqNGMqaQCOX/vHXVGDZ11pytzWOmYE6ya0gFEbmYNMtwX35wWNvVYgJZxIb7ijRlxp+Y3ctCYWG93yq9Uy7RFP9wAAAAAElFTkSuQmCC");
  pstrimg("\u2A01-30-0-170-255-3", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADhklEQVRIS+2WW4hNYRTH1zdjMA01iObBlIQieVCGmHGJUpNR0ozbeFDkxS3JXbxMpJRQMh4wuZ19MnIbxPBgNDGJJxIlIpLcr8PM8vv22cc5M2fvfbYUL3atc7691v9b/7W+y1rbyD96zD/ilf/Ef23loy+1oyWiMp7IhiKv2KT+vL+XHGnmv16qzMffiTqc2NHeON0GSTVO80McK7iz0kUWy0zzPEoAwcRxXS3tshXSHM/RbcZxdC1o1NWpjEQq0Y/y3tuxrZNKsz0buT+xo0eYONdz1oLjuSzlQ/fd0d38LkGOopvn6o5pseTKcUZjPcKzhDNdjEkE6PNkEjvqgKt08zGyNiN6R+uwzUcaIZ7Swaejy3nf6emuYJ8cjTiuS6HbhbRDOoOJpzMmhhFbcEynMPcCo1xkIz5qwjPep3nSS94BsodoHRO2+UabjdhOiutCgt/P6Ie0Sh+pNu87+0otdUxriHQ9gPss9NDA/YlCbFkcvcFvCVJLEov9iW22hfLGzdbIBIBNQXuDw+A9Tp90XIdzwu+g+iA9pEjKzbd0cyLjeu0n3+UppG956w9x6x8Tq9rLd48lH4zfEnzeyiSOaQVGe5BCT6I7MWrGCay9YrPwvYrbscOPuApjDEMNEY729iYo6R6/iootmcHPI0z7we6JQmxP42aAxSEOo5lUPgGc465khIxt1nsBjuC/jSCS5VLQGW63zXAZo5H8P8O+gXHPjEgsVuQJ+ImMVoQRJ/f4JofALnXwE9NaHC0CcB5seSjW0TPYpyELwB7M3ONT2lO+yks3p3zpKxXmc6DDqIdri+bIMHwKFzWXrevUtVIFxNFrgEr9lqVDEFGJU9XLtyCliOM6mT27DMkXpF9gY49CnCxIRgr8ltkm0rE7xbQZzRj0TRCX+S53FOLU3gaW347Eib5q+25Xsm+QKg5G556ajTimhwne9uk2ZAQJ3PVLILMf27YmctErErYIlDH52a/JyX6tcl1mmdI0vf1MuuRdNfsptAD7oaBD6v8FEtcyb7+7MtE6OYDDDQTwgn47Dl0FN/wcZfCanNRC6rztaisR24PbwE7F1hh21YK/ueq0QLrJGZxMSnNgM3+AvCaY7tiGMB6UZm/iOk4NvY4eOPvn7QkdSA5rwE9HinyyaCWIq8gmmW1awrJMt2UnTkc3aDf5KAMoM91ddR5tdKZ5HJUsHfcTALM/Ltofb7wAAAAASUVORK5CYII=");
  pstrimg("\u2A01-30-0-70-200-3", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAD3klEQVRIS+1WaWgUZxh+vsls6o1UxXpAEJUGlKC4NpviEU0y8cBiBRVCW0EUf4ihpYgHUij9YTxR9IdHFPH6oaCIoGYjdZHozqZbg5Sg4oWiVTwqGtS4x3x9ZnZzbHZmdjzQPw4MzHzH+7zP+37v834Cn+gRnwgXn4E/WuS9h3rqpQIo8dGAHMkEPeU7BBItEEoT7veMonlU7G28dgeeFe2BN/FFNLgGEANcDBt0Yh1U1OB04IUXB5yBtfAsGjsGIVTLkJRHIMVhKOq1DsPJERyfT/Y/pNck+D0HwZKTucDtgTV9JTeuTRnDQcTVXxDyP7H+KyJLIOQOfq1CMFBjjZU29UX+m038WpgGrEGweDWjJJ0cyAau0H+j179zg0HU2Vnea5HlHF/PdxvnqjMMlzVOQ55xOs1+O+pLlnkDrtA1gtYxfAkoih91xZezNroBm4u1aCFkvIkp6sbUzEF98XE78A7Gc2UenusPrENkYDbOBk7YepsL2EpH42QII8SvV4gN7IfQsNautjqAyyNVUOQhhvAMczfDMT9egC1wfT+j9yPtVTMl2+yBLbaRewxxfyR9hfjTf9PxVHoFrowOghG/RQL/Iv76a4SmJDrbTDEube4F3wszzHfRt7gIR0XyvYGZYGj6KVZFOaRvOM7672YDl+lFyMNlMnY9idZGr4yttWFTeP4g+EzUB07ZADeOZxk00skq5iTA3HxPJ1hOts+QTqJyxzEyQkQ5t5NvMDcwlMksX1MUShwNep94iCQqU5HMxdiQa8jmCG0PsxgLoWTiyJccM0VhPo2RkfyZoexp74vyiMI1jmtqXYDbcowDzMVPrqS0MNVKbOWajSw7qpjLo+mm7K6kLkykLjRk53j69S+QfPKAnsXxn28o/vbHP8ypjlxh5AqgioFdu1aHgGj6LoIttgtLhhNeT3W7etkLUidgaiwSV5iTx7jfZ6hjY/cC3CZIwFd2YTaJZHYnLbyPQwsYnlp2lsW24fYC3JZbF/nNBLb6aisVRvQm6Ab21BVZmp0LuCK8giffLMkYYkoBQt88tCOQ3Y9Tbe2ftEich6F+R7l73r65rV9LuYdRMa9Fqce6JiX2WqVm9nIpJ3H+gtMhtb+BVF7klUZcSjM3aOZXvE7swYUJLZgaHY68RAkUQ0fdtzdQersb1Efz2AZ3pnqwbIXwjUXQf9Wt0pzvXKOa8zG4ZTNPwdJ2A6ZoCPkXnXrM8e48iGPpXHkngN14qi51Lcf04tzX27JIP+p4FcEWEmxMNgvZwrFaGL4tXTvQuzG221V6TkV+/pdICJ81Hev1Cg1Fz9wAnOb+Bwqkry6/MQ1HAAAAAElFTkSuQmCC");
  pstrimg("\u25C6-27-240-240-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAA7klEQVRIS+3VPw6CMBQG8NfVBTiCJ3A1UY/gYFw8o4Nx9ALC4KBX8AaEsBGCXxMlRUr7aE3jABN/3suPvn4EQQEPEdCiCfvJtKcxTmM0TuC/ApLnNMfr3pqGsiShrc/mGVcGIAL2FIKiN3KOY9q5goOYBvoYzqAWM0BeYA9jQM5gBxsBOYEtJlMH7K6EgZuDE0Kz5xSrWIaGJafpq6bB9QHg0dbbYkVBm7qmC1Y2szWpzzGNK76/Naens2dlSYuqopQLAkoBrTiQrOmlkQuOhbSYvGkDXaBBzAS6QkZMB/pAVkwFcf4YEwZdaIL+z16K9WUcTbIElgAAAABJRU5ErkJggg==");
  pstrimg("\u25B7\u25B7\u25B7-13-0-70-200", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAANCAYAAAAqlHdlAAABXklEQVRIS7XVMUvDQBQH8P9Lo5OI4Co4Kii4hEbrItRERHBTEAT9FLooIrrrB/AbKDpWYkUQ8VJQOgni6FQcBFEQWtLzRWlsSpJbcrfkSPInP97dvRA6o1wbRmPgE08TzeieaqI5Q9H3HX8XhB3AnIJnPatcv881Z+I4yFEGrgLGHjz7SAkMcRoz/zjXP4CEwJVd4YqcATQOaZZQtT5SkZozcVxb1lGdOf9bMrEMogsExhKui5eJwBCnMZOOCzXhhi/IB67oHYbsTZxSEEP24nLOZOM6Ekds8XQfsm+Ml/k1AibhcsyocYv+IAJZ4eo18CXXIUrfSlxOmWzcvJiDQTeMWYE3zYekZyRVLsdMCk4SnNoxSK4B7Ul4s2/qA5F/Jo4DbtE06+hvvXArOeFet81XmdlKNGa6cIL/DtjgvTUCKpThFe+VTdjVm+nGHULSAt658T5aLSUsfMEVWjM/dGpiHV6K39oAAAAASUVORK5CYII=");
  pstrimg("\u21FE-22-220-220-220", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAA7UlEQVRIS2NkoBFgpJG5DKMGw0N2NCiGc1DcuXPHE+g/TxUVlTxSMhPBVAE0uBNoYBkQzwYankas4QQNvnv3bvn///87oAbOAhqeTozhjLdv384CeZWRkfEXFg2/gIbqA+U0gXI/gJiDWJczAr16GqjYhIAr/gEtsAFasAeojhPIjlBVVV2FTw/IxauAGnyBin9jUwiU4waJA+WPANl2QPoePz+/vpiY2Be8BhMKL6DFVUADW6GG3wWGsQaQ/4eQPoKRBzS4A2gQKALvAl1qQMilMAuJMRjk4lQ+Pj5dYg0FGU7QYEJexiU/9AwGACmdURegIv+UAAAAAElFTkSuQmCC")
  pstrimg("\uFF0B-16-170-170-170", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVQ4T2NkoBAwUqifgbYGrFq1yoORkVEgNDR0BS6X4nUB0ICjQI1CYWFhmmQZsHLlyt1AF4gBDdAfGAOAXtgMtFkC6AJTgi5YunSpICsr60GgQh6o4j9AWgmIfwLxUyBmgYozMzEx+YaEhFwC8eGBuHbtWvm/f/+eBor9R7KN/////0zAcHiPJMYGZDsCXXUBxQBsTgQG4g6gZmGivIDDgAGOBaAXDkLTAXkJCRiNUaAwACblyQSjkdxcCQAX/D0Ryexh2QAAAABJRU5ErkJggg==");
  pstrimg("\uFF0D-16-170-170-170", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAT0lEQVQ4T2NkoBAwUqifYdQAhsEUBsuXL5dlYmI6xMjI+J9A1DID1fmGhIRcAqmDRyPIAGZm5rNAMUIGsAHVOIaFhV1AMYDcBDWakKiQkACeewwRinYm/AAAAABJRU5ErkJggg==");
  pstrimg("MSG-15-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAPCAYAAABwfkanAAACh0lEQVRIS9WWSaiPURiH7zUWYSFKhIiQ6YoyrJQsCClWhpSpriG59+6slCIkZcywIRspZYitBRZmSuaQlJKQZPY8dU6dzv2+v/+fm7qnnr7ve8/0O+d9z3u++rp2WOrboea6KLoP4nvDR3hVsJDh2DrAc/ic1HfhfRz0h+/wDp7C65LNGIJ9DHSET/ACHsO3WjYvil5Ep+NhwtGZMCe5EwadwvNqeG/geQH6Fkx4BNsq+Bnq+vHcDQtLxM3BfrZa4VH0PDqcDp3SAazfA42hbhLPa9ATbsJb2AB3wbaKmw+zYDr8gAHwMvRfEsTprV4wAXbCCdhSq+gFdDgZOj3k6W7rsqGg+7ZDC0TRI3i/D5tKJuuB3VBzIUdhGUyE6wXCOmEbBE/+RvQ2Oq2DczAXzsBWmApr4XYiejDvz8CFWvemZMLu2A2t87AeflUrrFK7GB7u9C4YC4fAOF0BD0BX635dHHc6D5sb1F2EK2D4xIM4jHc9txIOt4Vgx0hF7+Xb063wy2ECM8FIGAiPEtFW69bFsBomZ4KW8n0MYhjpDcePxQUsT77z+orry0U7yXu4BNMgTh53LO50Pmg3DKZN++gxi+fCcg8Ms2jXpmA3qCs0wT+LNtfOgIMwHjxQfxKdLiIeakV7uDx8ZptRYay0bWc+bsE+SD2Rtmn1XrTTis5LLlqPzIT9kF8Mm7GZBhXt5WH4HACziKnzSzL4fxdtytMLO8CcbYybh83T5vaYLQyBUzAbzDKGg7eu+duFey6awXxdVcmzR5ELHSjutOFi6jMPu2sbIb8R12AztLxYYomH1rSatncRXiqmzrKrv9VC2uKHyVzsblo+gP8glYrxbfuv4KGvufwGY/CWEJaNvNwAAAAASUVORK5CYII=");
  pstrimg("MSG-15-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAPCAYAAABwfkanAAADeUlEQVRIS9WWW0iTYRiA3dy00hEeIEgoE2YFdoIMoryqkMwOYAeyA4FGhLTMTS+MwouYx6kQlNpdhVGZgV0klUVpRUF0AqPChESpyItNd+GOPe/YP37X0indOPj4Du/ped/v8E8TMwd/mjnIHBOAbmhoyKZbodFoRsxmc486Eb/fr0F+AJlep9M9KC0t/anIq6urk2JjY4u0Wu1K1lzo/PB6vY/Ly8v7GPvDC4KfPaztoOlodtrbuLi4uyaTyTGT4inQtzDaR/MClqYGq6+vPw5AW9DpWYvFYg0meoqEmpFpIwQcHh8fz6iqqnKJrK6uLofEOhmm/gOuBb8nowVXoK9gUBw0CjkgqDYxMXGA9fSgDN8WGxBGID4B7WZdkrjOWMfaBsYmxlnx8fHJVHCC6m5j7UHQvoOdOE/7hdzo8/kOkrTAfsDv+plCX8XgiBgR0IPDFNky4AoA6WDtM86XIw5AAyK6YvMmUjB2ZxlHZFCSTkhIGMJ2MT7OsNYcDtba2rrAbrdvr6iouDMb6EKMWmgltDZgThC8n/FSgprpLyvQrO9krYv5b2DygXkVKWBNTc0Sjts3dL47nc5MkvBECzaVnnI8pGqFVHUdW/eE8XxaEWA36C8StIvxQwU6wrGZQCbHqA8f7WVlZU8lKMntx+4mw/sUIe9/AIuPEDRghwiYzjk7SqALwQBeXodUEtnK/LYCLTLZVofD0c4wF/15YUCdQBYAfRjZNWQ9zMWHHD+NzWYbYpimsgnJo0lsEjQBVhkMhq9jY2PyHEm1leBKxQJnOtxxY2NjGsmuBugYsr0iJ9mN0pPwS/y+wC5HgeZO3GMtnbmelqlOalbQOO+nQjacngbCKBdKtc0RodWBAApcauyL5FgxHqFpFV9q3draWgPJjSLrJc6WaIBF569KC3S4cTi0bDs6xbwyu9QfhuDWv0eWReXzeBG6SaKbeS5t2OVyramsrBxV/CvQzJ8pxyca8EnQZL2WS/RxOmjVkydfvXfAvqaPo7q76ZOZDyqvhdVqTdHr9QPIFrLuo++kl7kR3U20RcyfU+nN0QBPqjSTwkhbKEqqSpdQkUtNTU0ZHo9HLmF2+BcRH4/YgXz5sCgQqksrT2XoCypJoNNLf45d6Z0RdLTKkfTkLaaSSRwHqfoAFXNO5U++przdSW632w7ol0j/Uabj+QMXqd0ffBJRZwAAAABJRU5ErkJggg==");
  pstrimg("MSG-15-190-210-190", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAPCAYAAABwfkanAAADiklEQVRIS9WWW0gUURjHz5nZVSmJgrACfUiKzNXdokjDtZzZLY0iKhASoh6SHioKfEiQLkYESXcwCcUgfOtCl4cC250xkCR9adYVZR8UDJEMEUKf2p3T/8zOLLPLprviiyuHc+ac7/L7vu9cpGQV/ugqZCYGtKqp5xhlpYyxaZ/H98QeiMpUBwux25B0CILwpqasZshaV0YUF4mRJuhtpZT+RT9LCe2nbtopUSmamhAlpNzA3EE0EW0B8qNoXf5d/kg2yTOgYWwAXSUjTBcFsTIJTFOeAvgKl4ODHgR11tR5jv4CWrpqzelOfbt/p3/WkNWUi5BqwzD/P3C9sluuzRTcgg5AwWcqJQyoE2oe+8N+wuFGY42RbtkjNyrDylEE8JEyGsPaa1TpJTLsxJwXfT2CL8pjeUVVnqoZJKQJmg9N/e9MYG2oyjh090L+FFotdCZhtzgr6GAo+BWKB8xsxmColJcsqAVb4eAW5qfRtiSgQwrP2jV8T6RzFhwOHvaV+3rNoKcR2HrIdyGbvDJJP2zNQp3ojahga9bQUPAi+l44qMM4AAeHAD1lZrkTQV1OQGtKC+bvQm4e/VW5XH6RzmEgHJCoTgOwO0sdtFhySfOZgi0mZ2wPnmkDmtIGDoby5sDRAwC1YPwZwF+w/siCTrNtopD7Bf1RyL6X3NIz0+4dfF+H3g9UZPdKAHMbCWgYr8a3BOeNGJ+Jb2GmC0RwoW/A500Lmq/xsmIvv8OcB1acdiBsr0GUuwLJuAdbzZAZAXSZocdvo2E2g+GGhI5tPZPAkqEZqY/lxwLCgjADZzk251bGjIOYarhP66vWqb4f8yfRKsyAz8ezQrvRRbDdSixoPaQPYlyAyvCrb7M9qGVBA+otTvwHZPcYPB7hBwoZWxTa7sh2qB+LotgTjUaHOLllyy6rhtVtekwfw+KYVYllQ6cqpkLzskPmONPZCfvDYJZ+HGuFyF4zQO5DVgOUG3NzRCCSXCZrlv2VgabkNG6CV0tBoxLxK894b9gkshgBpAPf+1DytRj/tm4LJax4WIx9w/waLo8/vjWmMCiEXgkCWgcbEZyBHZlkOb7l8LNuj3QlNNfj24OSDgR1CYewDoewHWv8QUh+ERkJ55JcH39YEhm1Di0he1LkGeDHcFO1oyodWUFnKpxOjt/FIhE38Rw6BeeA1+WdXMye+ZoWGHe3m35K9z/KUjz/AGGp5B8u50EDAAAAAElFTkSuQmCC");
  pstrimg("\u29BB-35-0-0-0", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAACwklEQVRYR+2XW4hOURTHZx6USXmjlCclt4lxH/dpCjHl8kApU18pIl6NpLzI7UER0yh5FB5cIo3yhMK4TG6FxANNyIQkZSb5/WvvWu32/pwzx8OXzqlf3z7r7LX3f6+1b199XQ099TWkpa4Uk8pGGZkyMnlXajlnyjnzX82ZpYzmOfSZUY2i3ALNMNbZv/P7Am7DQxgw9edQ/gYvi0RmPc7n4D3Mhh+wG3b9pVEJa4fLsMAJlG0avM0jyC7t1TheSjir8f3QC8MciuLWRP1P2Ge6gWXWE+4zK/C8FngrYhJpU+GrjKGwBfYaHwlRSnNFRf6hGM2Jd0HDE3n/UmV40/n2yHy/RbkFfmcOiatoxah8GipBI34OfYg0PgObJnD4KMLdRcQ04vzUNbCY35Fw1b1L0Cz4aDqwQpSaebAZOuAVqL1YapMabWQOuoYU5lYYhDVwMSIoFKJV9BrGOyFymQ938kTHi9HvcdgGq+CKacQKeoN9D5xx3xURL0Qmm+rtvJ8YipjhON2DqdAEj4NGrCD/KRTi7TspHIJ/IkYdawMLnwsY1hqj9pkbkXqKrPyHLGYEzj0wORGZudjvBh0rZbJ/Duzad7qKiLFzZgMNnTUdWCFKjZa/PyJigk7xfVMRMer7GOwAdTAJfrmR+4jYORJOah8hHarPYDQsgZuRNCZNdmnbfWYlHtpT/IYWm6yhIO1DFTgCqj8lksKq2rLswKlVo4bXwflID7knr9rIcjZpxPa8Cvtuw+B3an1TmhXln3lSFBOji5H2G/ss50VLOHbwNWDXXeakcdDRob2qv4iYhTjrKIg9StU+0H1GtzidW4vgQKJ+atlX1WfTpItSJ6hjCfsKh6GSYYS6ER6FZeDPsgmUdWBmfsI5sxHPB6D7rX/GuU4UCd1tdEg+cXV0EbsO9nqhOaQB3c+swlWsqX+UfwDaQqAkz4jt5gAAAABJRU5ErkJggg==");
  pstrimg("\u29BB-35-140-140-140", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAADfUlEQVRYR+2XS0hUURjHnZGZWSj2sAILKdrVJjeNLZKgDIs2SlAZraKaMJtQx3FTNGFF6cxY2QMs24hgj0UoQfSkKFxItIighSEh4iqoQBcxd6bfd7l3OB7uNN2hhcRcOJxzvuf/fN93HtdTsog+zyLCUlIEkysbxcgUI+N2pxZrplgz/0/NxOPxpMfjGevo6HhlryqZTAYNwzjJvJa2VOjI/KL7Snvs9/uvh8Phn7Y8NqKMZyKRyHDBkent7R3GyUEMGOl0epvP55sFxBjzjXmMZuAPsoBjiUTiDONztAy2GqGNugGU3dqs6DaKR3Ioi8MJ2jgtkMlkAjjbznitkzz8NPSGzs7O5wWBESWi04+TVs3AMKloUVNh83t6euq8Xm8/8002TYBAa3IbFTP9qmPA1APmmWq4tLS0pr29/WOuFaLTio4AMj/AzM/NzS2LxWJSV66+LBiUvWVlZdMYXq1ZMGsoGo2+0y0DJIz8VZ0OoGuk6JQrJGpkqBmpF6kbWV03TioZtlgGDWh1OJCaMT8ViKQG+b30F+k30KcCgUClU2r/BNCMDMoewHyyDM1XVFSsDIVC89AGYR/WAelAqJED1MgD6Puwcc+yeRrwF9xExwQjKSovL//CcB1tgDMiZBvRAUF/SNtvOZRiNYHYdpRUv8BOvWswrGgVSlIvfvoTGLmpGtEAmSxr12SBKOAllVto/wTMHcAc1VcEoG/Qliv0BHIRXY6FDbAo0S8MDCdnNSuVNPmcIoODLhxc0hwbzGvB816L4hPmDQWDUWsGUCMUXrPtQAVi7ZrP8OwrYgEg2QgsbBr+GsYvsbPDdc1YRiZRXE8zOOhWtLW1fdeB2MXqUNRmhKxLdZwoerFzHprcVX/9qXdT9pxBux+Ak/aB5lSsDtu+Bvlb6G61IhjUU5gPVd4TONeuEcNEbggAhxycuC5esZH3bgLMbq6Cp7lWRYRuwLNPahGTNFeT5tl8kdD5C8BYD6PLqhBgrnDxdTldfH19fVWpVOou0dml6BjMN3MQfigYDCGPYeSskwGrBt7Qv4Y/g1wV/R5aMIdDx22fD5xawJKKndbDqBmHU4wfOdziTjYneBU2kp5umOZdhm4zW3skHwCVnwVjbe/7MEfZBUO2EBFrYnycJrtlCb289OSt8oO5PCvkJH5ry0sN8eSYos7iboCI7KL6o/wNnDDMMx5uy1kAAAAASUVORK5CYII=");

  setTimeout(function() {
  
  requestAnimationFrame(dspview);
  YagolsSetZeroTimeoutFunc(tick);
  
  addWheelListener(canvas2, function( e ) {
    var e2, x, y;
    e.preventDefault();
    if (swzmsw) {
      swzmsw = false;
      if (swzmf) {
        swzmf = false;
        swzmcd2 = performance.now();
      }
    }
    e2 = normalizeWheel(e);
    x = cellX(posx);
    y = cellY(posy);
    scale -= e2.spinY * 5;
    if (scale < 0) {
      scale = 0;
    }
    if (scale > 100) {
      scale = 100;
    }
    calcCellsz();
    posx = x * (cellsz+(cellsz>grb?1:cellsz/grb));
    posy = y * (cellsz+(cellsz>grb?1:cellsz/grb));
  });
  canvas2.addEventListener("mousedown", function(e) {
    var x, y, f = false;
    x = 0;
    while (x < fbutt.length && !(e.pageX > fbutt[x][0] + 2 && e.pageX < fbutt[x][0]+fbutt[x][2]+6 && e.pageY > fbutt[x][1] && e.pageY < fbutt[x][1]+fbutt[x][3]+6)) {
      x++;
    }
    if (x < fbutt.length) {
      if (!fbutt[x][4]) {
        fbutt[x][6] = performance.now();
        fbutt[x][7](fbutt[x]);
      }
      fbutt[x][4] = true;
    } else if ((swzmf || swzmcd2) && e.pageX > sclx-sclr && e.pageX < sclx+sclr+4 && e.pageY > scly-sclr && e.pageY < scly+sclr+5) {
      if (!scl) {
        diffx = e.pageX;
        diffy = e.pageY;
        scld = e.pageY - scly;
        sclpx = cellX(posx);
        sclpy = cellY(posy);
      }
      scl = true;
      swzmsw = false;
    } else if (e.pageX > spdx-spdr && e.pageX < spdx+spdr+4 && e.pageY > spdy-spdr && e.pageY < spdy+spdr+5) {
      if (!spd) {
        diffx = e.pageX;
        diffy = e.pageY;
        spdd = e.pageY - spdy;
      }
      spd = true;
    } else if ((swzmf || swzmcd2) && e.pageX > sclbx && e.pageX < sclbx+sclbw && e.pageY > sclby && e.pageY < sclby+sclbh) {
      sclpx = cellX(posx);
      sclpy = cellY(posy);
      scale = 100 - 100*(e.pageY-sclby)/sclbh;
      calcCellsz();
      posx = sclpx * (cellsz+(cellsz>grb?1:cellsz/grb));
      posy = sclpy * (cellsz+(cellsz>grb?1:cellsz/grb));
      swzmsw = false;
    } else if (e.pageX > spdbx && e.pageX < spdbx+spdbw && e.pageY > spdby && e.pageY < spdby+spdbh) {
      speed = 100 - 100*(e.pageY-spdby)/spdbh;
    } else if (e.pageX > runtx && e.pageX < runtx+runtw && e.pageY > runty && e.pageY < runty+runth) {
      if (!runt) {
        swrun();
      }
      runt = true;
    } else if (!ddiamcd && ddiamx > 0 && e.pageX > ddiamx && e.pageX < ddiamx+ddiamw && e.pageY > ddiamy && e.pageY < ddiamy+ddiamh) {
      if (hist[histh][0][histi][3][1] + (hupdc > 0 ? 1:0) > 0) {
        if (revert()) {
          ddiamcd2 = performance.now();
        }
      }
    } else if (e.pageX > dsppostx && e.pageX < dsppostx+dsppostw && e.pageY > dspposty && e.pageY < dspposty+dspposth) {
      if (!dsppost) {
        posx = posy = 0;
        dspposcd = performance.now();
      }
      dsppost = true;
    } else if (e.pageX > dsppxctx && e.pageX < dsppxctx+dsppxctw && e.pageY > dsppxcty && e.pageY < dsppxcty+dsppxcth) {
      if (!dsppxct) {
        x = cellX(posx);
        y = cellY(posy);
        calcICellsz();
        calcCellsz();
        posx = x * (cellsz+(cellsz>grb?1:cellsz/grb));
        posy = y * (cellsz+(cellsz>grb?1:cellsz/grb));
        dsppxccd = performance.now();
      }
      dsppxct = true;
    } else if (!genbbl && e.pageX > ngenbx && e.pageX < ngenbx+ngenbw && e.pageY > ngenby && e.pageY < ngenby+ngenbh) {
      if (!ngenb) {
        if (nextGen() && stpga) {
          stpgcd2 = performance.now();
          stpgsf = false;
        }
        ngencd = performance.now();
        ngencd5 = performance.now();
      }
      ngenb = true;
    } else if (!genbbl && histgp > 0 && e.pageX > pgenbx && e.pageX < pgenbx+pgenbw && e.pageY > pgenby && e.pageY < pgenby+pgenbh) {
      if (!pgenb) {
        if (prevGen() && stpga) {
          stpgcd2 = performance.now();
          stpgsf = false;
        }
        pgencd = performance.now();
        pgencd5 = performance.now();
      }
      pgenb = true;
    } else if (
        histgp > 0 && (histgn === 0 || hupdc === 0)
        && (e.pageX > pgenfx && e.pageX < pgenfx+pgenfw && e.pageY > pgenfy && e.pageY < pgenfy+pgenfh
            || (f = osctlw > 0 && e.pageX > osctlx && e.pageX < osctlx+osctlw && e.pageY > osctly && e.pageY < osctly+osctlh))) {
      swffwp(f);
    } else if (
        histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1]
        && (ngenfx > 0 && e.pageX > ngenfx && e.pageX < ngenfx+ngenfw && e.pageY > ngenfy && e.pageY < ngenfy+ngenfh
            || (f = osctrw > 0 && e.pageX > osctrx && e.pageX < osctrx+osctrw && e.pageY > osctry && e.pageY < osctry+osctrh))) {
      swffwn(f);
    } else if (stpga && !stpge && e.pageX > stpgdx && e.pageX < stpgdx+stpgdw && e.pageY > stpgdy && e.pageY < stpgdy+stpgdh) {
      if (ffw !== 0 && ffwstp) {
        ffw = 0;
        genbbl = false;
      } else if ((x = stpgnm === 0 ? stpgn : stpgnc + stpgn * stpgnm) === gennum) {
        ffw = 0;
        stpgcd2 = performance.now();
        stpgsf = false;
        if (stpgnm !== 0) {
          stpgnc = gennum;
        }
        genbbl = false;
      } else if (
               x > gennum && histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1]
            || x < gennum && histgp > 0 && (histgn === 0 || hupdc === 0)) {
        if (run) {
          swrun();
        }
        if (x > gennum) {
          ffw = 1;
          ffwm = 0;
          swffwn(false);
        } else {
          ffw = -1;
          ffwm = 0;
          swffwp(false);
        }
        ffwstp = true;
        ffwstpc0 = 0;
        ffwstpc1 = 0;
        ffwstpc2 = 0;
        stpgcd3 = performance.now();
        genbbl = true;
      }
    } else if ((cruleb !== histcr[0] || crules !== histcr[1]) && e.pageX > orulex && e.pageX < orulex+orulew && e.pageY > oruley && e.pageY < oruley+oruleh) {
      cruleb = histcr[0];
      crules = histcr[1];
      hlcrcd2 = performance.now();
      hlcrcd = null;
      hlcrcd3 = null;
    } else if (e.pageX > swzmtx && e.pageX < swzmtx+swzmtw && e.pageY > swzmty && e.pageY < swzmty+swzmth) {
      if (!swzmt) {
        swzmf = !swzmf;
        x = performance.now();
        if (swzmcd2) {
          swzmcd2 = x-swzmcd2>swzmcdn2?x:x-swzmcdn2*(1-(x-swzmcd2)/swzmcdn2);
        } else {
          swzmcd2 = x;
        }
        swzmcd = performance.now();
      }
      swzmt = true;
      swzmsw = false;
    } else if (ffw !== 0 && !ffwsbcd && e.pageX > captx && e.pageX < captx+captw && e.pageY > capty && e.pageY < capty+capth) {
      ffw = 0;
      genbbl = false;
    } else if (histgn > 0 && ffw === 0 && e.pageX > captx && e.pageX < captx+captw && e.pageY > capty && e.pageY < capty+capth) {
      capHist();
      capcd = performance.now();
    } else if ((stpge || stpga) && e.pageX > stpgssx && e.pageX < stpgssx+stpgssw && e.pageY > stpgssy && e.pageY < stpgssy+stpgssh) {
      if (stpge) {
        stpgn2 = -1;
      } else {
        if (ffw !== 0 && ffwstp) {
          ffw = 0;
          genbbl = false;
        }
        stpgn2 = -2;
      }
      stpge = false;
      stpga = false;
      stpgax = false;
      x = performance.now();
      if (!stpgcd || (x - stpgcd) > stpgcdn) {
        stpgcd = x;
      } else {
        stpgcd = x - (stpgcdn - (x - stpgcd));
      }
      stpgcd2 = null;
      stpgsf = false;
    } else if (stpge && stpgn > 0 && e.pageX > stpgssx2 && e.pageX < stpgssx2+stpgssw2 && e.pageY > stpgssy2 && e.pageY < stpgssy2+stpgssh2) {
      if (stpgnm !== 0) {
        stpgnc = gennum;
      }
      stpge = false;
      stpga = true;
      stpgax = true;
      x = performance.now();
      if (!stpgcd || (x - stpgcd) > stpgcdn) {
        stpgcd = x;
      } else {
        stpgcd = x - (stpgcdn - (x - stpgcd));
      }
      stpgcd2 = null;
      stpgsf = false;
      if (ffw !== 0 && ffwstp) {
        ffw = 0;
        genbbl = false;
      }
    } else if (dwrld && cellsn > 0 && wrldw > wrldm && wrldh > wrldm && wrldax > 0 - wrldaw && wrldax < cwidth && wrlday > 0 - wrldah && wrlday < cheight && e.pageX >= wrldax && e.pageX < wrldax+wrldaw && e.pageY > wrlday && e.pageY < wrlday+wrldah) {
      if (!wrlda) {
        posx2 = posx;
        posy2 = posy;
        diffx = e.pageX;
        diffy = e.pageY;
        wrldcd = performance.now();
      }
    } else {
      if (!mdown) {
        toncd = 15;
        ton = false;
        posx2 = posx;
        posy2 = posy;
        diffx = e.pageX;
        diffy = e.pageY;
        mdown = true;
      }
    }
    e.preventDefault();
  });
  canvas2.addEventListener("mouseup", function(e) {
    var x;
    peMsMove(e.pageX, e.pageY);
    scl = false;
    spd = false;
    runt = false;
    dsppost = false;
    dsppxct = false;
    ngenb = false;
    ngen = false;
    pgenb = false;
    pgen = false;
    mdown = false;
    wrlda = false;
    wrldcd = null;
    swzmt = false;
    toncd = 0;
    for (x = 0; x < fbutt.length; x++) {
      fbutt[x][4] = false;
    }
    e.preventDefault();
  });
  canvas2.addEventListener("mousemove", function(e) {
    peMsMove(e.pageX, e.pageY);
    e.preventDefault();
  });
  canvas2.addEventListener("dblclick", function(e) {
    var u, x, y, q;
    if ((!((swzmf || swzmcd2) && e.pageX > sclx-sclr && e.pageX < sclx+sclr+4 && e.pageY > scly-sclr && e.pageY < scly+sclr+5))
        && (!((swzmf || swzmcd2) && e.pageX > sclbx && e.pageX < sclbx+sclbw && e.pageY > sclby && e.pageY < sclby+sclbh))
        && (!(e.pageX > spdx-spdr && e.pageX < spdx+spdr+4 && e.pageY > spdy-spdr && e.pageY < spdy+spdr+5))
        && (!(e.pageX > spdbx && e.pageX < spdbx+spdbw && e.pageY > spdby && e.pageY < spdby+spdbh))
        && (!(e.pageX > runtx && e.pageX < runtx+runtw && e.pageY > runty && e.pageY < runty+runth))
        && (!(e.pageX > dsppostx && e.pageX < dsppostx+dsppostw && e.pageY > dspposty && e.pageY < dspposty+dspposth))
        && (!(e.pageX > dsppxctx && e.pageX < dsppxctx+dsppxctw && e.pageY > dsppxcty && e.pageY < dsppxcty+dsppxcth))
        && (!(!genbbl && e.pageX > ngenbx && e.pageX < ngenbx+ngenbw && e.pageY > ngenby && e.pageY < ngenby+ngenbh))
        && (!(!genbbl && e.pageX > pgenbx && e.pageX < pgenbx+pgenbw && e.pageY > pgenby && e.pageY < pgenby+pgenbh))
        && (!(histgp > 0 && (histgn === 0 || hupdc === 0)
            && (e.pageX > pgenfx && e.pageX < pgenfx+pgenfw && e.pageY > pgenfy && e.pageY < pgenfy+pgenfh
                || osctlw > 0 && e.pageX > osctlx && e.pageX < osctlx+osctlw && e.pageY > osctly && e.pageY < osctly+osctlh)))
        && (!(histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1]
            && (ngenfx > 0 && e.pageX > ngenfx && e.pageX < ngenfx+ngenfw && e.pageY > ngenfy && e.pageY < ngenfy+ngenfh
                || osctrw > 0 && e.pageX > osctrx && e.pageX < osctrx+osctrw && e.pageY > osctry && e.pageY < osctry+osctrh)))
        && (!(stpga && !stpge && e.pageX > stpgdx && e.pageX < stpgdx+stpgdw && e.pageY > stpgdy && e.pageY < stpgdy+stpgdh))
        && (!((cruleb !== histcr[0] || crules !== histcr[1]) && e.pageX > orulex && e.pageX < orulex+orulew && e.pageY > oruley && e.pageY < oruley+oruleh))
        && (!(e.pageX > swzmtx && e.pageX < swzmtx+swzmtw && e.pageY > swzmty && e.pageY < swzmty+swzmth))
        && (!(ffw !== 0 && !ffwsbcd && e.pageX > captx && e.pageX < captx+captw && e.pageY > capty && e.pageY < capty+capth))
        && (!(histgn > 0 && ffw === 0 && e.pageX > captx && e.pageX < captx+captw && e.pageY > capty && e.pageY < capty+capth))
        && (!(!ddiamcd && ddiamx > 0 && e.pageX > ddiamx && e.pageX < ddiamx+ddiamw && e.pageY > ddiamy && e.pageY < ddiamy+ddiamh))
        && (!((stpge || stpga) && e.pageX > stpgssx && e.pageX < stpgssx+stpgssw && e.pageY > stpgssy && e.pageY < stpgssy+stpgssh))
        && (!(stpge && stpgn > 0 && e.pageX > stpgssx2 && e.pageX < stpgssx2+stpgssw2 && e.pageY > stpgssy2 && e.pageY < stpgssy2+stpgssh2))) {

      x = 0;
      while (x < fbutt.length && !(e.pageX > fbutt[x][0] + 2 && e.pageX < fbutt[x][0]+fbutt[x][2]+6 && e.pageY > fbutt[x][1] && e.pageY < fbutt[x][1]+fbutt[x][3]+6)) {
        x++;
      }
      if (x >= fbutt.length) {
        if (dwrld && cellsn > 0 && wrldw > wrldm && wrldh > wrldm && e.pageX >= wrldx && e.pageX < wrldx+wrldw && e.pageY > wrldy && e.pageY < wrldy+wrldh) {
          x = e.pageX;
          y = e.pageY;
          if (x < wrldx+wrldm/2-0.5) {
            x = wrldx+wrldm/2-0.5;
          }
          if (x >= wrldx+wrldw-wrldm/2+0.5) {
            x = wrldx+wrldw-wrldm/2-0.5;
          }
          if (y < wrldy+wrldm/2-0.5) {
            y = wrldy+wrldm/2-0.5;
          }
          if (y >= wrldy+wrldh-wrldm/2+0.5) {
            y = wrldy+wrldh-wrldm/2-0.5;
          }
          posx = (cellsl + (x - wrldx-wrldm/2 + 0.5) / ((wrldw-wrldm) / (cellsr-cellsl+1))) * (cellsz+(cellsz>grb?1:cellsz/grb));
          posy = (cellst - (y - wrldy-wrldm/2 + 0.5) / ((wrldh-wrldm) / (cellst-cellsb+1)) + 1) * (cellsz+(cellsz>grb?1:cellsz/grb));
        } else {
          toggleCell(e.pageX, e.pageY);
        }
        e.preventDefault();
      }
    }
  });
  canvas2.addEventListener("click", function(e) {
    e.preventDefault();
  });
  window.addEventListener("keydown", function(e) {
    var cc, f = false;
    keyesupp = false;
    if (patt) {
      return;
    }
    cc = e.keyCode;
    if (cc === 8 || cc === 27) {
      f = peKey(cc);
    }
    if (f) {
      keyesupp = true;
      e.preventDefault();
    }
  });
  window.addEventListener("keypress", function(e) {
    var cc;
    if (patt || keyesupp) {
      return;
    }
    cc = e.which || e.keyCode;
    if (peKey(cc)) {
      e.preventDefault();
    }
  });
  window.addEventListener("keyup", function(e) {
    keyesupp = false;
  });
  
  canvas2.style.opacity = "1";
  
  }, 3333);
  
}

function peMsMove(px, py) {
  var p, x, y, c, r;
  curx = px;
  cury = py;
  if (!(dwrld && cellsn > 0 && px > wrldx && px < wrldx+wrldw && py > wrldy && py < wrldy+wrldh)) {
    if (mdown && !ton) {
      toncd = 0;
      x = posx;
      y = posy;
      posx = posx2 - (px - diffx);
      posy = posy2 + (py - diffy);
      c = cellX(posx,true);
      r = cellY(posy,true);
      if (c < maxl || c > maxr || r < maxb || r > maxt) {
        posx = x;
        posy = y;
      }
    }
  }
  if (spd) {
    p = cury - spdd;
    if (p < spdby) {
      p = spdby;
    }
    if (p >= spdby + spdbh) {
      p = spdby + spdbh - 1;
    }
    speed = 100 - 100*(p-spdby)/spdbh;
  }
  if (scl) {
    p = cury - scld;
    if (p < sclby) {
      p = sclby;
    }
    if (p >= sclby + sclbh) {
      p = sclby + sclbh - 1;
    }
    scale = 100 - 100*(p-sclby)/sclbh;
    calcCellsz();
    posx = sclpx * (cellsz+(cellsz>grb?1:cellsz/grb));
    posy = sclpy * (cellsz+(cellsz>grb?1:cellsz/grb));
  }
  if (wrlda) {
    posx = posx2 - ((diffx - px) / ((wrldw-wrldm) / (cellsr-cellsl+1))) * (cellsz+(cellsz>grb?1:cellsz/grb));
    posy = posy2 + ((diffy - py) / ((wrldh-wrldm) / (cellst-cellsb+1))) * (cellsz+(cellsz>grb?1:cellsz/grb));
  }
}

function peKey(cc) {
  var s, p, i, q, f = false;
  if (dspgrd && cc === 35) {
    swdspgrd();
  } else if (dwrld && (cc === 27 || cc === 87 || cc === 119)) {
    swdwrld();
  } else if (stpge) {
    if (cc === 13) {
      f = true;
      if (stpgn > 0) {
        if (stpgnm !== 0) {
          stpgnc = gennum;
        }
        stpge = false;
        stpga = true;
        stpgax = true;
        i = performance.now();
        if (!stpgcd || (i - stpgcd) > stpgcdn) {
          stpgcd = i;
        } else {
          stpgcd = i - (stpgcdn - (i - stpgcd));
        }
        stpgcd2 = null;
        stpgsf = false;
        if (ffw !== 0 && ffwstp) {
          ffw = 0;
          genbbl = false;
        }
      }
    } else if (cc === 27) {
      f = true;
      if (ffw !== 0 && ffwstp) {
        ffw = 0;
        genbbl = false;
      }
      stpge = false;
      stpga = false;
      stpgax = false;
      stpgn2 = -1;
      i = performance.now();
      if (!stpgcd || (i - stpgcd) > stpgcdn) {
        stpgcd = i;
      } else {
        stpgcd = i - (stpgcdn - (i - stpgcd));
      }
      stpgcd2 = null;
      stpgsf = false;
    } else if (cc === 8) {
      f = true;
      stpgn = Math.floor(stpgn / 10);
    } else if (cc === 45) {
      f = true;
      if (stpgnm === 0) {
        stpgnm = -1;
      } else if (stpgnm === -1) {
        stpgnm = 1;
      } else {
        stpgnm = 0;
      }
    } else if (cc >= 48 && cc <= 57) {
      f = true;
      i = stpgn * 10 + (cc - 48);
      if (i <= 999999999999) {
        stpgn = i;
      }
    }
  } else if (!crulem && (cc === 80 || cc === 112)) {
    swpatt();
  } else if (!crulem && (cc === 87 || cc === 119)) {
    swdwrld();
  } else if (!crulem && cc === 63) {
    swdhlp();
  } else if (!crulem && cc === 35) {
    swdspgrd();
  } else if (!crulem && (cc === 43 || cc === 45 || cc >= 48 && cc <= 57)) {
    f = true;
    if (ffw !== 0 && ffwstp) {
      ffw = 0;
      genbbl = false;
    }
    stpgn2 = stpgn;
    stpgnm2 = stpgnm;
    stpgnc2 = stpgnc;
    if (cc === 43 || cc === 45) {
      stpgn = 0;
      if (cc === 43) {
        stpgnm = 1;
      } else {
        stpgnm = -1;
      }
    } else if (cc !== 48) {
      stpgn = cc - 48;
      stpgnm = 0
    }
    stpge = true;
    stpgax = stpga;
    stpga = false;
    i = performance.now();
    if (stpgcd) {
      stpgcd = i - (stpgcdn - (i - stpgcd));
    }
    stpgcd2 = null;
    stpgsf = false;
    if (dhlpn > 0) {
      dhlpn = 2;
    }
  } else if (crulem && cc === 13) {
    f = true;
    crulebut(1);
  } else if (crulem && cc === 27) {
    f = true;
    crulebut(2);
  } else if (cc === 98 || cc === 66 || cc === 115 || cc === 83 || cc >= 48 && cc <= 57) {
    f = true;
    if (cc === 98 || cc === 66) {
      if (crulem === 0) {
        crulebn = cruleb;
        crulesn = crules;
        document.getElementById("crule").style.display = "block";
      }
      crulem = 1;
      crulebn = ""
    } else if (cc === 115 || cc === 83) {
      if (crulem === 0) {
        crulebn = cruleb;
        crulesn = crules;
        document.getElementById("crule").style.display = "block";
      }
      crulem = 2;
      crulesn = "";
    } else if (cc !== 57 && crulem !== 0 && (cc !== 48 || crulem !== 1)) {
      if (crulem === 1) {
        s = crulebn;
      } else {
        s = crulesn;
      }
      p = -1;
      for (i = 0; i < s.length; i++) {
        if (s.charCodeAt(i) > cc) {
          break;
        } else {
          p = i;
        }
      }
      if (p === -1 || s.charCodeAt(p) !== cc) {
        s = s.substring(0,p+1) + String.fromCharCode(cc) + s.substring(p+1);
        if (crulem === 1) {
          crulebn = s;
        } else {
          crulesn = s;
        }
      }
    }
    if (crulem) {
      document.getElementById("crulet").innerHTML = 'Accept or Cancel New Rule<br><br>Click Button or Press Enter to Accept<br>Press "d" or "D" to Accept Default Rule<br><br><span style="font-size: 32px; color: rgba(100,220,100,0.6);">'+"B"+crulebn+' '+'S'+crulesn+'</span>';
    }
  } else if (crulem !== 0 && (cc === 100 || cc === 68)) {
    f = true;
    crulebn = "3";
    crulesn = "23";
    rulebut(1);
  }
  if (f) {
    q = updc();
    if (q[0] > 0 || q[1] > 0) {
      ddiama = q[0];
      ddiamb = q[1];
      ddiamcd = null;
    }
  }
  return f;
}

function swrun() {
  var x;
  run = !run;
  if (run) {
    ffw = 0;
    genbbl = true;
  } else {
    genbbl = false;
  }
  x = performance.now();
  if (runcd3) {
    runcd3 = x-runcd3>runcdn3?x:x-runcdn3*(1-(x-runcd3)/runcdn3);
  } else {
    runcd3 = x;
  }
  if (!run && !runcd2 && !runcd4 && !runcd5) {
    runcd2 = performance.now();
  }
}

function swffwp(f) {
  if (ffw === -1) {
    if (f) {
      if (ffwm <= 0) {
        ffwm = 2;
        ffwstp = false;
        pgenfcd = performance.now();
        pgenfcd2 = null;
        ngenfcd = null;
        ngenfcd2 = null;
      } else if (ffwm === 2) {
        ffwm = 1;
        ffwstp = false;
        pgenfcd2 = performance.now();
        pgenfcd = null;
        ngenfcd = null;
        ngenfcd2 = null;
      } else {
        ffw = 0;
        genbbl = false;
      }
    } else {
      if (ffwm > 0) {
        ffwm = 0;
        ffwstp = false;
        pgenfcd = performance.now();
        pgenfcd2 = null;
        ngenfcd = null;
        ngenfcd2 = null;
      } else if (ffwm === 0) {
        ffwm = -1;
        ffwstp = false;
        pgenfcd2 = performance.now();
        pgenfcd = null;
        ngenfcd = null;
        ngenfcd2 = null;
      } else {
        ffw = 0;
        genbbl = false;
      }
    }
  } else {
    if (run) {
      swrun();
    }
    ffw = -1;
    ffwm = f ? 2 : 0;
    ffwstp = false;
    genbbl = true;
    pgenfcd = performance.now();
    pgenfcd2 = null;
    ngenfcd = null;
    ngenfcd2 = null;
  }
}

function swffwn(f) {
  if (ffw === 1) {
    if (f) {
      if (ffwm <= 0) {
        ffwm = 2;
        ffwstp = false;
        ngenfcd = performance.now();
        ngenfcd2 = null;
        pgenfcd = null;
        pgenfcd2 = null;
      } else if (ffwm === 2) {
        ffwm = 1;
        ffwstp = false;
        ngenfcd2 = performance.now();
        ngenfcd = null;
        pgenfcd = null;
        pgenfcd2 = null;
      } else {
        ffw = 0;
        genbbl = false;
      }
    } else {
      if (ffwm > 0) {
        ffwm = 0;
        ffwstp = false;
        ngenfcd = performance.now();
        ngenfcd2 = null;
        pgenfcd = null;
        pgenfcd2 = null;
      } else if (ffwm === 0) {
        ffwm = -1;
        ffwstp = false;
        ngenfcd2 = performance.now();
        ngenfcd = null;
        pgenfcd = null;
        pgenfcd2 = null;
      } else {
        ffw = 0;
        genbbl = false;
      }
    }
  } else {
    if (run) {
      swrun();
    }
    ffw = 1;
    ffwm = f ? 2 : 0;
    ffwstp = false;
    genbbl = true;
    ngenfcd = performance.now();
    ngenfcd2 = null;
    pgenfcd = null;
    pgenfcd2 = null;
  }
}

function swpatt() {
  patt = !patt;
  if (patt) {
    document.getElementById("pattern").style.animation = "showdiv 0.5s ease-in forwards";
    if (document.getElementById("patternt").value === "") {
      document.getElementById("patternt").value = patttxt;
    }
  } else {
    document.getElementById("pattern").style.animation = "hidediv 0.5s ease-in forwards";
  }
}

function swdwrld() {
  dwrld = !dwrld;
  if (!dwrld) {
    wrlda = false;
    wrldcd = null;
  }
}

function swdspgrd() {
  dspgrd = !dspgrd;
  drawbackg = true;
}

function swstpge() {
  var i;
  if (stpge) {
    if (ffw !== 0 && ffwstp) {
      ffw = 0;
      genbbl = false;
    }
    stpge = false;
    stpga = false;
    stpgax = false;
    stpgn2 = -1;
    i = performance.now();
    if (!stpgcd || (i - stpgcd) > stpgcdn) {
      stpgcd = i;
    } else {
      stpgcd = i - (stpgcdn - (i - stpgcd));
    }
    stpgcd2 = null;
    stpgsf = false;
  } else {
    if (ffw !== 0 && ffwstp) {
      ffw = 0;
      genbbl = false;
    }
    stpgn2 = stpgn;
    stpgnm2 = stpgnm;
    stpgnc2 = stpgnc;
    stpge = true;
    stpgax = stpga;
    stpga = false;
    i = performance.now();
    if (stpgcd) {
      stpgcd = i - (stpgcdn - (i - stpgcd));
    }
    stpgcd2 = null;
    stpgsf = false;
    if (dhlpn > 0) {
      dhlpn = 2;
    }
  }
}

function swdhlp() {
  if (dhlpn > 0) {
    dhlpn = 0;
  } else if (stpge) {
    dhlpn = 2;
  } else {
    dhlpn = 1;
  }
}

function swdmsgs() {
  dmsgs = !dmsgs;
}

function swclru() {
  clrvars();
}

function tick() {
  var x = performance.now(), r, i, n, tp, ff;
  
  gtsd = gts ? x - gts : 0;
  gts = x;
  
  if (!tickct) {
    tickct = gts;
  }
  tickclp++;
  r = tickc / (x = gts - tickct);
  if (tickcr > 0 && r > 0) {
    if (r > tickcr * (1 + tickcm1)) {
      if (r / tickcr < 5) {
        tickclp -= 1 + r / tickcr;
        tickcmf1 += 1 + r / tickcr;
      }
    } else if (r < tickcr * (1 - tickcm2)) {
      if (tickcr / r < 5) {
        tickclp += 1 + tickcr / r;
        tickcmf2 += 1 + tickcr / r;
      }
    } else {
      tickcmf3++;
    }
  }
  if (x > 400) {
    if (tickcm1 === 0) {
      tickcm1 = 0.02;
    }
    if (tickcm2 === 0) {
      tickcm2 = 0.02;
    }
    if (tickcmf1 + tickcmf2 > tickcmf3 * 0.4) {
      if (tickcmf1 > tickcmf2 * 0.8) {
        if (tickcm1 < 0.6) {
          tickcm1 *= 2;
        }
      } else {
        tickcm1 = 0.02;
      }
      if (tickcmf2 > tickcmf1 * 0.8) {
        if (tickcm2 < 0.6) {
          tickcm2 *= 2;
        }
      } else {
        tickcm2 = 0.02;
      }
    } else {
      tickcm1 = 0.02;
      tickcm2 = 0.02;
    }
    if (tickc > 0) {
      x = Math.abs(tickc - tickc2);
      if (tickc > tickc2) {
        mstabu = (mstabu * 2 + (x / tickc) * 3) / 5;
      } else if (tickc < tickc2) {
        mstabd = (mstabd * 2 + (x / tickc) * 3) / 5;
      }
    }
    tickcr = r;
    tickct = gts;
    tickc2 = tickc;
    tickc = 0;
    tickcmf1 = 0;
    tickcmf2 = 0;
    tickcmf3 = 0;
  }
  
  ff = 0;

  tp = tickclp;
  
  while (tickclp > 0) {
  
  tickclp--;
  tickc++;
  
  //--
  
  if (fpattf !== 0) {
    if (fpattf === 1) {
      pattf1();
    } else if (fpattf === 2) {
      pattf2();
    }
  }

  if (!wts1) {
    wts1 = gts;
  }  
  
  runcdn = 3000 * ((Math.pow(2,6+4*((100-speed)/100))-1)/1024);
  if (ffw !== 0 && (ffwm === -1 || ffwm === 1)) {
    n = 0;
    if (ffwstp && stpga) {
      if (ffwstpc0 !== 0) {
        n = ff / (performance.now() - gts) * 0.9;
        if (n > 0) {
          n = ffwstpc0 / ff;
          if ((ff > ffwstpc0) && n < 0.3) {
            n = 0.3;
          } else if (ff < ffwstpc0 && n > 3) {
            n = 3;
          }
        } else {
          n = ffwstpc0;
        }
      }
    } else {
      ffwstpc0 = 0;
      ffwstpc1 = 0;
      ffwstpc2 = 0;
    }
    if (n <= 0) {
      n = 1;
    }
    ff += n;
    ffwstpc1 += n;
    ffwstpc2 += n;
    while (ffwstpc2 >= 1) {
      ffwstpc2--;
      doffw();
    }
  } else if ((run || ffw !== 0) && gts-wts1>3000*((Math.pow(2,10*((100-speed)/100))-1)/1024)) {
    wts1 = gts;
    if (run) {
      calcGen();
    } else {
      doffw();
    }
  }
  
  i = 0;
  while (cellsn < cellslen/2.3) {
    while (i < cellslen && cells[i][3] === 1) {
      i++;
    }
    while (i < cellslen && cellslen > 0 && cells[cellslen-1][3] !== 1) {
      cellslen--;
      cellsfs[0-cells[cellslen][3]] = -1;
    }
    if (i < cellslen) {
      cellslen--;
      cellsfs[0-cells[i][3]] = -1;
      cells[i][0] = cells[cellslen][0];
      cells[i][1] = cells[cellslen][1];
      cells[i][2] = cells[cellslen][2];
      cells[i][3] = 1;
      cells[i][4] = cells[cellslen][4];
      cells[i][4][2] = i + 1;
      cells[cellslen][4] = null;
    }
  }
  
  i = 0;
  while (i < frll) {
    if (frl[i]) {
      if (frl[i][1] === 2 && frl[i][4]) {
        if (gts - frl[i][2] > frl[i][0].length * 1.3 * 1000) {
          frl[i][1] = 3;
          frl[i][4][1][0][frl[i][4][0]] = null;
          frl[i][4][1][1]--;
          frl[i] = null;
        }
      } else {
        frl[i] = null;
      }
      if (!frl[i]) {
       frlfs[frlfsl++] = i;
      }
    }
    i++;
  }
  
  //--
  
  }
  
  YagolsSetZeroTimeoutFunc(tick);
};

function doffw() {
  var p0, q;
  if (ffw > 0) {
    if (histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1]) {
      if (nextGen() && stpga) {
        ffw = 0;
        stpgcd2 = performance.now();
        stpgsf = false;
        if (stpgnm !== 0) {
          stpgnc = gennum;
        }
      }
      if (histgn === 0) {
        ffw = 0;
      } else if (ffw !== 0) {
        p0 = 0;
        if (histp > 0) {
          q = prevHist(histh, histi);
          if (hist[q[0]][0][q[1]][11][0] > 0) {
            p0 = hist[q[0]][0][q[1]][11][1];
          }
        }
        if (ffwm > 0 && (histp === 0 || histp === p0) || (!ffwstp || !stpga) && (histp === 0 || histp === p0) && (hist[histh][0][histi][3][0] > 0 || hist[histh][0][histi][3][1] > 0)) {
          ffw = 0;
        }
      }
    } else {
      ffw = 0;
    }
  } else if (histgp > 0 && (histgn === 0 || hupdc === 0)) {
    if (prevGen() && stpga) {
      ffw = 0;
      stpgcd2 = performance.now();
      stpgsf = false;
      if (stpgnm !== 0) {
        stpgnc = gennum;
      }
    }
    if (histgp === 0) {
      ffw = 0;
    } else if (ffw !== 0) {
      p0 = 0;
      if (histp > 0) {
        q = prevHist(histh, histi);
        if (hist[q[0]][0][q[1]][11][0] > 0) {
          p0 = hist[q[0]][0][q[1]][11][1];
        }
      }
      if (ffwm > 0 && histp === 0 || (!ffwstp || !stpga) && (histp === 0 || histp === p0) && (hist[histh][0][histi][3][0] > 0 || hist[histh][0][histi][3][1] > 0)) {
        ffw = 0;
      }
    }
  } else {
    ffw = 0;
  }
  if (ffw === 0) {
    genbbl = false;
  }
}

function dspview(ts) {
  var t, f;
  gtsd = gts ? ts - gts : 0;
  gts = ts;
  if (!rsct) {
    rsct = gts;
  }
  t = gts;
  if ((t - rsct) > 800) {
    frpsn = Math.floor(dspvc / (t - rsct + 1) * 1000);
    gnpsn = Math.floor(Math.abs(gennum - gnpsg) / (t - rsct + 1) * 1000);
    rsct = t;
    dspvc = 0;
    f = gnpsd;
    gnpsd = gennum !== gnpsg;
    gnpsg = gennum;
    if (f && !gnpsd || !f && gnpsd) {
      if (gnpscd) {
        if (gts - gnpscd > gnpscdn) {
          gnpscd = gts;
        } else {
          gnpscd = gts - (gnpscdn - (gts - gnpscd));
        }
      } else {
        gnpscd = gts;
      }
    }
  }
  if (dspvc / (t - rsct + 1) * 1000 < 25) {
    dspvc++;
    dspview0();
  }
  requestAnimationFrame(dspview);
}

function dspview0() {
  var x, y, q;
  chgcsz = chggsz = chgpos = false;
  if (!cwidth || canvas0.offsetWidth !== cwidth || !cheight || canvas0.offsetHeight !== cheight) {
    chgcsz = true;
    cwidth = canvas0.offsetWidth;
    cheight = canvas0.offsetHeight;
    canvas2.width = cwidth;
    canvas2.height = cheight;
    canvas1.width = cwidth;
    canvas1.height = cheight;
    canvas0.width = cwidth;
    canvas0.height = cheight;
    tmet = null;
  }
  if (mdown) {
    if (toncd > 0) {
      toncd--;
      if (toncd < 1) {
        ton = true;
        tonx = cellX(posx+curx,true);
        tony = cellY(posy+cury,true);
        toggleCell(curx, cury);
      }
    }
    if (ton) {
      x = cellX(posx+curx,true);
      y = cellY(posy+cury,true);
      if (tonw <= 0 && (x !== tonx || y !== tony)) {
        toggleCell(curx, cury);
        tonw = 5;
      }
      if (tonw > 0) {
        tonw--
      }
      tonx = x;
      tony = y;
    }
  }
  if (capcd && gts - capcd > capcdn) {
    capcd = null;
  }
  if (capcd2 && gts - capcd2 > capcdn2) {
    capcd2 = null;
  }
  if (hlcrcd && (gts - hlcrcd > hlcrcdn)) {
    hlcrcd = null;
  }
  if (hlcrcd2 && gts - hlcrcd2 > hlcrcdn2) {
    hlcrcd2 = null;
  }
  if (hlcrcd3 && gts - hlcrcd3 > hlcrcdn3) {
    hlcrcd3 = null;
  }
  if (ngencd && gts - ngencd > ngencdn) {
    ngencd = null;
  }
  if (ngencd2 && gts - ngencd2 > ngencd3) {
    ngencd2 = null;
  }
  if (ngencd4 && gts - ngencd4 > ngencdn4) {
    ngencd4 = null;
  }
  if (ngencd5 && gts - ngencd5 > ngencdn5) {
    ngencd5 = null;
  }
  if (ngenfcd && gts - ngenfcd > ngenfcdn) {
    ngenfcd = null;
  }
  if (ngenfcd2 && gts - ngenfcd2 > ngenfcdn2) {
    ngenfcd2 = null;
  }
  if (pgencd && gts - pgencd > pgencdn) {
    pgencd = null;
  }
  if (pgencd2 && gts - pgencd2 > pgencd3) {
    pgencd2 = null;
  }
  if (pgencd4 && gts - pgencd4 > pgencdn4) {
    pgencd4 = null;
  }
  if (pgencd5 && gts - pgencd5 > pgencdn5) {
    pgencd5 = null;
  }
  if (pgenfcd && gts - pgenfcd > pgenfcdn) {
    pgenfcd = null;
  }
  if (pgenfcd2 && gts - pgenfcd2 > pgenfcdn2) {
    pgenfcd2 = null;
  }
  if (ddiamcd && gts - ddiamcd > ddiamcdn) {
    ddiamcd = null;
    ddiama = 0;
    ddiamb = 0;
  }
  if (ddiamcd2 && gts - ddiamcd2 > ddiamcdn2) {
    ddiamcd2 = null;
  }
  if (runcd && gts - runcd > runcdn) {
    runcd = null;
  }
  if (runcd2 && gts - runcd2 > runcdn2) {
    runcd2 = null;
    runcd5 = gts;
  }
  if (runcd3 && gts - runcd3 > runcdn3) {
    runcd3 = null;
  }
  if (runcd4 && gts - runcd4 > runcdn4) {
    runcd4 = null;
  }
  if (runcd5 && gts - runcd5 > runcdn5) {
    runcd5 = null;
    runcd4 = gts;
  }
  if (wrldcd && gts - wrldcd > wrldcdn) {
    wrldcd = null;
    wrlda = true;
  }
  if (ffwsbcd && gts - ffwsbcd > ffwsbcdn) {
    ffwsbcd = null;
  }
  if (gnpscd && gts - gnpscd > gnpscdn) {
    gnpscd = null;
  }
  if (stpgcd && gts - stpgcd > stpgcdn) {
    stpgcd = null;
  }
  if (stpgcd2 && gts - stpgcd2 > stpgcdn2) {
    if (stpgsf) {
      stpgsf = false;
      stpgcd2 = null;
    } else {
      stpgsf = true;
      stpgcd2 = gts;
    }
  }
  if (stpgcd3 && gts - stpgcd3 > stpgcdn3) {
    ffwstpc0 = 0;
    if (ffw !== 0 && ffwstp) {
      if (stpga) {
        ffwstpc0 = ffwstpc1 / stpgcdn3;
      }
      stpgcd3 = gts;
    } else {
      stpgcd3 = null;
    }
    ffwstpc1 = 0;
  }
  if (genbtcd && gts - genbtcd > genbtcdn) {
    if (genbtl) {
      genbtl = false;
      genbtcd = null;
    } else {
      genbtl = true;
      genbtcd = gts;
    }
  }
  for (x = 0; x < dhlpql; x++) {
    if (dhlpq[x][5] && gts - dhlpq[x][5] > dhlpcdn) {
      dhlpq[x][5] = null;
      if (dhlpn > 0 && x === dhlpql - 1) {
        dhlpq[x][6] = 1;
      }
    }
  }
  if (dhlpcd2 && gts - dhlpcd2 > dhlpcdn2) {
    dhlpcd2 = null;
    dhlpn = 0;
  }
  if (dhlpcd3 && gts - dhlpcd3 > dhlpcdn3) {
    dhlpcd3 = gts;
    if (dhlplf < 2) {
      dhlplf = 2;
    } else {
      dhlplf = 1;
    }
  }
  if (clrucd && gts - clrucd > clrucdn) {
    clrucd = null;
  }
  if (msgcd1 && gts - msgcd1 > msgcdn1) {
    msgcd1 = gts;
    genbtcd = null;
    genbtl = false;
    if (msgf1 === 0 || msgf1 > 900) {
      swstmsg();
    }
    msgf1 = 0;
  }
  if (msgcd2 && gts - msgcd2 > msgcdn2) {
    msgcd2 = gts;
    if (!genbtcd && !genbtl) {
      genbtcd = gts;
    }
    x = msgf1;
    if ((msgf1 === 1 || msgf1 === 2) && (cellsn > 0 || histp > 0)
        || msgf1 === 3 && (cellsxl > 0 || histgn > 0 || histp > 0)
        || msgf1 === 11 && (gennum > 0 || histp > 0)
        || (msgf1 === 21 || msgf1 === 22) && histp === 0) {
      msgf1 = 0;
    }
    if (msgf1 === 0 && histp > 0) {
      q = prevHist(histh, histi);
      if (hist[q[0]][0][q[1]][11][0] > 0 && (histgn === 0 || hist[q[0]][0][q[1]][11][1] - histp >= hist[q[0]][0][q[1]][11][0])) {
        if (hist[q[0]][0][q[1]][11][2] === 0 && hist[q[0]][0][q[1]][11][3] === 0) {
          drawMsgsStm("Oscillator!", "p"+hist[q[0]][0][q[1]][11][0]);
          msgf1 = 21;
        } else {
          drawMsgsStm("Spaceship!", spcshtxt(hist[q[0]][0][q[1]][11][0],hist[q[0]][0][q[1]][11][2],hist[q[0]][0][q[1]][11][3]));
          msgf1 = 22;
        }
      }
    }
    if (msgf1 === 0 && x > 0) {
      swstmsg();
    }
  }
  for (x = 0; x < fbutt.length; x++) {
    if (fbutt[x][6] && gts - fbutt[x][6] > fbuttcdn) {
      fbutt[x][6] = null;
    }
  }
  if (dspposcd && gts - dspposcd > dspposcdn) {
    dspposcd = null;
  }
  if (dsppxccd && gts - dsppxccd > dsppxccdn) {
    dsppxccd = null;
  }
  if (swzmcd && gts - swzmcd > swzmcdn) {
    swzmcd = null;
  }
  if (swzmcd2 && gts - swzmcd2 > swzmcdn2) {
    swzmcd2 = null;
  }
  if (stmsgcd && gts - stmsgcd > stmsgcdn) {
    stmsgcd = null;
    stmsgo1 = stmsgn1;
    stmsgo2 = stmsgn2;
    stmsgotm1 = stmsgntm1;
    stmsgotm2 = stmsgntm2;
    stmsgn1 = "";
    stmsgn2 = "";
    stmsgcd2 = gts;
  }
  if (stmsgcd2 && gts - stmsgcd2 > stmsgcdn2) {
    stmsgcd2 = null;
  }
  if (titlecd && gts - titlecd > titlecdn) {
    titlecd = null;
    titlecd2 = gts;
  }
  if (titlecd2 && gts - titlecd2 > titlecdn2) {
    titlecd2 = null;
    titleh = false;
  }
  if (titlecd3 && gts - titlecd3 > titlecdn3) {
    titlecd3 = null;
  }
  if (ngenb && !ngencd && !ngen) {
    ngen = true;
    ngencd2 = null;
    ngencd3 = 500;
    ngencd4 = null;
  }
  if (ngen) {
    if (!ngencd2) {
      if (nextGen() && stpga) {
        stpgcd2 = gts;
        stpgsf = false;
      }
      ngencd2 = gts;
      if (!ngencd4) {
        ngencd3 -= ngencd3 > 0 ? 50 : 0;
        ngencd4 = gts;
      }
    }
  }
  if (pgenb && !pgencd && !pgen && histgp > 0) {
    pgen = true;
    pgencd2 = null;
    pgencd3 = 500;
    pgencd4 = null;
  }
  if (pgen) {
    if (!pgencd2) {
      if (prevGen() && stpga) {
        stpgcd2 = gts;
        stpgsf = false;
      }
      pgencd2 = gts;
      if (!pgencd4) {
        pgencd3 -= pgencd3 > 0 ? 50 : 0;
        pgencd4 = gts;
      }
    }
  }
  if (histgp < 1) {
    pgen = false;
  }
  if (cellsz !== prvgsz) {
    prvgsz = cellsz;
    chggsz = true;
  }
  if (posx !== prvposx || posy !== prvposy) {
    prvposx = posx;
    prvposy = posy;
    chgpos = true;
  }
  if (drawbackg || chgcsz || chggsz || chgpos) {
    drawbackg = false;
    ctx0.fillStyle = "rgba(0,0,0,1)";
    ctx0.fillRect(0, 0, cwidth, cheight);
    if (dspgrd && cellsz > grb) {
      drawGrid();
    }
  }
  drawCells();
  ctx2.clearRect(0, 0, cwidth, cheight);
  if (titlemode >= 2 && cellsn === 0 && msgll === 0 && titlefd <= titlex) {
    titlefd += (gts-titlefdt)/1000*60;
  }
  if (titlefd > 0) {
    drawTitle();
    if (titlemode < 2 || cellsn > 0 || msgll > 0 || titlefd > titlex) {
      titlefd -= (gts-titlefdt)/1000*(msgll>0?120:60);
      if (titlemode === 2 && titlefd <= 0) {
        titleh = false;
      }
    }
  }
  titlefdt = gts;
  if (titlemode === 0 && (cellsn > 0 || msgll > 0)) {
    titlefd = 0;
  }
  if (titlemode < 2) {
    if (titlefd <= 0) {
      titlefd = titlefds;
      titlemode++;
    }
  }
  
  drawInfo();
  if (dwrld && cellsn > 0) {
    drawWrld();
  }
  
  drawFButt();
  drawScale();
  drawSpeed();
  drawRunToggle();
  drawNGenButton();
  drawPGenButton();
  drawCapButton();
  drawFramesSec();
  drawDiamond();
  drawPos();
  drawCRule();
  drawStmsg();
  drawMsgs();
  drawStpg();
  drawHelp();
  
  if (clrucd) {
    ctx2.fillStyle = "rgba(255, 255, 255, " + (0.7 * (gts - clrucd > clrucdn ? 0 : 1 - (gts - clrucd) / clrucdn)) + ")";
    ctx2.fillRect(0, 0, cwidth, cheight);
  }
}

function calcICellsz() {
  cellisz = Math.floor(cwidth > cheight ? cwidth / (2*Math.sqrt(cwidth)) : cheight / (2*Math.sqrt(cheight)));
  if (cellisz < 1) {
    cellisz = 1;
  }
}

function calcCellsz() {
  cellsz = cellisz*celliszm * Math.pow(2, 10*scale/100) / 1024;
}

function toggleCell(x, y) {
  var c = cellX(posx + (x - cwidth / 2), true), r =  cellY(posy + (cheight / 2 - y), true);
  if (c >= maxl && c <= maxr && r >= maxb && r <= maxt) {
    toggleCellCR(c, r);
  }
}

function toggleCellCR(c, r, x) {
  var i, n, g, n2, a, c0 = c, r0 = r, z, q;
  clrcellsx();
  if (c0 < maxl) {
    c0 = maxr - maxl + c0 + 1;
  }
  if (c0 > maxr) {
    c0 = maxl + c0 - maxr - 1;
  }
  if (r0 < maxb) {
    r0 = maxt - maxb + r0 + 1;
  }
  if (r0 > maxt) {
    r0 = maxb + r0 - maxt - 1;
  }
  if (x) {
    i = x - 1;
  } else {
    i = ((a = fcidx(c,r)) ? a[0] === 1 ? a[2]-1 : cellslen : cellslen);
  }
  n = tidx[crkey(c0,r0)];
  n2 = n?n<0?n-1:n+1:1;
  if (i < cellslen) {
    g = cells[i][2];
    if (g === 0) {
      if (Math.abs(n2%2) === 1) {
        hupdc++;
      } else {
        hupdc--;
      }
    } else {
      hupdc++;
      n2 = -2;
    }
    if (!n) {
      tarr.push([c0,r0,g]);
    }
    rmvCell(i);
    fcidx(c,r,1);
    cellsn--;
  } else {
    if (Math.abs(n2%2) === 1) {
      hupdc++;
    } else {
      hupdc--;
    }
    if (!n || n === -2) {
      tarr.push([c0,r0,-1]);
    }
    z = addCell(c0,r0);
    cells[z][4] = fcidx(c,r,[1,0,z+1,0]);
    cellsn++;
  }
  tidx[crkey(c0,r0)] = n2;
  calcWrld();
  q = updc();
  if (q[0] > 0 || q[1] > 0) {
    ddiama = q[0];
    ddiamb = q[1];
    ddiamcd = null;
  }
}

function cellX(x,r) {
  var z = x / (cellsz+(cellsz>grb?1:cellsz/grb));
  if (r) {
    return Math.floor(z);
  }
  return z;
}

function cellY(y,r) {
  var z = y / (cellsz+(cellsz>grb?1:cellsz/grb));
  if (r) {
    return Math.floor(z);
  }
  return z;
}

function drawCells() {
  var ci;
  ctx1.clearRect(0, 0, cwidth, cheight);
  ctx1.setLineDash([]);
  for (var i = 0; i < cellslen; i++) {
    if ((ci = cells[i])[3] === 1) {
      drawCell(ci[0], ci[1], ci[2]);
    }
  }
}

function drawCell(x, y, g) {
  var px, py, n, f;
  px = cwidth / 2 + (x * (cellsz+(cellsz>grb?1:cellsz/grb)) + (cellsz>grb?1:cellsz/grb)) - posx;
  py = cheight / 2 - (y * (cellsz+(cellsz>grb?1:cellsz/grb)) + (cellsz>grb?1:cellsz/grb)) + posy - cellsz + 1;
  if (px >= 0 - cellsz && px < cwidth + cellsz && py >= 0 - cellsz && py < cheight + cellsz) {
    n = ((g>0?g:gennum)-mingen+1) / (gennum-mingen+1);
    ctx1.strokeStyle = "rgba(120, 200, "+Math.floor(155*n)+", 0.7)";
    ctx1.lineWidth = cellsz/7;
    f = cellsz/8;
    ctx1.strokeRect((px+f)+0.5|0, (py+f)+0.5|0, (cellsz-2*f)+0.5|0, (cellsz-2*f)+0.5|0);
    f = cellsz/7;
    ctx1.fillStyle = "rgba(230, 160, "+(100+Math.floor(155*n))+", 0.7)";
    ctx1.fillRect((px+f)+0.5|0, (py+f)+0.5|0, (cellsz-2*f)+0.5|0, (cellsz-2*f)+0.5|0);
  }
}

function calcWrld() {
  var i, ci;
  mingen = gennum;
  cellsl = maxr + 1;
  cellsr = maxl - 1;
  cellst = maxb - 1;
  cellsb = maxt + 1;
  for (i = 0; i < cellslen; i++) {
    if ((ci = cells[i])[3] === 1) {
      mingen = ci[2] > 0 ? mingen === 0 ? ci[2] : mingen > ci[2] ? ci[2] : mingen : mingen === 0 ? gennum : mingen;
      if (ci[0] < cellsl) {
        cellsl = ci[0];
      }
      if (ci[0] > cellsr) {
        cellsr = ci[0];
      }
      if (ci[1] > cellst) {
        cellst = ci[1];
      }
      if (ci[1] < cellsb) {
        cellsb = ci[1];
      }
    }
  }
  calcWrld2();
}

function calcWrld2() {
  if (cellsn > 0) {
    if (cheight/cwidth > (cellst-cellsb+1)/(cellsr-cellsl+1)) {
      wrldw = cwidth * 0.7;
      wrldh = wrldw * (cellst-cellsb+1)/(cellsr-cellsl+1);
    } else {
      wrldh = cheight * 0.7;
      wrldw = wrldh * (cellsr-cellsl+1)/(cellst-cellsb+1);
    }
    if (wrldw <= wrldm) {
      wrldw = wrldm + 1;
    }
    if (wrldh <= wrldm) {
      wrldh = wrldm + 1;
    }
  } else {
    wrldw = 0;
    wrldh = 0;
  }
}

function calcWrld3() {
  var i, ci;
  mingen = gennum;
  for (i = 0; i < cellslen; i++) {
    if ((ci = cells[i])[3] === 1) {
      mingen = ci[2] > 0 ? mingen === 0 ? ci[2] : mingen > ci[2] ? ci[2] : mingen : mingen === 0 ? gennum : mingen;
    }
  }
}

function drawWrld() {
  var i, ulw, w, h, x, y, x2, y2, ci, wlw;
  if (cellsn === 0) {
    return;
  }
  calcWrld2();
  wrldx = (cwidth-wrldw) / 2;
  wrldy = (cheight-wrldh) / 2;
  wlw = 1 + (wrldw*wrldh/800000)*3;
  ctx2.lineWidth = wlw;
  ctx2.setLineDash([2,2]);
  ctx2.strokeStyle = "rgba(240, 240, 240, 1)";
  ctx2.strokeRect(wrldx+wrldm/2-3|0, wrldy+wrldm/2-3|0, wrldw-wrldm+8|0, wrldh-wrldm+8|0);
  ctx2.setLineDash([]);
  ctx2.strokeStyle = "rgba(130, 160, 0, 0.8)";
  ctx2.strokeRect(wrldx+0.5|0, wrldy+0.5|0, wrldw+0.5|0, wrldh+0.5|0);
  ctx2.fillStyle = "rgba(0, 0, 0, 0.7)";
  ctx2.fillRect((wrldx+wlw)+0.5|0, (wrldy+wlw)+0.5|0, (wrldw-wlw*2)+0.5|0, (wrldh-wlw*2)+0.5|0);
  w = (wrldw-wrldm) / (cellsr-cellsl+1);
  h = (wrldh-wrldm) / (cellst-cellsb+1);
  d = (wrldw*wrldh)/(500*300)*0.4;
  for (i = 0; i < cellslen; i++) {
    if ((ci = cells[i])[3] === 1) {
      if (ci[2] > 0) {
        ctx2.fillStyle = "rgba(60, 170, 60, 0.7";
      } else {
        ctx2.fillStyle = "rgba(220, 30, 30, 0.7";
      }
      ctx2.fillRect((wrldx - d * 2 + (wrldm/2+0.5) + w * (ci[0] - cellsl))+0.5|0, (wrldy - d * 2 + (wrldm/2+0.5) + h * (cellst - ci[1]))+0.5|0, ((w<1?1:w)+d*4)+0.5|0, ((h<1?1:h)+d*4)+0.5|0);
    }
  }
  ctx2.lineWidth = 1+d*2;
  ctx2.setLineDash([]);
  vw = cwidth/(cellsz+(cellsz>grb?1:cellsz/grb));
  vh = cheight/(cellsz+(cellsz>grb?1:cellsz/grb));
  x = wrldx - d * 2 + (wrldm/2+0.5) + w * (cellX(posx) - vw / 2 - cellsl);
  x2 = x + vw * w + d * 4;
  y = wrldy - d * 2 + (wrldm/2+0.5) + h * (cellst - cellY(posy) - vh / 2 + 1);
  y2 = y + vh * h + d * 4;
  wrldax = x;
  wrlday = y;
  wrldaw = x2 - x;
  wrldah = y2 - y;
  if (wrlda) {
    ctx2.strokeStyle = "rgba(200, 200, 200, 1)";
  } else {
    ctx2.strokeStyle = "rgba(140, 140, 140, 1)";
  }
  if (x < wrldx+wrldw-wrldm/2+0.5 && x2 > wrldx+wrldm/2-0.5 && y >= wrldy + wrldm/2 - 1.5 && y < wrldy + wrldh - wrldm/2 + 0.5) {
    ctx2.beginPath();
    ctx2.moveTo((x<wrldx+wrldm/2-0.5?wrldx+wrldm/2-0.5:x)+0.5|0, y+0.5|0);
    ctx2.lineTo((x2>=wrldx+wrldw-wrldm/2+0.5?wrldx+wrldw-wrldm/2-0.5:x2)+0.5|0, y+0.5|0);
    ctx2.stroke();
  }
  if (x < wrldx+wrldw-wrldm/2+0.5 && x2 > wrldx+wrldm/2-0.5 && y2 >= wrldy + wrldm/2 - 0.5 && y2 < wrldy + wrldh - wrldm/2 + 0.5) {
    ctx2.beginPath();
    ctx2.moveTo((x<wrldx+wrldm/2-0.5?wrldx+wrldm/2-0.5:x)+0.5|0, y2+0.5|0);
    ctx2.lineTo((x2>=wrldx+wrldw-wrldm/2+0.5?wrldx+wrldw-wrldm/2-0.5:x2)+0.5|0, y2+0.5|0);
    ctx2.stroke();
  }
  if (y < wrldy+wrldh-wrldm/2+0.5 && y2 > wrldy+wrldm/2-0.5 && x >= wrldx + wrldm/2 - 1.5 && x < wrldx + wrldw - wrldm/2 + 0.5) {
    ctx2.beginPath();
    ctx2.moveTo(x+0.5|0, (y<wrldy+wrldm/2-0.5?wrldy+wrldm/2-0.5:y)+0.5|0);
    ctx2.lineTo(x+0.5|0, (y2>=wrldy+wrldh-wrldm/2+0.5?wrldy+wrldh-wrldm/2-0.5:y2)+0.5|0);
    ctx2.stroke();
  }
  if (y < wrldy+wrldh-wrldm/2+0.5 && y2 > wrldy+wrldm/2-0.5 && x2 >= wrldx + wrldm/2 - 0.5 && x2 < wrldx + wrldw - wrldm/2 + 0.5) {
    ctx2.beginPath();
    ctx2.moveTo(x2+0.5|0, (y<wrldy+wrldm/2-0.5?wrldy+wrldm/2-0.5:y)+0.5|0);
    ctx2.lineTo(x2+0.5|0, (y2>=wrldy+wrldh-wrldm/2+0.5?wrldy+wrldh-wrldm/2-0.5:y2)+0.5|0);
    ctx2.stroke();
  }
  if (wrlda) {
    ctx2.strokeStyle = "rgba(200, 200, 200, 0.5)";
  } else {
    ctx2.strokeStyle = "rgba(140, 140, 140, 0.5)";
  }
  if (x < wrldx+wrldw-wrldm/2+0.5 && x2 > wrldx+wrldm/2-0.5 && y >= wrldy + wrldm/2 - 1.5 && y < wrldy + wrldh - wrldm/2 + 0.5) {
    if (x<wrldx+wrldm/2-0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x+0.5|0, y+0.5|0);
      ctx2.lineTo((wrldx+wrldm/2-0.5)+0.5|0, y+0.5|0);
      ctx2.stroke();
    }
    if (x2>=wrldx+wrldw-wrldm/2+0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x2+0.5|0, y+0.5|0);
      ctx2.lineTo((wrldx+wrldw-wrldm/2+0.5)+0.5|0, y+0.5|0);
      ctx2.stroke();
    }
  } else {
    ctx2.beginPath();
    ctx2.moveTo(x+0.5|0, y+0.5|0);
    ctx2.lineTo(x2+0.5|0, y+0.5|0);
    ctx2.stroke();
  }
  if (x < wrldx+wrldw-wrldm/2+0.5 && x2 > wrldx+wrldm/2-0.5 && y2 >= wrldy + wrldm/2 - 0.5 && y2 < wrldy + wrldh - wrldm/2 + 0.5) {
    if (x<wrldx+wrldm/2-0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x+0.5|0, y2+0.5|0);
      ctx2.lineTo((wrldx+wrldm/2-0.5)+0.5|0, y2+0.5|0);
      ctx2.stroke();
    }
    if (x2>=wrldx+wrldw-wrldm/2+0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x2+0.5|0, y2+0.5|0);
      ctx2.lineTo((wrldx+wrldw-wrldm/2+0.5)+0.5|0, y2+0.5|0);
      ctx2.stroke();
    }
  } else {
    ctx2.beginPath();
    ctx2.moveTo(x+0.5|0, y2+0.5|0);
    ctx2.lineTo(x2+0.5|0, y2+0.5|0);
    ctx2.stroke();
  }
  if (y < wrldy+wrldh-wrldm/2+0.5 && y2 > wrldy+wrldm/2-0.5 && x >= wrldx + wrldm/2 - 1.5 && x < wrldx + wrldw - wrldm/2 + 0.5) {
    if (y<wrldy+wrldm/2-0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x+0.5|0, y+0.5|0);
      ctx2.lineTo(x+0.5|0, (wrldy+wrldm/2-0.5)+0.5|0);
      ctx2.stroke();
    }
    if (y2>=wrldy+wrldh-wrldm/2+0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x+0.5|0, y2+0.5|0);
      ctx2.lineTo(x+0.5|0, (wrldy+wrldh-wrldm/2+0.5)+0.5|0);
      ctx2.stroke();
    }
  } else {
    ctx2.beginPath();
    ctx2.moveTo(x+0.5|0, y+0.5|0);
    ctx2.lineTo(x+0.5|0, y2+0.5|0);
    ctx2.stroke();
  }
  if (y < wrldy+wrldh-wrldm/2+0.5 && y2 > wrldy+wrldm/2-0.5 && x2 >= wrldx + wrldm/2 - 0.5 && x2 < wrldx + wrldw - wrldm/2 + 0.5) {
    if (y<wrldy+wrldm/2-0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x2+0.5|0, y+0.5|0);
      ctx2.lineTo(x2+0.5|0, (wrldy+wrldm/2-0.5)+0.5|0);
      ctx2.stroke();
    }
    if (y2>=wrldy+wrldh-wrldm/2+0.5) {
      ctx2.beginPath();
      ctx2.moveTo(x2+0.5|0, y2+0.5|0);
      ctx2.lineTo(x2+0.5|0, (wrldy+wrldh-wrldm/2+0.5)+0.5|0);
      ctx2.stroke();
    }
  } else {
    ctx2.beginPath();
    ctx2.moveTo(x2+0.5|0, y+0.5|0);
    ctx2.lineTo(x2+0.5|0, y2+0.5|0);
    ctx2.stroke();
  }
}

function drawScale() {
  var w = Math.floor(1 + 5 * cwidth / 600), p, sc;
  if (w > 60) {
    w = 60;
  }
  var h = Math.floor(cheight * slidh);
  if (h > cheight) {
    h = cheight;
  }
  if (h < 1) {
    h = 1;
  }
  var x = cwidth - w * 6.7, y = 130 + Math.floor((cheight - h - 170) / 2), fs, t;
  if (swzmcd2) {
    t = gts - swzmcd2 > swzmcdn2 ? 1 : (gts - swzmcd2) / swzmcdn2;
    if (!swzmf) {
      t = 1 - t;
    }
  } else {
    t = 1;
  }
  sclbx = x;
  sclby = y;
  sclbw = w;
  sclbh = h;
  ctx2.textBaseline = "bottom";
  if (swzmf || swzmcd2) {
    ctx2.strokeStyle = "rgba(120, 120, 120, " + (t*0.9) + ")";
    ctx2.setLineDash([]);
    ctx2.lineWidth = w/4;
    strokerr(ctx2, x+0.5|0, y+0.5|0, w+0.5|0, h+0.5|0, w/2);
  }
  swzmtx = sclbx - w - 9;
  swzmty = y + 13;
  swzmtw = 25;
  swzmth = 29;
  if (swzmf || swzmcd2) {
    if (swzmt || swzmcd) {
      drawStrImg(ctx2, "\u2A02", swzmtx - 3, swzmty + 23, 30, 0, 170, 255, 0.5 * (swzmcd2 ? t : 1), 3);
    } else {
      drawStrImg(ctx2, "\u2A02", swzmtx - 3, swzmty + 23, 30, 0, 70, 200, 0.5 * (swzmcd2 ? t : 1), 3);
    }
  }
  if (!swzmf || swzmcd2) {
    if (swzmt || swzmcd) {
      drawStrImg(ctx2, "\u2A01", swzmtx - 3, swzmty + 23, 30, 0, 170, 255, 0.5 * (swzmcd2 ? (1 - t) : 1), 3);
    } else {
      drawStrImg(ctx2, "\u2A01", swzmtx - 3, swzmty + 23, 30, 0, 70, 200, 0.5 * (swzmcd2 ? (1 - t) : 1), 3);
    }
  }
  if (swzmf || swzmcd2) {
    sc = scale;
    if (scl) {
      fs = "rgba(50, 70, 90, " + (t*0.4) + ")";
      p = cury - scld;
      if (p < y) {
        p = y;
      }
      if (p >= y + h) {
        p = y + h - 1;
      }
      sc = 100 - 100*(p-y)/h;
    } else {
      fs = "rgba(0, 0, 0, " + (t*0.6) + ")";
    }
    sclx = x+w/2;
    scly = y+h-h*sc/100;
    sclr = w*1.5;
    drawStrImg(ctx2, "zm", (x-4)+0.5|0, (scly-3+w/2+1)+1+0.5|0, 14, 200, 200, 200, t * 0.8);
    ctx2.fillStyle = fs;
    ctx2.beginPath();
    ctx2.arc(sclx+0.5|0, scly+0.5|0, sclr+0.5|0, 0, 2 * Math.PI);
    ctx2.fill();
    if (scl) {
      ctx2.strokeStyle = "rgba(0, 140, 180, " + (t*0.7) + ")";
    } else {
      ctx2.strokeStyle = "rgba(0, 100, 150, " + (t*0.7) + ")";
    }
    ctx2.arc(sclx+0.5|0, scly+0.5|0, sclr+0.5|0, 0, 2 * Math.PI);
    ctx2.stroke();
  }
}

function drawSpeed() {
  var w = Math.floor(1 + 5 * cwidth / 600), p, sp;
  if (w > 60) {
    w = 60;
  }
  var h = Math.floor(cheight * slidh);
  if (h > cheight) {
    h = cheight;
  }
  var x = cwidth - w * 10.8, y = 130 + Math.floor((cheight - h - 170) / 2), fs, t;
  if (swzmcd2) {
    x = ((cwidth - w * 6.7) - (cwidth - w * 10.8)) * Math.sqrt((gts - swzmcd2 > swzmcdn2 ? 1 : (gts - swzmcd2) / swzmcdn2)+0.5);
    if (swzmf) {
      x = (cwidth - w * 6.7) - x;
    } else {
      x = (cwidth - w * 10.8) + x;
    }
  } else if (!swzmf) {
    x = cwidth - w * 6.7;
  }
  t = 1;
  spdbx = x;
  spdby = y;
  spdbw = w;
  spdbh = h;
  ctx2.strokeStyle = "rgba(120, 120, 120, " + (t*0.9) + ")";
  ctx2.setLineDash([]);
  ctx2.lineWidth = w/4;
  strokerr(ctx2, x+0.5|0, y+0.5|0, w+0.5|0, h+0.5|0, w/2);
  sp = speed;
  if (spd) {
    fs = "rgba(50, 70, 90, " + (t*0.4) + ")";
    p = cury - spdd;
    if (p < y) {
      p = y;
    }
    if (p >= y + h) {
      p = y + h - 1;
    }
    sp = 100 - 100*(p-y)/h;
  } else {
    fs = "rgba(0, 0, 0, " + (t*0.6) + ")";
  }
  spdx = x+w/2;
  spdy = y+h-h*sp/100;
  spdr = w*1.5;
  ctx2.textBaseline = "bottom";
  drawStrImg(ctx2, "spd", (x-7)+0.5|0, (spdy+1+w/2)+0.5|0, 14, 200, 200, 200, t * 0.8, 2);
  ctx2.fillStyle = fs;
  ctx2.beginPath();
  ctx2.arc(spdx+0.5|0, spdy+0.5|0, spdr+0.5|0, 0, 2 * Math.PI);
  ctx2.fill();
  if (spd) {
    ctx2.strokeStyle = "rgba(0, 140, 180, " + (t*0.7) + ")";
  } else {
    ctx2.strokeStyle = "rgba(0, 100, 150, " + (t*0.7) + ")";
  }
  ctx2.arc(spdx+0.5|0, spdy+0.5|0, spdr+0.5|0, 0, 2 * Math.PI);
  ctx2.stroke();
}

function drawTitle() {
  var x, s, h, fs2, fs = Math.floor(cwidth/500*30), z;
  fs2 = fs;
  ctx2.textBaseline = "bottom";
  ctx2.font = fs + "px " + font;
  x = titlemode === 0 ? 0 : Math.log(titlefds-(titlemode===2&&titlefd>titlex?titlex:titlefd)+1)/Math.log(titlefds+1);
  fs = fs2*(1-x);
  s = ""+(70-Math.floor(70*x));
  ctx2.fillStyle = "rgba("+s+","+s+","+s+","+(1-1*x)+")";
  ctx2.shadowBlur = 5;
  ctx2.shadowColor = "#EEEEEE";
  if (!tmet) {
    tmet = [];
  }
  if (!tmet[1]) {
    tmet[1] = ctx2.measureText(title[1]);
  }
  if (titlemode < 2) {
    if (!tmet[0]) {
      tmet[0] = ctx2.measureText(title[0]);
    }
    if (!tmet[2]) {
      tmet[2] = ctx2.measureText(title[2]);
    }
    h = fs*4;
    if (cheight < h) {
      ctx2.fillText(title[1], (cwidth-tmet[1].width)/2+0.5|0, ((cheight-fs)/2+fs)+0.5|0);
    } else {
      ctx2.fillText(title[0], (cwidth-tmet[0].width)/2+0.5|0, ((cheight-h)/2+fs)+0.5|0);
      ctx2.fillText(title[1], (cwidth-tmet[1].width)/2+0.5|0, ((cheight-h)/2+fs*2.5)+0.5|0);
      ctx2.fillText(title[2], (cwidth-tmet[2].width)/2+0.5|0, ((cheight-h)/2+fs*4)+0.5|0);
    }
  }
  if (titlemode >= 2 || titlemode === 1 && titlefd < titlex) {
    if (titlemode === 1) {
      tfs3 = 0;
      x = (titlex-titlefd)/titlex;
      s = ""+(Math.floor(70*x/5.5));
      ctx2.fillStyle = "rgba("+s+","+s+","+s+","+(1*x/7)+")";
    }
    fs = fs2*(x+1.1)*0.34;
    if (fs < tfs3) {
      fs = tfs3;
    }
    tfs3 = fs;
    h = fs*2.5;
    if (cheight < h) {
      ctx2.fillText(title[1], (cwidth-tmet[1].width)/2+0.5|0, ((cheight-fs)/2+fs)+0.5|0);
    } else {
      if (!tmet[3]) {
        tmet[3] = ctx2.measureText(title[3]);
      }
      ctx2.fillText(title[3], (cwidth-tmet[3].width)/2+0.5|0, ((cheight-h)/2+fs)+0.5|0);
      ctx2.fillText(title[1], (cwidth-tmet[1].width)/2+0.5|0, ((cheight-h)/2+fs*2.5)+0.5|0);
    }
    if (titleh) {
      if (!tmet[4]) {
        tmet[4] = ctx2.measureText(title[4]);
      }
      if (!tmet[5]) {
        tmet[5] = ctx2.measureText(title[5]);
      }
      if (!titlemf && msgll > 0) {
        titlemf = true;
        titlecd3 = gts;
      } else if (titlemf && msgll === 0) {
        titlemf = false;
        titlecd3 = gts;
      }
      if (titlecd3) {
        z = gts-titlecd3>titlecdn3?0.7:((gts-titlecd3)/titlecdn3)*0.7;
        if (titlemf) {
          z = 1 - z;
        } else {
          z = 0.3 + z;
        }
      } else {
        if (titlemf) {
          z = 0.3;
        } else {
          z = 1;
        }
      }
      if (titlemode === 1) {
        x = (titlex-titlefd)/titlex;
        x = 1*x/7;
      } else {
        x = 1-1*x;
      }
      x = x * z;
      x *= titlecd2 ? gts - titlecd2 > titlecdn2 ? 0 : 1 - (gts - titlecd2) / titlecdn2 : 1;
      ctx2.fillStyle = "rgba(170,0,0,"+(x*1.4)+")";
      ctx2.fillText(title[4], (cwidth-tmet[4].width)/2+0.5|0, ((cheight-h)/2-fs/2)+0.5|0);
      ctx2.fillText(title[5], (cwidth-tmet[5].width)/2+0.5|0, ((cheight-h)/2+fs*4)+0.5|0);
      ctx2.font = Math.floor(fs2/2) + "px " + font;
      if (!tmet[6]) {
        tmet[6] = ctx2.measureText(title[6]);
      }
      ctx2.fillText(title[6], (cwidth-tmet[6].width)/2+0.5|0, ((cheight-h)/2+fs*5)+0.5|0);
    }
  }
  ctx2.shadowBlur = 0;
}

function drawMsgs() {
  var i, x, s, h, fs2, fs = Math.floor(cwidth/500*22), y1, y2, y3;
  ctx2.textBaseline = "bottom";
  ctx2.shadowBlur = 5;
  ctx2.shadowColor = "#EEEEEE";
  ctx2.font = fs + "px " + font;
  for (i = 0; i < msgll; i++) {
    if (msgl[i][0]) {
      if (msgl[i][3] === 0 && gts - msgl[i][2] > 1200) {
        msgl[i][3] = 1;
        msgl[i][2] = gts;
      } else if (msgl[i][3] === 1 && gts - msgl[i][2] > msgl[i][1]) {
        msgl[i][3] = 2;
        msgl[i][2] = gts;
        drawMsgsStm(msgl[i][0][0], msgl[i][0][2]);
      } else if (msgl[i][3] === 2 && gts - msgl[i][2] > 1200) {
        msgl[i][0] = null;
        msgl[i][4] = null;
      } else {
        x = msgl[i][3] !== 1 ? (gts-msgl[i][2]) / 1200 : 1;
        x = 0.85-Math.log(x*0.5)/Math.sqrt(x*0.4)*0.1;
        if (msgl[i][3] === 2) {
          x = 1-Math.sqrt(0.8/x);
        }
        fs2 = fs*x;
        s = ""+Math.floor(70*x);
        ctx2.fillStyle = "rgba("+Math.floor(255*x)+","+s+","+s+","+(i<msgll-1?0.18+x*0.4*(i/(msgll-1)):x*1)+")";
        h = fs2*4;
        y1 = (cheight-h)/2+fs2;
        y2 = (cheight-h)/2+fs2*2.5;
        y3 = (cheight-h)/2+fs2*4;
        if (msgl[i][0].length > 0) {
          ctx2.fillText(msgl[i][0][0], (cwidth-msgl[i][4][0].width)/2*(1/x)+i*18-50+0.5|0, y1-(msgll-1)*15+i*30+0.5|0);
        }
        if (msgl[i][0].length > 1) {
          ctx2.fillText(msgl[i][0][1], (cwidth-msgl[i][4][1].width)/2*(1/x)+i*18-50+0.5|0, y2-(msgll-1)*15+i*30+0.5|0);
        }
        if (msgl[i][0].length > 2) {
          ctx2.fillText(msgl[i][0][2], (cwidth-msgl[i][4][2].width)/2*(1/x)+i*18-50+0.5|0, y3-(msgll-1)*15+i*30+0.5|0);
        }
      }
    }
  }
  ctx2.shadowBlur = 0;
  while (msgll > 0 && !msgl[msgll-1][0]) {
    msgll--;
  }
}

function drawMsgsStm(s1, s2) {
  s1 = s1.trim().replace(/ /g," \u22C5 ");
  s2 = s2.trim().replace(/ /g," \u22C5 ");
  swstmsg(s1 + "   \u22C5", s2 + (s2.length === 0 ? "   \u22C5" : "   \u22C5     \u22C5"));
}

function drawStmsg() {
  var x;
  ctx2.textBaseline = "bottom";
  ctx2.font = "25px " + font;
  if (!stmsgntm1) {
    stmsgntm1 = ctx2.measureText(stmsgn1);
  }
  if (!stmsgntm2) {
    stmsgntm2 = ctx2.measureText(stmsgn2);
  }
  if (!stmsgotm1) {
    stmsgotm1 = ctx2.measureText(stmsgo1);
  }
  if (!stmsgotm2) {
    stmsgotm2 = ctx2.measureText(stmsgo2);
  }
  if (stmsgcd) {
    x = (gts-stmsgcd)>stmsgcdn?1:(gts-stmsgcd)/stmsgcdn;
    if (stmsgn1.length > 0 || stmsgn2.length > 0) {
      ctx2.fillStyle = "rgba("+Math.floor(170+30*x)+", "+Math.floor(200*x)+", "+Math.floor(200*x)+", "+(x*0.85)+")";
      ctx2.fillText(stmsgn1, cwidth - 590 - stmsgntm1.width, 43);
      ctx2.fillText(stmsgn2, cwidth - 563 - stmsgntm2.width, 75);
    }
    if (stmsgo1.length > 0 || stmsgo2.length > 0) {
      ctx2.fillStyle = "rgba("+Math.floor(150+30*x)+", "+Math.floor(50+130*x)+", "+Math.floor(50+130*x)+", "+((1-x)*0.7)+")";
      ctx2.fillText(stmsgo1, cwidth - 590 - stmsgotm1.width, 43);
      ctx2.fillText(stmsgo2, cwidth - 563 - stmsgotm2.width, 75);
    }
  } else if (stmsgcd2) {
    if (stmsgo1.length > 0 || stmsgo2.length > 0) {
      x = (gts-stmsgcd2)>stmsgcdn2?1:(gts-stmsgcd2)/stmsgcdn2;
      ctx2.fillStyle = "rgba("+Math.floor(200-30*x)+", "+Math.floor(200-130*x)+", "+Math.floor(200-130*x)+", "+(0.85-0.15*x)+")";
      ctx2.fillText(stmsgo1, cwidth - 590 - stmsgotm1.width, 43);
      ctx2.fillText(stmsgo2, cwidth - 563 - stmsgotm2.width, 75);
    }
  } else if (stmsgo1.length > 0 || stmsgo2.length > 0) {
    ctx2.fillStyle = "rgba(170, 70, 70, 0.7)";
    ctx2.fillText(stmsgo1, cwidth - 590 - stmsgotm1.width, 43);
    ctx2.fillText(stmsgo2, cwidth - 563 - stmsgotm2.width, 75);
  }
}

function drawRunToggle() {
  var a, b;
  a = 1;
  b = 1;
  if (runcd3) {
    if (run) {
      a = 1 - (gts-runcd3>runcdn3?1:(gts-runcd3)/runcdn3);
      b = 1 - a;
    } else {
      a = gts-runcd3>runcdn3?1:(gts-runcd3)/runcdn3;
      b = 1 - a;
    }
  }
  ctx2.textBaseline = "bottom";
  runtx = cwidth - 373;
  ctx2.setLineDash([]);
  ctx2.lineWidth = 1;
  if (run || runcd3) {
    if (!runcd) {
      runcd = gts;
      runcdc++;
      if (runcdc > 3) {
        runcdc = 1;
      }
    }
    ctx2.font = "41px " + font;
    ctx2.strokeStyle = "rgba(100,120,170,"+(1*b)+")";
    ctx2.strokeText("\u25B7", runtx-10, 147);
    ctx2.strokeText("\u25B7", runtx+18, 147);
    ctx2.strokeText("\u25B7", runtx+46, 147);
    ctx2.font = "30px " + font;
    ctx2.fillStyle = "rgba(0,50,150,"+(0.7*b)+")";
    ctx2.fillText("\u25B7", runtx-5, 141);
    ctx2.fillText("\u25B7", runtx+23, 141);
    ctx2.fillText("\u25B7", runtx+51, 141);
    ctx2.fillStyle = "rgba(170,250,250,"+(0.7*b)+")";
    if (runcdc === 1) {
      ctx2.fillText("\u25B7", runtx-5, 140);
    } else if (runcdc === 2) {
      ctx2.fillText("\u25B7", runtx+23, 140);
    } else if (runcdc === 3) {
      ctx2.fillText("\u25B7", runtx+51, 140);
    }
  }
  if (!run || runcd3) {
    if (histgn > 0 && !runcd3 || runcd3 && runbc === 1 && run) {
      ctx2.fillStyle = "rgba(170, 0, 0,"+a+")";
      runbc = 1;
    } else {
      ctx2.fillStyle = "rgba(0, 70, 200,"+a+")";
      runbc = 0;
    }
    ctx2.font = "34px " + font;
    ctx2.fillText("\u25B7", runtx-7, 142);
    ctx2.fillText("\u25B7", runtx+21, 142);
    ctx2.fillText("\u25B7", runtx+49, 142);
  }
  runty = 105;
  runtw = 85;
  runth = 41;
  if (runcd2 || runcd4 || runcd5) {
    ctx2.font = "34px " + font;
    ctx2.strokeStyle = "rgba(200,200,200,"+(0.5*(runcd2?(gts-runcd2)>runcdn2?1:(gts-runcd2)/runcdn2:runcd4?(gts-runcd4)>runcdn4?0:(1-(gts-runcd4)/runcdn4):1))+")";
    ctx2.strokeText("\u25B7", runtx-7, 142);
    ctx2.strokeText("\u25B7", runtx+21, 142);
    ctx2.strokeText("\u25B7", runtx+49, 142);
  }
}

function drawNGenButton() {
  var s;
  ctx2.textBaseline = "bottom";
  ngenbx = cwidth - 440;
  if (ngen) {
    drawStrImg(ctx2, "\u2AA2", ngenbx - 3, 138, 60, 170, 170, 255, 1);
  } else if (ngenb || ngencd5) {
    drawStrImg(ctx2, "\u2AA2", ngenbx - 3, 138, 60, 0, 170, 255, 1);
  } else if (genbbl) {
    drawStrImg(ctx2, "\u2AA2", ngenbx - 3, 138, 60, 120, 120, 120, 0.5);
  } else if (histgn > 0 && (hupdc > 0 || cruleb !== histcr[0] || crules !== histcr[1])) {
    drawStrImg(ctx2, "\u2AA2", ngenbx - 3, 138, 60, 170, 0, 0, 1);
  } else {
    drawStrImg(ctx2, "\u2AA2", ngenbx - 3, 138, 60, 0, 70, 200, 1);
  }
  ngenby = 101;
  ngenbw = 42;
  ngenbh = 42;
  if (histgn === 0) {
    ngenfx = 0;
  } else {
    ctx2.font = "17px " + font;
    s = "" + histgn;
    if (!(histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1])) {
      ctx2.fillStyle = "rgba(120, 120, 120, 0.5)";
    } else if ((ffw === 1 || ngenfcd) && ffwm === 0) {
      ctx2.fillStyle = "rgba(0, 170, 255, 1)";
      s = s + "\u21FE";
    } else if ((ffw === 1 || ngenfcd2) && ffwm === -1) {
      ctx2.fillStyle = "rgba(170, 170, 255, 1)";
      s = s + "\u21FE";
    } else {
      ctx2.fillStyle = "rgba(0, 70, 200, 1)";
      s = s + "\u22C5";
    }
    ngenfx = ngenbx + ngenbw - (s.length>3?3:s.length) * 10 - 8;
    ctx2.fillText(s, ngenfx - 1, 101);
    ngenfx += 1;
    ngenfy = 83;
    ngenfw = s.length * 9 + 8;
    ngenfh = 27;
  }
}

function drawPGenButton() {
  var s;
  ctx2.textBaseline = "bottom";
  pgenbx = cwidth - 532;
  if (pgen) {
    drawStrImg(ctx2, "\u2AA1", pgenbx - 4, 138, 60, 170, 170, 255, 1);
  } else if (pgenb || pgencd5) {
    drawStrImg(ctx2, "\u2AA1", pgenbx - 4, 138, 60, 0, 170, 255, 1);
  } else if (histgp < 1 || genbbl) {
    drawStrImg(ctx2, "\u2AA1", pgenbx - 4, 138, 60, 120, 120, 120, 0.5);
  } else if (histgn > 0 && hupdc > 0) {
    drawStrImg(ctx2, "\u2AA1", pgenbx - 4, 138, 60, 170, 0, 0, 1);
  } else {
    drawStrImg(ctx2, "\u2AA1", pgenbx - 4, 138, 60, 0, 70, 200, 1);
  }
  pgenby = 104;
  pgenbw = 36;
  pgenbh = 39;
  if (histgp > 0) {
    ctx2.font = "17px " + font;
    s = "" + histgp;
    if (!(histgp > 0 && (histgn === 0 || hupdc === 0))) {
      ctx2.fillStyle = "rgba(120, 120, 120, 0.5)";
    } else if ((ffw === -1 || pgenfcd) && ffwm === 0) {
      ctx2.fillStyle = "rgba(0, 170, 255, 1)";
      s = "\u21FD" + s;
    } else if ((ffw === -1 || pgenfcd2) && ffwm === -1) {
      ctx2.fillStyle = "rgba(170, 170, 255, 1)";
      s = "\u21FD" + s;
    } else {
      ctx2.fillStyle = "rgba(0, 70, 200, 1)";
      s = "\u22C5" + s;
    }
    pgenfx = pgenbx + 3;
    if (s.length > 3) {
      pgenfx -= (s.length-3)*10;
    }
    ctx2.fillText(s, pgenfx - 3, 101);
    pgenfx -= 1;
    pgenfy = 83;
    pgenfw = s.length * 9 + 9;
    pgenfh = 27;
  }
}

function drawCapButton() {
  var x, y, sl, sr, q, p0, pp, ss;
  ctx2.textBaseline = "bottom";
  pp = 0;
  p0 = 0;
  if (histp > 0) {
    q = prevHist(histh,histi);
    pp = hist[q[0]][0][q[1]][11][0];
    p0 = pp > 0 ? hist[q[0]][0][q[1]][11][1] : 0;
    ss = hist[q[0]][0][q[1]][11][2] > 0 || hist[q[0]][0][q[1]][11][3] > 0;
  }
  sl = "";
  sr = "";
  if (p0 > 0 && histp > 0) {
    x = Math.floor(histp/pp);
    if (x > 0) {
      sl += x + "\u00D7" + pp;
      if (x * pp < histp) {
        sl += "\u002B";
      }
    }
    x = histp - x * pp;
    if (x > 0) {
      sl += x;
    }
  }
  if (histp < p0 || hist[histh][0][histi][11][0] > 0) {
    if (histp < p0) {
      y = p0 - histp;
    } else {
      pp = hist[histh][0][histi][11][0];
      y = hist[histh][0][histi][11][1];
    }
    ss = hist[histh][0][histi][11][2] > 0 || hist[histh][0][histi][11][3] > 0;
    x = Math.floor(y/pp);
    if (x > 0) {
      sr += x + "\u00D7" + pp;
      if (x * pp < y) {
        sr += "\u002B";
      }
    }
    x = y - x * pp;
    if (x > 0) {
      sr += x;
    }
  }
  sr += "";
  osctlw = 0;
  osctrw = 0;
  if (sl.length > 0 || sr.length > 0) {
    if (ss) {
      drawStrImg(ctx2, "S", cwidth - 475, 167, 20, 170, 200, 170, 0.7);
      x = 468;
      y = 466;
    } else {
      drawStrImg(ctx2, "O", cwidth - 477, 166, 21, 170, 200, 170, 0.7);
      x = 469;
      y = 466;
    }
    ctx2.font = "17px " + font;
    if (sl.length > 0) {
      if (!(histgp > 0 && (histgn === 0 || hupdc === 0))) {
        ctx2.fillStyle = "rgba(120, 120, 120, 0.5)";
      } else if ((ffw === -1 || pgenfcd) && ffwm === 2) {
        ctx2.fillStyle = "rgba(170, 170, 255, 1)";
        sl = "\u21FD" + sl;
      } else if ((ffw === -1 || pgenfcd2) && ffwm === 1) {
        ctx2.fillStyle = "rgba(0, 170, 255, 1)";
        sl = "\u21FD" + sl;
      } else {
        ctx2.fillStyle = "rgba(0, 70, 200, 0.9)";
        sl = "\u22C5" + sl;
      }
      osctlx = cwidth - x - (sl.length+2) * 11;
      ctx2.fillText(sl, osctlx - 2, 169);
      osctlw = sl.length * 11 + 4;
    }
    if (sr.length > 0) {
      if (!(histgn > 0 && hupdc === 0 && cruleb === histcr[0] && crules === histcr[1])) {
        ctx2.fillStyle = "rgba(120, 120, 120, 0.5)";
      } else if ((ffw === 1 || ngenfcd) && ffwm === 2) {
        ctx2.fillStyle = "rgba(170, 170, 255, 1)";
        sr = sr + "\u21FE";
      } else if ((ffw === 1 || ngenfcd2) && ffwm === 1) {
        ctx2.fillStyle = "rgba(0, 170, 255, 1)";
        sr = sr + "\u21FE";
      } else {
        ctx2.fillStyle = "rgba(0, 70, 200, 0.9)";
        sr = sr + "\u22C5";
      }
      osctrx = cwidth - y + 2 * 11;
      ctx2.fillText(sr, osctrx - 3, 169);
      osctrw = sr.length * 11 + 3;
    }
    osctly = 154;
    osctlh = 16;
    osctry = osctly;
    osctrh = osctlh;
  }
  x = 0;
  y = 0;
  if (hist[histh][0][histi][2] > 0) {
    y = hist[histh][0][histi][2] + 1;
  } else {
    if (histgp > 1) {
      q = prevHist(histh,histi);
      x = hist[q[0]][0][q[1]][2] + 1;
    }
  }
  sl = "";
  sr = "";
  if (x > 1) {
    sl = "\u21FD" + x;
  }
  if (y > 1) {
    sr = "" + y + "\u21FE";
  }
  if (sl.length > 0 || sr.length > 0) {
    ctx2.fillStyle = "rgba(200, 200, 200, 0.5)";
    ctx2.font = "12px " + font;
    ctx2.fillText(sl.length > 0 ? sl : sr, cwidth - 468 - ((sl.length > 0 ? sl : sr).length*8/2), 99);
  }
  if (ffw === 0 && ffwsbf || ffw !== 0 && !ffwsbf) {
    ffwsbf = ffw !== 0;
    if (!ffwsbcd || gts - ffwsbcd > ffwsbcdn) {
      ffwsbcd = gts;
    } else {
      ffwsbcd = gts - (ffwsbcdn - (gts - ffwsbcd));
    }
    if (ffw === 0) {
      ffwsbm = ffwsbm === -1 ? 1 : 2;
    } else {
      ffwsbm = ffwsbm === -1 ? 3 : 4;
    }
  }
  if (!ffwsbcd) {
    ffwsbm = 0;
  }
  if (capcd || histgn > 0 || ffwsbcd || ffw !== 0) {
    x = !ffwsbcd && ffw === 0 ? 0 : ffwsbcd ? gts - ffwsbcd > ffwsbcdn ? 1 : (gts - ffwsbcd) / ffwsbcdn : 1;
    if (ffwsbcd && (ffwsbm === 1 || ffwsbm === 2)) {
      x = 1 - x;
    }
    captx = cwidth - 485;
    capty = 107;
    captw = 35;
    capth = 35;
    if (x < 1 && (capcd || histgn > 0 && ffw === 0 || ffwsbcd && (ffwsbm === 1 || ffwsbm === 3))) {
      if (!ffwsbcd) {
        ffwsbm = -1;
      }
      if (capcd && (gts - capcd)%300>=150) {
        drawStrImg(ctx2, "\u29BB", captx, 137, 49, 240, 0, 0, 0.7 * (1 - x));
      } else {
        drawStrImg(ctx2, "\u29BB", captx, 137, 49, 170, 0, 0, 0.7 * (1 - x));
      }
    }
    if (x > 0 && (ffw !== 0 || ffwsbcd)) {
      drawStrImg(ctx2, "\u29B5", captx - 5, 137, 49, 170, 0, 0, 0.8 * x);
    }
  }
  if (capcd2) {
    ctx2.font = "17px " + font;
    ctx2.fillStyle = "rgba(200, 200, 200, " + (0.7*((gts-capcd2)>capcdn2?0:1-(gts-capcd2)/capcdn2)) + ")";
    ctx2.fillText(capcds2, cwidth - 468 - (capcds2.length/2)*11, 133);
  }
}

function drawInfo() {
  var s, x, z, n, n1, n2, q;
  ctx2.textBaseline = "bottom";
  if (genbtcd) {
    z = gts - genbtcd > genbtcdn ? 1 : (gts - genbtcd) / genbtcdn;
    if (genbtl) {
      z = 1 - z;
    }
  } else {
    z = 0;
  }
  x = 80 * z;
  ctx2.font = "13px " + font;
  ctx2.fillStyle = "rgba(" + (170+x) + ", 170, 170, 0.7)";
  x = 30;
  ctx2.fillText("g", x - 9, 60);
  if (z > 0) {
    ctx2.font = "30px " + font;
    ctx2.fillStyle = "rgba(170, 0, 0, " + z + ")";
    ctx2.fillText("\u22C5", x - 7, 68);
  }
  ctx2.font = "43px " + font;
  n = Math.round(30 * (mstabu - mstabd));
  if (n > 100) {
    n = 100;
  } else if (n < -100) {
    n = -100;
  }
  ctx2.fillStyle = "rgba(" + (150 - n) + ", " + (150 + n) + ", 0, 1)";
  s = "" + gennum;
  ctx2.fillText(s, x, 67);
  x += 32 * s.length + 15;
  ctx2.font = "13px " + font;
  ctx2.fillStyle = "rgba(170, 170, 170, 0.7)";
  ctx2.fillText("pop", x - 2, 46);
  x += 28;
  s = "" + cellsn;
  ctx2.font = "30px " + font;
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  ctx2.fillText(s, x, 52);
  if (histp > 0) {
    q = rlHist(histh, histi, histp);
    n1 = hist[q[2][0]][0][q[2][1]][12];
    n2 = hist[q[2][0]][0][q[2][1]][13];
  } else {
    n1 = hist[histh][0][histi][12];
    n2 = hist[histh][0][histi][13];
  }
  q = updc();
  n = 72;
  if (n1 === n2) {
    if (q[1] > 0) {
      drawStrImg(ctx2, "\uFF0B", x - 14, n - 4, 16, 170, 170, 170, 0.5);
      drawStrImg(ctx2, "\uFF0D", x - 14, n + 5, 16, 170, 170, 170, 0.5);
    } else {
      drawStrImg(ctx2, "\uFF0B", x - 14, n - 4, 16, 170, 170, 170, 0.9);
      drawStrImg(ctx2, "\uFF0D", x - 14, n + 5, 16, 170, 170, 170, 0.9);
    }
    ctx2.font = "19px " + font;
    if (q[1] > 0) {
      ctx2.fillStyle = "rgba(140, 140, 140, 0.7)";
    } else {
      ctx2.fillStyle = "rgba(160, 160, 160, 1)";
    }
    ctx2.fillText(""+n1, x + 8, n + 4);
  } else {
    if (n1 > 0) {
      if (n2 === 0) {
        if (q[1] > 0) {
          drawStrImg(ctx2, "\uFF0B", x - 14, n - 1, 16, 170, 170, 170, 0.5);
        } else {
          drawStrImg(ctx2, "\uFF0B", x - 14, n - 1, 16, 170, 170, 170, 0.9);
        }
        ctx2.font = "19px " + font;
        n += 4;
      } else { 
        ctx2.font = "16px " + font;
        if (q[1] > 0) {
          drawStrImg(ctx2, "\uFF0B", x - 14, n - 3, 16, 170, 170, 170, 0.5);
        } else {
          drawStrImg(ctx2, "\uFF0B", x - 14, n - 3, 16, 170, 170, 170, 0.9);
        }
      }
      if (q[1] > 0) {
        ctx2.fillStyle = "rgba(140, 140, 140, 0.7)";
      } else {
        ctx2.fillStyle = "rgba(160, 160, 160, 1)";
      }
      ctx2.fillText(""+n1, x + 8, n);
      n = 93;
    }
    if (n2 > 0) {
      if (n1 === 0) {
        if (q[1] > 0) {
          drawStrImg(ctx2, "\uFF0D", x - 14, n - 1, 16, 170, 170, 170, 0.5);
        } else {
          drawStrImg(ctx2, "\uFF0D", x - 14, n - 1, 16, 170, 170, 170, 0.9);
        }
        ctx2.font = "19px " + font;
        n += 4;
      } else {
        ctx2.font = "16px " + font;
        if (q[1] > 0) {
          drawStrImg(ctx2, "\uFF0D", x - 14, n - 3, 16, 170, 170, 170, 0.5);
        } else {
          drawStrImg(ctx2, "\uFF0D", x - 14, n - 3, 16, 170, 170, 170, 0.9);
        }
      }
      if (q[1] > 0) {
        ctx2.fillStyle = "rgba(140, 140, 140, 0.7)";
      } else {
        ctx2.fillStyle = "rgba(160, 160, 160, 1)";
      }
      ctx2.fillText(""+n2, x + 8, n);
    }
  }
  if (fpattf === 2) {
    x += 20 * s.length + 15;
    s = "\u21FD" + fpattn;
    ctx2.font = "25px " + font;
    ctx2.fillStyle = "rgba(170, 200, 170, 0.8)";
    ctx2.fillText(s, x, 70);
  }
  ctx2.font = "14px " + font;
  if (dsppxct || dsppxccd) {
    ctx2.fillStyle = "rgba(0, 170, 255, 1)";
  } else {
    ctx2.fillStyle = "rgba(0, 70, 200, 1)";
  }
  dsppxctx = 36;
  s = "" + (Math.floor(cellsz*100)/100) + "\u00B2";
  dsppxctw = 8 * s.length + 4;
  ctx2.fillText(s, dsppxctx, 274);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  ctx2.fillText("px/c", dsppxctx + s.length * 8 + 7, 274);
  dsppxcty = 261;
  dsppxctw = 8 * s.length;
  dsppxcth = 16;
  if (fpattf !== 0) {
    ctx2.font = "30px " + font;
    ctx2.fillStyle = "rgba(170, 0, 0, 1)";
    ctx2.fillText("w,h / c : "+fpattw+","+fpatth+" / "+(fpattf===1?fpattn:fpattnx), 90, 330);
  }
  if (fpattf === 1) {
    ctx2.fillStyle = "rgba(170, 0, 0, 1)";
    ctx2.fillText("char : "+fpattpos+" / "+(fpatt?fpatt.length:0), 130, 380);
  }
  if (fpattf === 2) {
    ctx2.fillStyle = "rgba(170, 0, 0, 1)";
    ctx2.fillText("pos : "+fpattzxp+","+fpattzyp, 140, 380);
    ctx2.fillText("on<>off : "+fpattnt, 70, 430);
  }
}

function drawDiamond() {
  var s, x, y, x2, y2, z, a, b, q, cr, cg, cb;
  q = updc();
  a = q[0];
  b = q[1];
  if (!ddiamcd && a === 0 && b === 0 && (ddiama > 0 || ddiamb > 0)) {
    ddiamcd = gts;
  }
  ddiamx = 0;
  ddiamy = 0;
  ddiamw = 0;
  ddiamh = 0;
  if (ddiamcd || a > 0 || b > 0) {
    if (a > 0 || b > 0) {
      ddiama = a;
      ddiamb = b;
      ddiamcd = null;
    }
    x = x2 = 110;
    y = y2 = 215;
    z = ddiamcd?0.7-0.6*(gts-ddiamcd>ddiamcdn?ddiamcdn:gts-ddiamcd)/ddiamcdn:0.7;
    ctx2.textBaseline = "bottom";
    ctx2.fillStyle = "rgba(240, 240, 0,"+z+")";
    if (ddiama > 0 && ddiamb === 0) {
      x += 3;
      y += 6;
      drawStrImg(ctx2, "\u25C7", x, y - 18, 91, 240, 240, 0, z);
    } else if (ddiama > 0 && ddiamb > 0) {
      x += 4;
      y -= 3;
      drawStrImg(ctx2, "\u25C8", x, y - 14, 62, 240, 240, 0, z);
    } else {
      x += 1;
      drawStrImg(ctx2, "\u25C6", x, y - 17, 83, 240, 240, 0, z);
    }
    ddiamx = x + 19;
    ddiamy = y - 48;
    ddiamw = 24;
    ddiamh = 23;
    ctx2.fillStyle = "rgba(170, 200, 170, 1)";
    ctx2.font = "12px " + font;
    if (ddiama > 1) {
      s = ""+ddiama;
      ctx2.fillStyle = "rgba(80, 200, 80,"+z+")";
      ctx2.fillText(s, x2 - s.length*8 + 17, y2-9);
    }
    if (ddiamb > 1) {
      s = ""+ddiamb;
      ctx2.fillStyle = "rgba(230, 160, 255,"+z+")";
      ctx2.fillText(s, x2 + 42, y2-9);
    }
    if (!ddiamcd && !ddiamcd2) {
      ddiamf = 0;
    }
    if ((ddiamcd && ddiamf > 0) || ddiamcd2 || !ddiamcd && b > 0) {
      cr = 0;
      cg = 0;
      cb = 0;
      if (ddiamcd2) {
        if ((gts - ddiamcd2)%300>=150) {
          if (ddiamf === 2) {
            cr = 220;
            cg = 0;
            cb = 0;
          } else {
            cr = 180;
            cg = 180;
            cb = 180;
          }
        } else {
          cr = 140;
          cg = 140;
          cb = 140;
        }
      } else if (!ddiamcd && histgn > 0 && hupdc === 0 || ddiamcd && ddiamf === 2) {
        cr = 220;
        cg = 0;
        cb = 0;
        ddiamf = 2;
      } else {
        cr = 50;
        cg = 50;
        cb = 50;
        ddiamf = 1;
      }
      if (ddiama > 0 && ddiamb > 0) {
        drawStrImg(ctx2, "\u29BB", x2+19, y2 - 30, 34, cr, cg, cb, z);
      } else {
        drawStrImg(ctx2, "\u29BB", x2+19, y2 - 29, 34, cr, cg, cb, z);
      }
    }
  }
}

function drawFramesSec() {
  var s, z, x;
  ctx2.textBaseline = "bottom";
  ctx2.font = "16px " + font;
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  s = "" + frpsn;
  x = 37;
  ctx2.fillText(s, x, 183);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  x += 10 * s.length + 6;
  ctx2.fillText("f/s", x + 1, 183);
  if (gnpsd || gnpscd) {
    if (gnpscd) {
      z = gts - gnpscd > gnpscdn ? 1 : (gts - gnpscd) / gnpscdn;
      if (!gnpsd) {
        z = 1 - z;
      }
    } else {
      z = 1;
    }
    ctx2.fillStyle = "rgba(170, 200, 170, " + z + ")";
    s = "" + gnpsn;
    x = 37;
    ctx2.fillText(s, x, 140);
    ctx2.fillStyle = "rgba(170, 170, 170, " + (z*0.6) + ")";
    x += 10 * s.length + 4;
    ctx2.fillText("g/s", x + 2, 140);
  }
}

function drawPos() {
  var x = cellX(posx,true), y = cellY(posy,true), x2, y2, s1, s2, l;
  s1 = ""+(cellsn>0?cellsr-cellsl+1:0);
  s2 = ""+Math.floor(cwidth/(cellsz>grb?cellsz+1:cellsz));
  l = Math.max(s1.length * 12, s2.length * 8) + 5;
  ctx2.textBaseline = "bottom";
  ctx2.font = "18px " + font;
  x2 = cwidth - 562;
  y2 = 37;
  ctx2.fillStyle = "rgba(140, 140, 140, 1)";
  ctx2.fillText("World", x2, y2);
  x2 = cwidth - 494;
  ctx2.fillStyle = "rgba(170, 0, 0, 0.7)";
  ctx2.fillRect(x2-9, y2-10, 3, 3);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  ctx2.fillText("w", x2, y2);
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  ctx2.fillText(s1, x2 + 20, y2);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  ctx2.fillText("h", x2 + 20 + l + 6, y2);
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  ctx2.fillText(""+(cellsn>0?cellst-cellsb+1:0), x2 + 20 + l + 6 + 16, y2);
  ctx2.font = "14px " + font;
  x2 = cwidth - 544;
  y2 = 59;
  ctx2.fillStyle = "rgba(140, 140, 140, 1)";
  ctx2.fillText("View", x2, y2);
  x2 = cwidth - 494;
  ctx2.fillStyle = "rgba(170, 0, 00, 0.7)";
  ctx2.fillRect(x2-9, y2-8, 3, 3);
  ctx2.fillStyle = "rgba(170, 0, 0, 0.5)";
  ctx2.fillText("\u22C5", x2-8, y2);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  ctx2.fillText("w", x2+2, y2);
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  ctx2.fillText(s2, x2 + 19, y2);
  ctx2.fillStyle = "rgba(170, 170, 170, 0.6)";
  ctx2.fillText("h", x2 + 19 + l + 9, y2);
  ctx2.fillStyle = "rgba(170, 200, 170, 1)";
  ctx2.fillText(""+Math.floor(cheight/(cellsz>grb?cellsz+1:cellsz)), x2 + 19 + l + 9 + 14, y2);
  s1 = ""+x;
  s2 = ""+y;
  dsppostx = 37;
  ctx2.font = "18px " + font;
  if (dsppost || dspposcd) {
    ctx2.fillStyle = "rgba(0, 170, 255, 0.6)";
  } else {
    ctx2.fillStyle = "rgba(0, 120, 240, 0.6)";
  }
  ctx2.fillText("x", dsppostx, 235);
  if (dsppost || dspposcd) {
    ctx2.fillStyle = "rgba(0, 170, 255, 1)";
  } else {
    ctx2.fillStyle = "rgba(0, 120, 240, 1)";
  }
  ctx2.fillText(s1, dsppostx-2 + 17, 235);
  if (dsppost || dspposcd) {
    ctx2.fillStyle = "rgba(0, 170, 255, 0.6)";
  } else {
    ctx2.fillStyle = "rgba(0, 120, 240, 0.6)";
  }
  ctx2.fillText("y", dsppostx-2 + 26 + 11 * s1.length, 235);
  if (dsppost || dspposcd) {
    ctx2.fillStyle = "rgba(0, 170, 255, 1)";
  } else {
    ctx2.fillStyle = "rgba(0, 120, 240, 1)";
  }
  ctx2.fillText(s2, dsppostx-2 + 26 + 11 * s1.length + 15, 235);
  dspposty = 217;
  dsppostw = 11 * (s1.length+s2.length+4) - 4;
  dspposth = 19;
}

function drawCRule() {
  var s1, s2, fs, x, y, w, h;
  ctx2.textBaseline = "bottom";
  if (hist[histh][0][histi][1] && cruleb === histcr[0] && crules === histcr[1]) {
    s1 = "B"+hist[histh][0][histi][1][1][0]+" "+"S"+hist[histh][0][histi][1][1][1];
    s2 = "B"+hist[histh][0][histi][1][0][0]+" "+"S"+hist[histh][0][histi][1][0][1];
  } else {
    s1 = "B"+cruleb+" "+"S"+crules;
    if (cruleb === histcr[0] && crules === histcr[1]) {
      s2 = "";
    } else {
      s2 = "B"+histcr[0]+" "+"S"+histcr[1];
    }
  }
  if (hlcrcd && s2.length === 0 || cruleb !== histcr[0] || crules !== histcr[1]) {
    drawStrImg(ctx2, "\u25C7", 25, cheight - 28, 50, 240, 240, 0, hlcrcd?0.8-0.8*(gts-hlcrcd>hlcrcdn?hlcrcdn:gts-hlcrcd)/hlcrcdn:0.8);
    orulex = 25;
    oruley = cheight - 59;
    orulew = 30;
    oruleh = 33;
  }
  if (hlcrcd && s2.length === 0) {
    ctx2.fillStyle = "rgba(240, 240, 0, 0.8)";
    fs = 24;
  } else if (hlcrcd2) {
    ctx2.fillStyle = "rgba(50, 150, 50, 0.8)";
    fs = 22;
  } else {
    ctx2.fillStyle = "rgba(80, 200, 80, 0.8)";
    fs = 22;
  }
  ctx2.font = ""+fs+"px " + font;
  ctx2.fillText(s1, 70, cheight - 30);
  if (s2.length > 0) {
    x = 110 + (fs-8) * s1.length;
    if (hlcrcd3) {
      fs = 17;
      ctx2.fillStyle = "rgba(220,200,80,0.8)";
    } else {
      fs = 16;
      ctx2.fillStyle = "rgba(70,180,70,0.4)";
    }
    ctx2.font = ""+fs+"px " + font;
    ctx2.fillText(s2, x, cheight - 30);
  }
}

function drawStpg() {
  var x, y, z, z1, z2, s, n;
  if (!stpgax && !stpge && !stpgcd) {
    return;
  } 
  x = 230 + Math.round((cwidth - 1000) / 100 * 20);
  y = 145;
  stpgssx = x + 6;
  stpgssy = y - 27;
  stpgssw = 27;
  stpgssh = 27;
  stpgssx2 = 0;
  stpgssy2 = 0;
  stpgssw2 = 0;
  stpgssh2 = 0;
  stpgdx = 0;
  stpgdy = 0;
  stpgdw = 0;
  stpgdh = 0;
  if (!stpgcd || gts - stpgcd > stpgcdn) {
    z = 1;
  } else {
    z = (gts - stpgcd) / stpgcdn;
  }
  if (!stpge) {
    z = 1 - z;
  }
  ctx2.textBaseline = "bottom";
  ctx2.font = "40px " + font;
  if (stpgax) {
    z1 = 1;
  } else {
    z1 = z;
  }
  if (stpgcd2) {
    if (gts - stpgcd2 > stpgcdn2) {
      z2 = 1;
    } else {
      z2 = (gts - stpgcd2) / stpgcdn2;
    }
    if (stpgsf) {
      z2 = 1 - z2;
    }
    drawStrImg(ctx2, "\u29B5", x, y - 4, 40, 170, 0, 0, (1 - z2) * z1 * 0.9);
    drawStrImg(ctx2, "\u29B5", x, y - 4, 40, 240, 240, 0, z2 * z1 * 0.9);
  } else {
    if (!stpgax && stpgn2 !== -2) {
      z2 = 1;
    } else if (!stpge && stpgn2 === -2) {
      z2 = 0;
    } else {
      z2 = z;
    }
    drawStrImg(ctx2, "\u29B5", x, y - 4, 40, 170, 0, 0, (1 - z2) * z1 * 0.9);
    drawStrImg(ctx2, "\u29B5", x, y - 4, 40, 0, 70, 200, z2 * z1 * 0.9);
  }
  if (stpge || stpgcd && stpgn2 !== -2) {
    stpgssx2 = x + 8;
    stpgssy2 = y + 10;
    stpgssw2 = 25;
    stpgssh2 = 25;
    drawStrImg(ctx2, "\u25C9", x + 3, y + 33, 29, 0, 70, 200, z * 0.9);
  }
  ctx2.font = "25px " + font;
  s = (stpgnm === 1 ? "+" : stpgnm === -1 ? "-" : "") + stpgn;
  stpgdx = x + 60;
  stpgdy = y - 23;
  stpgdw = s.length * 17;
  stpgdh = 25;
  if (stpgax && !stpge && ffw !== 0 && ffwstp) {
    ctx2.fillStyle = "rgba(170, 170, 170, 0.7)";
    if (ffw === -1) {
      ctx2.fillText("\u27F5", stpgdx + 4 * s.length, y - 25);
    } else {
      ctx2.fillText("\u27F6", stpgdx + 4 * s.length, y - 25);
    }
    ctx2.fillStyle = "rgba(170, 170, 255, 1)";
  } else if (stpgcd2) {
    ctx2.fillStyle = "rgba(0, 70, 200, 0.9)";
  } else {
    ctx2.fillStyle = "rgba(" + Math.round(140 * z2) + ", " + (70 + Math.round(70 * z2)) + ", " + (200 - Math.round(60 * z2)) +  ", " + (z1 * 0.9) + ")";
  }
  ctx2.fillText(s, stpgdx, y);
  if (!stpge && (stpgax || !stpgax && stpgcd && stpgn2 !== -1) && (n = (stpgnm === 0 ? stpgn : stpgnc + stpgn * stpgnm) - gennum) !== 0 && (stpgnm === 0 || stpgnm !== 0 && stpgnc !== gennum) || stpgcd && stpge && stpgax && (n = (stpgnm2 === 0 ? stpgn2 : stpgnc2 + stpgn2 * stpgnm2) - gennum) !== 0 && (stpgnm2 === 0 || stpgnm2 !== 0 && stpgnc2 !== gennum)) {
    ctx2.font = "15px " + font;
    ctx2.fillStyle = "rgba(140, 140, 140, " + ((!stpge&&!stpgax?z:1-z)*0.8) + ")";
    ctx2.fillText((n > 0 ? "+" : "-") + Math.abs(n), x + 70 + 15 + 16 * s.length, y - 5);
  }
}

function drawFButt() {
  var x, px = cwidth - 8, y, i;
  ctx2.textBaseline = "bottom";
  x = px;
  y = 106;
  drawFButt0(x -= 51, y, 44, 32, 0, dhlpn > 0, function(fb) {
    swdhlp();
  });
  drawFButt0(x -= 51, y, 44, 32, 1, dwrld, function(fb) {
    swdwrld();
  });
  drawFButt0(x -= 51, y, 44, 32, 2, patt, function(fb) {
    swpatt();
  });
  drawFButt0(x -= 51, y, 44, 32, 3, dspgrd, function(fb) {
    swdspgrd();
  });
  drawFButt0(x -= 51, y, 44, 32, 4, stpge, function(fb) {
    swstpge();
  });
  x = px - 49;
  drawFButt0(x, y -= 41, 44, 32, 5, null, function(fb) {
    swclru();
  });
  drawFButt0(x, y -= 41, 44, 32, 6, !dmsgs, function(fb) {
    swdmsgs();
  });
}

function drawFButt0(x, y, w, h, i, t, f) {
  var lw;
  if (i >= fbutt.length) {
    fbutt[i] = [];
    fbutt[i][0] = x; 
    fbutt[i][1] = y; 
    fbutt[i][2] = w;
    fbutt[i][3] = h;
    fbutt[i][4] = false;
    fbutt[i][5] = false;
    fbutt[i][6] = null;
    fbutt[i][7] = f ? f : null;
  }
  fbutt[i][0] = x; 
  fbutt[i][1] = y; 
  fbutt[i][5] = t;
  lw = 2;
  ctx2.fillStyle = "rgba(150, 110, 110, 0.6)";
  fillrr(ctx2, x, y, w, h, h / 4);
  ctx2.setLineDash([]);
  ctx2.lineWidth = lw;
  ctx2.strokeStyle = "rgba(0, 0, 0, 1)";
  strokerr(ctx2, x + lw, y + lw, w - lw*2, h - lw*2, (h - lw*2) / 4);
  if (fbutt[i][4] || fbutt[i][6]) {
    ctx2.strokeStyle = "rgba(0, 170, 255, 0.8)";
  } else if (fbutt[i][5]) {
    ctx2.strokeStyle = "rgba(180, 180, 250, 0.9)";
  } else {
    ctx2.strokeStyle = "rgba(0, 70, 200, 0.8)";
  }
  strokerr(ctx2, x, y, w, h, h / 4);
  switch (i) {
    case 0:
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "?", x + 16, y + 25, 23, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "?", x + 16, y + 25, 23, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "?", x + 16, y + 25, 23, 0, 0, 0, 1);
      }
      break;
    case 1:
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "W", x + 11, y + 25, 23, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "W", x + 11, y + 25, 23, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "W", x + 11, y + 25, 23, 0, 0, 0, 1);
      }
      break;
    case 2: 
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "P", x + 15, y + 25, 23, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "P", x + 15, y + 25, 23, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "P", x + 15, y + 25, 23, 0, 0, 0, 1);
      }
      break;
    case 3: 
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "\u2317", x + 13, y + 24, 29, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "\u2317", x + 13, y + 24, 29, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "\u2317", x + 13, y + 24, 29, 0, 0, 0, 1);
      }
      break;
    case 4: 
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "\u29B5", x + 9, y + 26, 31, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "\u29B5", x + 9, y + 26, 31, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "\u29B5", x + 9, y + 26, 31, 0, 0, 0, 1);
      }
      break;
    case 5: 
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "\u29BB", x + 9, y + 27, 35, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "\u29BB", x + 9, y + 27, 35, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "\u29BB", x + 9, y + 27, 35, 0, 0, 0, 1);
      }
      break;
    case 6: 
      if (fbutt[i][4] || fbutt[i][6]) {
        drawStrImg(ctx2, "MSG", x + 5, y + 22, 15, 140, 140, 140, 0.7);
      } else if (fbutt[i][5]) {
        drawStrImg(ctx2, "MSG", x + 5, y + 22, 15, 190, 210, 190, 0.6);
      } else {
        drawStrImg(ctx2, "MSG", x + 5, y + 22, 15, 0, 0, 0, 1);
      }
      ctx2.beginPath();
      ctx2.lineWidth = 1;
      ctx2.setLineDash([]);
      if (fbutt[i][4] || fbutt[i][6]) {
        ctx2.strokeStyle = "rgba(140, 140, 140, 0.7)";
      } else if (fbutt[i][5]) {
        ctx2.strokeStyle = "rgba(190, 210, 190, 0.6)";
      } else {
        ctx2.strokeStyle = "rgba(0, 0, 0, 1)";
      }
      ctx2.moveTo(x+lw*4,y+lw*4);
      ctx2.lineTo(x+w-lw*4,y+h-lw*4);
      ctx2.moveTo(x+w-lw*4, y+lw*4);
      ctx2.lineTo(x+lw*4, y+h-lw*4);
      ctx2.stroke();
      break;
  }
}

function drawGrid() {
  var w = cwidth, h = cheight, p, p2, n;
  p = w/2 - (posx / (cellsz + 1) - Math.floor(posx / (cellsz + 1))) * (cellsz + 1);
  p = p - Math.ceil(p / (cellsz + 1)) * (cellsz + 1);
  p2 = Math.round(cellX(posx+(p-w/2)));
  while (p < w) {
    if (p >= 0) {
      ctx0.beginPath();
      ctx0.lineWidth = 1;
      ctx0.moveTo(p+0.5|0, 0);
      ctx0.lineTo(p+0.5|0, h-1);
      if (p2 === 0) {
        ctx0.setLineDash([2,2]);
        ctx0.strokeStyle = "rgba(200,200,200,0.7)";
      } else if (p2%10 === 0) {
        ctx0.setLineDash([]);
        ctx0.strokeStyle = "rgba(70,70,120,1)";
      } else {
        ctx0.setLineDash([]);
        ctx0.strokeStyle = "rgba(70,70,70,0.9)";
      }
      ctx0.stroke();
    }
    p += cellsz + 1;
    p2++;
  }
  p = h/2 + (posy / (cellsz + 1) - Math.floor(posy / (cellsz + 1))) * (cellsz + 1);
  p = p + Math.ceil((h - p) / (cellsz + 1)) * (cellsz + 1);
  p2 = Math.round(cellY(posy-(p-h/2)));
  while (p >= 0) {
    if (p < h) {
      ctx0.beginPath();
      ctx0.lineWidth = 1;
      ctx0.moveTo(0, p+0.5|0, 0);
      ctx0.lineTo(w-1, p+0.5|0, h);
      if (p2 === 0) {
        ctx0.setLineDash([2,2]);
        ctx0.strokeStyle = "rgba(200,200,200,0.7)";
      } else if (p2%10 === 0) {
        ctx0.setLineDash([]);
        ctx0.strokeStyle = "rgba(70,70,120,1)";
      } else {
        ctx0.setLineDash([]);
        ctx0.strokeStyle = "rgba(70,70,70,0.9)";
      }
      ctx0.stroke();
    }
    p -= cellsz + 1;
    p2++;
  }
}

function drawHelp() {
  var a, i, j, z, x, y, k, n;
  if (dhlpn !== dhlpn2) {
    if (dhlpn === 0) {
      dhlpcd2 = null;
      dhlpcd3 = null;
    } else {
      dhlpcd2 = gts;
      dhlpcd3 = gts;
    }
    if (dhlpql > 0) {
      if (!dhlpq[dhlpql-1][5]) {
        dhlpq[dhlpql-1][5] = gts;
      }
    }
    if (dhlpn > 0) {
      a = drawHelp0(dhlpn);
      dhlpq[dhlpql] = [];
      dhlpq[dhlpql][0] = a[0];
      dhlpq[dhlpql][1] = a[1];
      dhlpq[dhlpql][2] = a[2];
      dhlpq[dhlpql][3] = a[3];
      dhlpq[dhlpql][4] = a[4];
      dhlpq[dhlpql][5] = gts;
      dhlpq[dhlpql][6] = 0;
      dhlpq[dhlpql][7] = a[5];
      dhlpql++;
    }
    dhlpn2 = dhlpn;
  }
  if (dhlpn > 0 && dhlpql > 0 && dhlpq[dhlpql-1][5]) {
    dhlpq[dhlpql-1][6] = gts - dhlpq[dhlpql-1][5] > dhlpcdn ? 1 : (gts - dhlpq[dhlpql-1][5]) / dhlpcdn;
  }
  ctx2.textBaseline = "bottom";
  i = 0;
  j = 0;
  while (i < dhlpql) {
    if (dhlpq[i][5] !== null || dhlpn > 0 && i === dhlpql - 1) {
      dhlpq[j++] = (a = dhlpq[i]);
      z = gts - a[5] > dhlpcdn ? 1 : (gts - a[5]) / dhlpcdn;
      if (dhlpn === 0 || i < dhlpql - 1) {
        z = 1 - z;
      }
      x = (cwidth - a[3]) / 2 + a[1];
      y = (cheight - a[4]) / 2 + a[2];
      ctx2.globalAlpha = z;
      if (a[6] >= 1) {
        ctx2.fillStyle = "rgba(0, 80, 0, 0.25)";
        fillrr(ctx2, x+0.5|0, y+0.5|0, a[3]+0.5|0, a[4]+0.5|0, a[4] / 5);
        ctx2.drawImage(a[0], x+0.5|0, y+0.5|0);
      } else {
        z = Math.pow(2, 9+3*a[6]) / 4096;
        ctx2.drawImage(a[0], 0, 0, a[3] / 2, a[4] / 2, 0 - a[3] / 2 + (x + a[3] / 2) * z, y, a[3] / 2, a[4] / 2);
        ctx2.drawImage(a[0], a[3] / 2, 0, a[3] / 2, a[4] / 2, x + a[3] / 2, 0 - a[4] / 2 + (y + a[4] / 2) * z, a[3] / 2, a[4] / 2);
        ctx2.drawImage(a[0], a[3] / 2, a[4] / 2, a[3] / 2, a[4] / 2, cwidth - (cwidth - x - a[3] / 2) * z, y + a[4] / 2, a[3] / 2, a[4] / 2);
        ctx2.drawImage(a[0], 0, a[4] / 2, a[3] / 2, a[4] / 2, x, cheight - (cheight - y - a[4] / 2) * z, a[3] / 2, a[4] / 2);
      }
      ctx2.globalAlpha = 1;
      if (dhlpn > 0 && a[6] >= 1 && i === dhlpql - 1) {
        n = 1;
        for (k = 0; k < a[7][0].length; k++) {
          drawHelp1(ctx2, x + (k + 1) * (a[3] / (a[7][0].length + 1)), y, a[7][0][k][0], a[7][0][k][1], n++);
        }
        for (k = 0; k < a[7][1].length; k++) {
          drawHelp1(ctx2, x + a[3], y + (k + 1) * (a[4] / (a[7][1].length + 1)), y, a[7][1][k][0], a[7][1][k][1], n++);
        }
        for (k = 0; k < a[7][2].length; k++) {
          drawHelp1(ctx2, x + a[3] - (k + 1) * (a[3] / (a[7][2].length + 1)), y + a[4], a[7][2][k][0], a[7][2][k][1], n++);
        }
        for (k = 0; k < a[7][3].length; k++) {
          drawHelp1(ctx2, x, y + a[4] - (k + 1) * (a[4] / (a[7][3].length + 1)), y, a[7][3][k][0], a[7][3][k][1], n++);
        }
      }
    }
    i++;
  }
  for (i = j; i < dhlpql; i++) {
    dhlpq[i] = null;
  }
  dhlpql = j;
}

function drawHelp0(n) {
  var w = 0, h = 0, x, x2, i, dx, dy, px, py, mx, my, l;
  function drw(c, s, x, y) {
    var w2 = c.measureText(s).width;
    c.fillText(s, x, y);
    if (x + w2 > w)
      w = x + w2;
    if (y > h)
      h = y;
    return x + w2;
  }
  canvasos1.width = cwidth;
  canvasos1.height = cheight;
  ctxos1.clearRect(0, 0, cwidth, cheight);
  ctxos1.textBaseline = "bottom";
  x = 0;
  y = 0;
  dx = 0;
  dy = 0;
  mx = 15;
  my = 10;
  l = [[],[],[],[]];
  switch (n) {
    case 1:
      dx = 150;
      dy = 100;
      l[0][0] = [fbutt[0][0] + 10, fbutt[0][1] + 25];
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(210, 210, 210, 1)";
      drw(ctxos1, "\u22C5  Discover Yagols \u22C5 Poke Around  \u22C5", x, y + 15);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, "\u22C5  Help is shown when functions are activated  \u22C5", x + 8, y + 39);
      ctxos1.fillText("\u22C5", x + 22, y + 63);
      ctxos1.fillStyle = "rgba(170, 200, 170, 0.9)";
      ctxos1.fillText("Click", x + 35, y + 63);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 63);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(0, 70, 200, 0.8)";
      x2 = drw(ctxos1, "blue", x2, y + 64);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " ( or ", x2, y + 63);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(170, 0, 0, 1)";
      x2 = drw(ctxos1, "red", x2, y + 64);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " ) button / symbol / text to (de)activate a function  \u22C5", x2, y + 63);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 83);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(170, 0, 0, 1)";
      x2 = drw(ctxos1, "red", x2 + 1, y + 84);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " ( or sometimes ", x2, y + 83);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(0, 70, 200, 0.8)";
      x2 = drw(ctxos1, "blue", x2, y + 84);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " ) symbol to cancel / stop / clear  \u22C5", x2, y + 83);
      ctxos1.fillText("\u22C5", x + 22, y + 107);
      ctxos1.fillStyle = "rgba(170, 200, 170, 0.9)";
      ctxos1.fillText("Press", x + 35, y + 107);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 107);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "B", x2, y + 108);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, ", ", x2, y + 107);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "S", x2, y + 108);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " or ", x2, y + 107);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "0", x2, y + 107);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " - ", x2, y + 107);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "9", x2, y + 107);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to enter a new rule, or at which generation to stop  \u22C5", x2, y + 107);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 127);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "?", x2, y + 128);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, ", ", x2, y + 127);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "P", x2, y + 128);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, ", ", x2, y + 127);
      ctxos1.font = "15px " + font;
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "W", x2, y + 128);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, ", etc., to (de)activate function  \u22C5", x2, y + 127);
      break;
    case 2:
      dx = 100;
      dy = 100;
      l[0][0] = [stpgssx2 + 20, stpgssy2 + 20];
      l[0][1] = [stpgssx + 20, stpgssy + 20];
      l[0][2] = [stpgdx + 20, stpgdy + 15];
      l[0][3] = [fbutt[4][0] + 10, fbutt[4][1] + 25];
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(210, 210, 210, 1)";
      drw(ctxos1, "\u22C5  Set a stop at an absolute or relative generation number (> 0) \u22C5 Just start typing \u22C5", x, y + 15);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, "\u22C5  The stop is set and active when the stop sign ", x + 8, y + 39);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "(2)", x2, y + 39);
      x2 = drw(ctxos1, " is  ", x2, y + 39);
      ctxos1.fillStyle = "rgba(170, 0, 0, 1)";
      ctxos1.font = "16px " + font;
      x2 = drw(ctxos1, "red", x2, y + 40);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, "  \u22C5", x2, y + 39);
      ctxos1.fillText("\u22C5", x + 22, y + 63);
      ctxos1.fillStyle = "rgba(170, 200, 170, 0.9)";
      ctxos1.fillText("Press", x + 35, y + 63);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 63);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "0", x2, y + 63);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " - ", x2, y + 63);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "9", x2, y + 63);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " to enter generation number, ", x2, y + 63);
      ctxos1.fillStyle = "rgba(220, 220, 220, 1)";
      x2 = drw(ctxos1, "-", x2, y + 63);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to toggle absolute / minus / plus  \u22C5", x2, y + 63);
      ctxos1.fillText("\u22C5", x + 35, y + 83);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 83);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "Enter", x2, y + 83);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " to set and activate the stop, ", x2, y + 83);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "Esc", x2, y + 83);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " to de-activate the stop  \u22C5", x2, y + 83);
      ctxos1.fillText("\u22C5    \u22C5", x + 35, y + 103);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 103);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "Backspace", x2, y + 103);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, " to remove last digit  \u22C5", x2, y + 103);
      ctxos1.fillText("\u22C5", x + 45, y + 123);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 123);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "0", x2, y + 123);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " first to start with last entered value  \u22C5 ", x2, y + 123);
      ctxos1.fillStyle = "rgba(170, 200, 170, 0.9)";
      ctxos1.fillText("Click", x + 39, y + 147);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 147);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "(1)", x2, y + 147);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to set and activate the stop  \u22C5", x2, y + 147);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 167);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "(2)", x2, y + 167);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to de-activate the stop  \u22C5", x2, y + 167);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 187);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "(3)", x2, y + 187);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to start/stop fast-forwarding / rewinding (when activated)  \u22C5", x2, y + 187);
      x2 = drw(ctxos1, "\u22C5  ", x + 90, y + 207);
      drawStrImg(ctxos1, "\u21FE", x2, y + 206, 22, 220, 220, 220, 1);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, "This is the fastest way to go to any generation \u22C5 Repeating Oscillators  \u22C5", x2 + 22, y + 207);
      x2 = drw(ctxos1, "\u22C5   & Spaceships are skipped and gen markers ( ", x + 105, y + 227);
      drawStrImg(ctxos1, "\u25C6", x2 + 1, y + 227, 27, 240, 240, 0, 0.8);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " ) are ignored  \u22C5", x2 + 20, y + 227);
      x2 = drw(ctxos1, "\u22C5  ", x + 78, y + 247);
      ctxos1.fillStyle = "rgba(220, 220, 220, 0.9)";
      x2 = drw(ctxos1, "(4)", x2, y + 247);
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " to set / activate the stop  \u22C5", x2, y + 247);
      x2 = drw(ctxos1, "\u22C5  Yagols will also respect the stop when running ( ", x + 10, y + 271);
      drawStrImg(ctxos1, "\u25B7\u25B7\u25B7", x2, y + 269, 13, 0, 70, 200, 1);
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 0.8)";
      drw(ctxos1, " )  \u22C5", x2 + 40, y + 271);
      drw(ctxos1, "\u22C5  If a relative stop has been set it will be re-set everytime when stopped  \u22C5", x + 10, y + 295);
      break;
    default:
      ctxos1.font = "13px " + font;
      ctxos1.fillStyle = "rgba(200, 200, 200, 1)";
      drw(ctxos1, "\u22C5  ?  \u22C5", x, y + 15);
      break;
  }
  h += 7;
  mx = 28;
  my = 20;
  canvasos2.width = w + mx * 2;
  canvasos2.height = h + my * 2;
  ctxos2.clearRect(0, 0, canvasos2.width, canvasos2.height);
  ctxos2.drawImage(canvasos1, 0, 0, w, h, (canvasos2.width - w) / 2, (canvasos2.height - h) / 2, w, h);
  i = new Image();
  i.src = canvasos2.toDataURL("image/png");
  return [i, dx, dy, canvasos2.width, canvasos2.height, l];  
}

function drawHelp1(c, fx, fy, tx, ty, n) {
  var a, hl = 15, s, x, y, q = 0.2, l;
  a = Math.atan2(ty-fy, tx-fx);
  c.beginPath();
  if (dhlplf === 1) {
    c.setLineDash([0,4,0]);
  } else {
    c.setLineDash([2,0,2]);
  }
  c.lineWidth = 1;
  c.strokeStyle = "rgba(140, 140, 180, 0.7)";
  c.moveTo(fx, fy);
  c.lineTo(tx, ty);
  c.stroke();
  c.beginPath();
  c.moveTo(tx, ty);
  c.setLineDash([]);
  c.lineWidth = 3;
  c.lineTo(tx-hl*Math.cos(a-Math.PI/6),ty-hl*Math.sin(a-Math.PI/6));
  c.stroke();
  c.beginPath();
  c.moveTo(tx, ty);
  c.setLineDash([]);
  c.lineWidth = 3;
  c.lineTo(tx-hl*Math.cos(a+Math.PI/6),ty-hl*Math.sin(a+Math.PI/6));
  c.stroke();
  s = "(" + n +")";
  l = s.length * 3;
  x = fx + (tx - fx) * q - l;
  y = fy - (fy - ty) * q + l;
  c.font = "12px " + font;
  c.fillStyle = "rgba(220, 220, 220, 0.9)";
  c.fillText(s, x, y);
}

function strokerr(c, x, y, w, h, r) {
  c.beginPath();
  c.moveTo(x+r, y);
  c.lineTo(x+w-r, y);
  c.quadraticCurveTo(x+w, y, x+w, y+r);
  c.lineTo(x+w, y+h-r);
  c.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
  c.lineTo(x+r, y+h);
  c.quadraticCurveTo(x, y+h, x, y+h-r);
  c.lineTo(x, y+r);
  c.quadraticCurveTo(x, y, x+r, y);
  c.stroke();
}

function fillrr(c, x, y, w, h, r) {
  c.beginPath();
  c.moveTo(x+r, y);
  c.lineTo(x+w-r, y);
  c.quadraticCurveTo(x+w, y, x+w, y+r);
  c.lineTo(x+w, y+h-r);
  c.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
  c.lineTo(x+r, y+h);
  c.quadraticCurveTo(x, y+h, x, y+h-r);
  c.lineTo(x, y+r);
  c.quadraticCurveTo(x, y, x+r, y);
  c.fill();
}

function drawStrImg(c, s, x, y, fs, r, g, b, a, q) {
  var k, d, i = null;
  k = s+"-"+fs+"-"+r+"-"+g+"-"+b;
  if (q) {
    k += "-"+q;
  }
  if (!(i = strimgt[k])) {
    canvasos0.width = s.length * fs;
    canvasos0.height = fs;
    ctxos0.clearRect(0, 0, canvasos0.width, canvasos0.height);
    ctxos0.font = fs + "px " + font;
    ctxos0.fillStyle = "rgba("+r+","+g+","+b+",1)";
    ctxos0.fillText(s, 0, canvasos0.height - 1 - (q?q:0));
    d = canvasos0.toDataURL("image/png");
    console.log("pstrimg(\"" + k + "\", \"" + d + "\");");
    i = new Image();
    i.src = d;
    strimgt[k] = i;
  }
  if (a < 1) {
    c.globalAlpha = a;
  }
  c.drawImage(i, x, y - fs + 1);
  if (a < 1) {
    c.globalAlpha = 1;
  }
}

function pstrimg(k, d) {
  var i = new Image();
  i.src = d;
  strimgt[k] = i;
}
    
function hupdates() {
  var i, n, a;
  a = [];
  for (i = 0; i < tarr.length; i++) {
    n = tidx[crkey(tarr[i][0],tarr[i][1])];
    if (n < 0 && tarr[i][2] > 0 || Math.abs(n%2) === 1) {
      a.push([tarr[i][0],tarr[i][1],tarr[i][2],0,1]);
    }
  }
  tarr = [];
  tidx = {};
  hupdc = 0;
  return a;
}

function calcGen(u) {
  var i, u2, q, hi = hist[histh][0][histi], ci, cxi, z, c, hf = false, q1, q2, p, s, pp, dx, dy, cp, cm;
  c = cellsn;
  cp = 0;
  cm = 0;
  capHist();
  if ((u2 = u?u:hupdates()).length > 0) {
    hi[3][1]++;
    hf = true;
  }
  appendHUpd(hi[0], u2, hi[3][1]-1);
  cellsf = false;
  if (cruleb !== histcr[0] || crules !== histcr[1]) {
    clrcellsx();
    hf = true;
    crulecomp();
    cellsf = true;
    if (hi[1]) {
      histcr = hi[1][0];
    }
    hi[1] = [histcr, [cruleb,crules]];
    histcr = [cruleb,crules];
    hlcrcd = performance.now();
    hlcrd2 = null;
    hlcrd3 = null;
    hi[3][0]++;
    drawMsgsStm("New Rule", "B"+cruleb+" S"+crules);
  }
  hi[5] = mingen;
  hi[6] = cellst;
  hi[7] = cellsr;
  hi[8] = cellsb;
  hi[9] = cellsl;
  hf = hf ? hf : histp > 0 && hi[0].length > 0 && (q = prevHist(histh, histi)) && hist[q[0]][0][q[1]][11][0] > 0 && hist[q[0]][0][q[1]][11][1] === histp;
  if (hbcksll === 0 && (histp === 0 || hf)) {
    hi[10] = hbckhac();
    hbckslf = 0;
    if (!hbcksl) {
      hbcksl = [];
    }
    hbcksm = new Map();
    for (i = hbcksl.length; i < 5000; i++) {
      hbcksl[i] = 0;
    }
    z = histgp;
    p = 0;
    q1 = [histh,histi];
    while (z-- >= 0 && hbcksll < hbcksl.length) {
      if (p === -1) {
        if (z < 0) {
          break;
        }
        q1 = prevHist(q1[0], q1[1]);
        if (!hist[q1[0]][0][q1[1]][0] || hist[q1[0]][0][q1[1]][0].length === 0 || hist[q1[0]][0][q1[1]][2] > 0) {
          break;
        }
        p = 0;
      }
      if (p > 0) {
        q2 = rlHist(q1[0], q1[1], p--)[2];
        hbcksl[hbcksll++] = hist[q2[0]][0][q2[1]][10];
        hbcksm.set(hist[q2[0]][0][q2[1]][10], true);
        if (p <= 0) {
          p = -1;
        }
      } else if (p === 0) {
        hbcksl[hbcksll++] = hist[q1[0]][0][q1[1]][10];
        hbcksm.set(hist[q1[0]][0][q1[1]][10], true);
        if (hist[q1[0]][0][q1[1]][3][0] > 0 || hist[q1[0]][0][q1[1]][3][1] > 0) {
          break;
        }
        p = -1;
        if (z >= 0) {
          q2 = prevHist(q1[0], q1[1]);
          if (hist[q2[0]][0][q2[1]][11][0] > 0) {
            p = hist[q2[0]][0][q2[1]][11][1];
          }
        }
      }
    }
  }
  if (histp === 0) {
    hbckcheck();
  }
  gennum++;
  histgp++;
  if (histp === 0 || hf) {
    mingen = gennum;
    cellsl = maxr + 1;
    cellsr = maxl - 1;
    cellst = maxb - 1;
    cellsb = maxt + 1;
    cellsan = 0;
    if (cellsxf) {
      for (i = 0; i < cellsxl; i++) {
        cxi = cellsx[i];
        if (cxi[0][0] === 1 && ccrulesx && !ccrules[cxi[0][3]]) {
          cells[cxi[0][2]-1][3] = 9;
          cellsf = true;
          cellsan++;
          if (cellsan > cellsa.length) {
            cellsa[cellsan-1] = [1,cxi[1],cxi[2],cxi[0][2]-1];
          } else {
            cellsa[cellsan-1][0] = 1;
            cellsa[cellsan-1][1] = cxi[1];
            cellsa[cellsan-1][2] = cxi[2];
            cellsa[cellsan-1][3] = cxi[0][2]-1;
          }
          hi[0].push([cxi[1],cxi[2],cells[cxi[0][2]-1][2],0,0]);
        }
      }
      for (i = 0; i < cellslen; i++) {
        ci = cells[i];
        if (ci[3] === 9) {
          ci[3] = 1;
        } else if (ci[3] === 1) {
          mingen = ci[2] > 0 ? mingen === 0 ? ci[2] : mingen > ci[2] ? ci[2] : mingen : mingen === 0 ? gennum : mingen;
          if (ci[2] === 0) {
            cellsf = true;
            hi[0].push([ci[0],ci[1],-2,0,0]);
            ci[2] = gennum;
          }
          if (ci[0] < cellsl) {
            cellsl = ci[0];
          }
          if (ci[0] > cellsr) {
            cellsr = ci[0];
          }
          if (ci[1] > cellst) {
            cellst = ci[1];
          }
          if (ci[1] < cellsb) {
            cellsb = ci[1];
          }
        }
      }
      for (i = 0; i < cellsxl; i++) {
        cxi = cellsx[i];
        if (cxi[0][0] !== 1 && ccrulebx && ccruleb[cxi[0][3]]) {
          cellsf = true;
          hi[0].push([cxi[1],cxi[2],-1,0,0]);
          cellsan++;
          if (cellsan > cellsa.length) {
            cellsa[cellsan-1] = [0, cxi[1], cxi[2], null];
          } else {
            cellsa[cellsan-1][0] = 0;
            cellsa[cellsan-1][1] = cxi[1];
            cellsa[cellsan-1][2] = cxi[2];
            cellsa[cellsan-1][3] = null;
          }
          if (cxi[1] < cellsl) {
            cellsl = cxi[1];
          }
          if (cxi[1] > cellsr) {
            cellsr = cxi[1];
          }
          if (cxi[2] > cellst) {
            cellst = cxi[2];
          }
          if (cxi[2] < cellsb) {
            cellsb = cxi[2];
          }
        }
      }
      clrcellsx(true);
    } else {
      for (i = 0; i < cellslen; i++) {
        ci = cells[i];
        if (ci[3] === 1) {
          if (ccrules[fcidx(ci[0],ci[1])[3] = neighbours(ci[0], ci[1], true)] && ccrulesx) {
            mingen = ci[2] > 0 ? mingen === 0 ? ci[2] : mingen > ci[2] ? ci[2] : mingen : mingen === 0 ? gennum : mingen;
            if (ci[2] === 0) {
              cellsf = true;
              hi[0].push([ci[0],ci[1],-2,0,0]);
              ci[2] = gennum;
            }
            if (ci[0] < cellsl) {
              cellsl = ci[0];
            }
            if (ci[0] > cellsr) {
              cellsr = ci[0];
            }
            if (ci[1] > cellst) {
              cellst = ci[1];
            }
            if (ci[1] < cellsb) {
              cellsb = ci[1];
            }
          } else {
            cellsf = true;
            cellsan++;
            if (cellsan > cellsa.length) {
              cellsa[cellsan-1] = [1,ci[0],ci[1],i];
            } else {
              cellsa[cellsan-1][0] = 1;
              cellsa[cellsan-1][1] = ci[0];
              cellsa[cellsan-1][2] = ci[1];
              cellsa[cellsan-1][3] = i;
            }
            hi[0].push([ci[0],ci[1],ci[2],0,0]);
          }
        }
      }
    }
    cellsxf = true;
    for (i = 0; i < cellsan; i++) {
      if (cellsa[i][0] !== 1 && cellsa[i][3]) {
        if (cellsa[i][3][1] === 1) {
          cellsa[i][3][1] = 0;
        }
        cellsa[i][3] = null;
      }
      if (cellsa[i][0] === 0) {
        z = addCell(cellsa[i][1],cellsa[i][2]);
        cells[z][4] = fcidx(cellsa[i][1],cellsa[i][2],2,z+1);
        cellsn++;
        cp++;
      } else {
        if (cellsa[i][0] === 1) {
          rmvCell(cellsa[i][3]);
          cellsn--;
          cm++;
        }
        fcidx(cellsa[i][1],cellsa[i][2],1);
      }
    }
    calcWrld2();
  } else {
    hbcksll = 0;
  }
  if (hf) {
    histp = 0;
  }
  if (histp > 0) {
    if (hi[11][0] > 0) {
      hi[11][1] = 1;
    } else {
      q = prevHist(histh, histi);
      hist[q[0]][0][q[1]][11][1]++;
      histp++;
    }
  }
  if (!cellsf && hi[4] && histp === 0) {
    q = prevHist(histh, histi);
    hist[q[0]][0][q[1]][2]++;
  } else if (histp === 0 || hi[11][0] > 0) {
    z = hist[histh][0][histi][10];
    nextHist();
    hist[histh][0][histi] = [[],null,0,[0,0],histp===0&&!cellsf,mingen,cellst,cellsr,cellsb,cellsl,(histp>0||cellsn===0?0:cellsxl===0?z:hbckhac()),[0,0,0,0],cp,cm];
  }
  if (histp > 0) {
    q = prevHist(histh, histi);
    pp = hist[q[0]][0][q[1]][11][0];
    dx = hist[q[0]][0][q[1]][11][2];
    dy = hist[q[0]][0][q[1]][11][3];
    if (s = histp%pp === 1) {
      if (histp > 1) {
        nextGen2(hist[q[0]][0][q[1]], false, pp, dx, dy);
      }
    }
    q = rlHist(histh, histi, histp);
    nextGen2(hist[q[0]][0][q[1]], s, pp, dx, dy);
    cellst = hist[q[2][0]][0][q[2][1]][6];
    cellsr = hist[q[2][0]][0][q[2][1]][7];
    cellsb = hist[q[2][0]][0][q[2][1]][8];
    cellsl = hist[q[2][0]][0][q[2][1]][9];
    cellst += Math.ceil(histp/pp)*dy;
    cellsr += Math.ceil(histp/pp)*dx;
    cellsb += Math.ceil(histp/pp)*dy;
    cellsl += Math.ceil(histp/pp)*dx;
    if (cellst < maxb) {
      cellst = maxt - maxb + cellst + 1;
    }
    if (cellst > maxt) {
      cellst = maxb + cellst - maxt - 1;
    }
    if (cellsr < maxl) {
      cellsr = maxr - maxl + cellsr + 1;
    }
    if (cellsr > maxr) {
      cellsr = maxl + cellsr - maxr - 1;
    }
    if (cellsb < maxb) {
      cellsb = maxt - maxb + cellsb + 1;
    }
    if (cellsb > maxt) {
      cellsb = maxb + cellsb - maxt - 1;
    }
    if (cellsl < maxl) {
      cellsl = maxr - maxl + cellsl + 1;
    }
    if (cellsl > maxr) {
      cellsl = maxl + cellsl - maxr - 1;
    }
    hist[histh][0][histi][10] = hist[q[2][0]][0][q[2][1]][10];
    calcWrld2();
    if (histp === 1) {
      q = prevHist(histh, histi);
      for (i = 0; i < cellslen; i++) {
        ci = cells[i];
        if (ci[3] === 1 && ci[2] === 0) {
          hist[q[0]][0][q[1]][0].push([ci[0],ci[1],-2,0,0]);
          ci[2] = gennum;
        }
      }
    }
    calcWrld3();
    hist[histh][0][histi][5] = mingen;
    hist[histh][0][histi][6] = cellst;
    hist[histh][0][histi][7] = cellsr;
    hist[histh][0][histi][8] = cellsb;
    hist[histh][0][histi][9] = cellsl;
  } else {
    if (cellsn === 0 || cellsxl === 0) {
      hbcksll = 0;
    } else if (hbcksl && hbcksll > 0) {
      if (hbckslf > 0) {
        hbckslf--;
      } else {
        hbckslf = hbcksl.length - 1;
      }
      if (hbcksll < hbcksl.length) {
        hbcksll++;
      } else {
        hbcksm.delete(hbcksl[hbckslf]);
      }
      hbcksl[hbckslf] = hist[histh][0][histi][10];
      hbcksm.set(hist[histh][0][histi][10], true);
    }
    if (c === 0 && cellsn === 0) {
      if (msgf1 !== 1 && msgf1 !== 2) {
        dspmsg(["Empty      ","\u22C5      \u22C5","      World"]);
        msgf1 = 1;
      }
    } else if (c > 0 && cellsn === 0) {
      if (msgf1 !== 2) {
        dspmsg(["Life      ","\u22C5      \u22C5","      Ended"]);
        msgf1 = 2;
      }
    } else if (cellsn > 0 && cellsxl === 0) {
      if (msgf1 !== 3) {
        dspmsg(["Still      ","\u22C5      \u22C5","      Life"], 4500, true);
        msgf1 = 3;
      }
    }
  }
  if (gennum === (stpga ? stpgnm === 0 ? stpgn : stpgnc + stpgn * stpgnm : -1)) {
    if (run) {
      swrun();
      if (stpgnm !== 0) {
        stpgnc = gennum;
      }
    }
    ffw = 0;
    genbbl = false;
    stpgcd2 = performance.now();
    stpgsf = false;
  }
}

function neighbours(x, y, f) {
  var n = 0, v;
  if ((v = fcidx(x,y+1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x,y+1,v);
  }
  if ((v = fcidx(x+1,y+1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x+1,y+1,v);
  }
  if ((v = fcidx(x+1,y)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x+1,y,v);
  }
  if ((v = fcidx(x+1,y-1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x+1,y-1,v);
  }
  if ((v = fcidx(x,y-1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x,y-1,v);
  }
  if ((v = fcidx(x-1,y-1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x-1,y-1,v);
  }
  if ((v = fcidx(x-1,y)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x-1,y,v);
  }
  if ((v = fcidx(x-1,y+1)) && v[0] === 1) {
    n++;
  } else if (f) {
    newnb(x-1,y+1,v);
  }
  return n;
}

function newnb(x, y, v) {
  var v0, x0 = x, y0 = y;
  if ((v0 = v) && v0[1] === 1) {
    return;
  }
  if (!v0) {
    v0 = fcidx(x, y, [0,1,0,0]);
  } else {
    v0[1] = 1;
  }
  if (x0 < maxl) {
    x0 = maxr - maxl + x0 + 1;
  }
  if (x0 > maxr) {
    x0 = maxl + x0 - maxr - 1;
  }
  if (y0 < maxb) {
    y0 = maxt - maxb + y0 + 1;
  }
  if (y0 > maxt) {
    y0 = maxb + y0 - maxt - 1;
  }
  cellsan++;
  if (cellsan > cellsa.length) {
    cellsa[cellsan-1] = [2, x0, y0, v0];
  } else {
    cellsa[cellsan-1][0] = 2;
    cellsa[cellsan-1][1] = x0;
    cellsa[cellsan-1][2] = y0;
    cellsa[cellsan-1][3] = v0;
  }
  if (ccruleb[(v0[3] = neighbours(x0, y0, false))] && ccrulebx) {
    cellsf = true;
    hist[histh][0][histi][0].push([x0,y0,-1,0,0]);
    cellsa[cellsan-1][0] = 0;
    if (x0 < cellsl) {
      cellsl = x0;
    }
    if (x0 > cellsr) {
      cellsr = x0;
    }
    if (y0 > cellst) {
      cellst = y0;
    }
    if (y0 < cellsb) {
      cellsb = y0;
    }
  }
}

function fpattbf(mode) {
  if (mode === 3) {
    clrvars();
  }
  fpattm = mode;
  fpatt = document.getElementById("patternt").value;
  fpattf = 1;
  fpattpos = 0;
  fpattd = {};
  fpattn = 0;
  fpatth = 0;
  fpatthx = 1;
  fpattw = 0;
  fpattnl = true;
  fpattnum = 0;
  fpattnr = true;
  fpattx = 0;
  fpattnx = 0;
  fpattnn = true;
  fpatta = [];
  document.getElementById("pattern").style.animation = "hidediv 0.5s ease-in forwards";
  patt = false;
}

function pattf1() {
  if (!fpatt || fpattpos >= fpatt.length) {
    if (fpattw > 0) {
      fpatth += fpatthx;
    }
    fpattf = 2;
    fpattnt = 0;
    fpattnx = fpattn;
    fpattz = 0;
    fpattzx = Math.floor(fpattw / 2);
    fpattzy = Math.floor(fpatth / 2);
    fpattzxp = cellX(posx,true);
    fpattzyp = cellY(posy,true);
    fpattz2 = 0;
    fpatta.sort(function(a,b) {
      var x1 = a[0] - fpattzx;
      var y1 = a[1] - fpattzy;
      var x2 = b[0] - fpattzx;
      var y2 = b[1] - fpattzy;
      if (Math.abs(x1)*Math.abs(y1) < Math.abs(x2)*Math.abs(y2)) {
        return -1;
      } else if (x1 === x2 && y1 === y2) {
        return 0;
      } else {
        return 1;
      }
    });
    return;
  }
  var c = fpatt[fpattpos], c2 = fpattpos < fpatt.length - 1 ? fpatt.substring(fpattpos,fpattpos+2) : "";
  var x;
  if (!(/^\d+$/.test(c))) {
    fpattnn = true;
  }
  if (c === "\n" || c === "\r") {
    fpattnl = true;
  } else if (fpattnl) {
    if (c.search(/\S|$/) === 0) {
      fpattnl = false;
      if (c === "#" ||  c2 === "x=" || c2 === "x ") {
        fpattpos += fpatt.substring(fpattpos).search(/\n|\r|$/);
        fpattnl = true;
      } else {
        fpattpos--;
      }
    }
  } else if (/^\d+$/.test(c)) {
    if (fpattnn) {
      fpattnum = 0;
      fpattnn = false;
    }
    fpattnum = fpattnum * 10 + parseInt(c);
  } else if (c === "!") {
    fpattpos = fpatt.length - 1;
  } else if (c === "$") {
    fpattnum === 0 ? fpatthx++ : fpatthx += fpattnum;
    fpattnr = true;
    fpattx = 0;
    fpattnum = 0;
  } else if (c === "b" || c === "." || c === "o" || c === "A") {
    if (fpattnr) {
      fpattnr = false;
      fpatth += fpatthx;
      fpatthx = 0;
    }
    x = fpattx;
    fpattnum === 0 ? fpattx++ : fpattx += fpattnum;
    fpattnum = 0;
    if (c === "o" || c === "A") {
      for (; x < fpattx; x++) {
        fpattd[""+x+"-"+(fpatth-1)] = true;
        fpattn++;
        fpatta.push([x,fpatth-1]);
      }
    }
    if (fpattx > fpattw) {
      fpattw = fpattx;
    }
  }
  fpattpos++;
}

function pattf2() {
  var zx = 0, zy = 0, v;
  if (fpattz2 >= fpatta.length) {
    fpattf = 0;
    var d = new Date();
    document.getElementById("patternt").value =
        "# "
      + d.getFullYear()    + "-"
      + (d.getMonth() + 1) + "-"
      + d.getDate()        + " "
      + d.getHours()       + ":"
      + d.getMinutes()     + ":"
      + d.getSeconds()     + " - "
      + (fpattm===1?"/Add":fpattm===2?"/Replace":"/Reset") + " - grid w" + fpattw + ",h" + fpatth +  " - " + fpattnx + " \"on\" cells - pos " + fpattzxp+","+fpattzyp + " - " + fpattnt + " cells switched on<>off"
      + "\r\n\r\n"
      + document.getElementById("patternt").value;
    return;
  }
  if (fpattm === 2 && fpattz < cellslen) {
    if (cells[fpattz][3] === 1) {
      zx = cells[fpattz][0] - fpattzxp;
      zy = fpattzyp - cells[fpattz][1];
      if (   fpattzx+zx >= 0 && fpattzx+zx < fpattw && fpattzy+zy >= 0 && fpattzy+zy < fpatth
          && !fpattd[""+(fpattzx+zx)+"-"+(fpattzy+zy)]) {
        toggleCellCR(fpattzxp+zx, fpattzyp-zy, fpattz+1);
        fpattnt++;
      }
    }
    fpattz++;
  } else if (fpattz2 < fpatta.length) {
    zx = fpatta[fpattz2][0] - fpattzx;
    zy = fpatta[fpattz2][1] - fpattzy;
    if (!((v = fcidx(fpattzxp+zx,fpattzyp-zy)) && v[0] === 1)) {
      toggleCellCR(fpattzxp+zx, fpattzyp-zy);
      fpattnt++;
    }
    fpattn--;
    fpattz2++;
  }
}

function crulecomp() {
  if (ccruleb === "") {
    ccrulebx = false;
  } else {
    for (i = 0; i < ccruleb.length; i++) {
      if (cruleb.indexOf(""+i) > -1) {
        ccruleb[i] = true;
      } else {
        ccruleb[i] = false;
      }
    }
  }
  if (ccrules === "") {
    ccrulesx = false;
  } else {
    for (i = 0; i < ccrules.length; i++) {
      if (crules.indexOf(""+i) > -1) {
        ccrules[i] = true;
      } else {
        ccrules[i] = false;
      }
    }
  }
}

function crulebut(f) {
  var i;
  if (f === 1) {
    cruleb = crulebn;
    crules = crulesn;
  }
  crulem = 0;
  document.getElementById("crule").style.display = "none";
}

function capHist() {
  var h, i, hi, n, q;
  h = histh;
  i = histi;
  n = histgn;
  if (histp > 0) {
    q = prevHist(histh, histi);
    if (hist[q[0]][0][q[1]][11][0] > 0 && histp < hist[q[0]][0][q[1]][11][1]) {
      histgn -= hist[q[0]][0][q[1]][11][1] - histp;
      hist[q[0]][0][q[1]][11][1] = histp;
      hist[histh][0][histi][0] = [];
      hist[histh][0][histi][1] = null;
      hist[histh][0][histi][3][0] = 0;
      hist[histh][0][histi][3][1] = 0;
    }
  }
  histgn -= hist[histh][0][histi][2];
  if (hist[histh][0][histi][11][0] > 0) {
    histgn -= hist[histh][0][histi][11][1] - 1;
  }
  while (histgn > 0) {
    nextHist();
    histgn -= hist[histh][0][histi][2] + 1;
    if (hist[histh][0][histi][11][0] > 0) {
      histgn -= hist[histh][0][histi][11][1] - 1;
    }
    hist[histh][0][histi] = null;
  }
  histh = h;
  histi = i;
  hi = hist[histh][0][histi];
  a = null;
  for (i = 0; i < hi[0].length; i++) {
    if (hi[0][i][4] !== 1) {
      a = [];
      break;
    }
  }
  if (a) {
    for (i = 0; i < hi[0].length; i++) {
      if (hi[0][i][4] === 1) {
        a.push(hi[0][i]);
      }
    }
    hi[0] = a;
  }
  hi[2] = 0;
  hi[11][0] = 0;
  hi[11][1] = 0;
  hi[11][2] = 0;
  hi[11][3] = 0;
  if (n > 0) {
    capcd2 = performance.now();
    capcds2 = ""+n;
  }
}

function prevGen() {
  var i, c, r, g, z, u, q, hi, v, p0, q0, pp, s, dx, dy, pg, x;
  if (histgp > 0) {
    clrcellsx();
    pg = gennum;
    x = stpga ? stpgnm === 0 ? stpgn : stpgnc + stpgn * stpgnm : -1;
    cruleb = histcr[0];
    crules = histcr[1];
    hi = hist[histh][0][histi];
    if ((u = hupdates()).length > 0) {
      capHist();
      appendHUpd(hi[0], u, hi[3][1]);
      hi[3][1]++;
      hi[5] = mingen;
      hi[6] = cellst;
      hi[7] = cellsr;
      hi[8] = cellsb;
      hi[9] = cellsl;
      hi[10] = hbckhac();
    }
    pp = 0;
    p0 = 0;
    dx = 0;
    dy = 0;
    if (histp > 0) {
      q = prevHist(histh, histi);
      pp = hist[q[0]][0][q[1]][11][0];
      p0 = hist[q[0]][0][q[1]][11][1];
      dx = hist[q[0]][0][q[1]][11][2];
      dy = hist[q[0]][0][q[1]][11][3];
    }
    if (histp === p0) {
      if (hi[1]) {
        cruleb = hi[1][0][0];
        crules = hi[1][0][1];
        histcr = [cruleb,crules];
        crulecomp();
      }
      i = hi[0].length - 1;
      while (i >= 0) {
        if (hi[0][i][4] === 1) {
          c = hi[0][i][0];
          r = hi[0][i][1];
          g = hi[0][i][2];
          z = ((v = fcidx(c,r)) ? v[0] === 1 ? v[2] : null : null);
          if (g >= 0) {
            if (z) {
              z--;
            } else {
              z = addCell(c,r);
              cells[z][3] = 0;
              fcidx(c,r,(v=[1,0,z+1,0]));
            }
            if (!cells[z] || cells[z][3] !== 1) {
              cellsn++;
            }
            if (cells[z]) {
              cells[z][0] = c;
              cells[z][1] = r;
              cells[z][2] = g;
              cells[z][3] = 1;
              cells[z][4] = v;
            } else {
              cells[z] = [c,r,g,1,v];
            }
          } else if (g === -1) {
            if (z) {
              z--;
              fcidx(c,r,1);
              if (cells[z] && cells[z][3] === 1) {
                cellsn--;
              }
              rmvCell(z);
            }
          } else if (g === -2) {
            if (z) {
              z--;
              cells[z][2] = 0;
            }
          }
        }
        i--;
      }
    }
    if (ffw === -1 && (ffwm === -1 || ffwm === 1) && histp > pp * 2 + 1) {
      i = Math.floor(histp / pp) - (pp===2?2:1);
      z = x >= 0 && x < gennum && gennum - x <= i * pp ? Math.floor((gennum - x - 1) / pp) : i;
      if (z > 0 && (dx || dy)) {
        for (i = 0; i < cellslen; i++) {
          if ((ci = cells[i])[3] === 1) {
            v = fcidx(ci[0], ci[1]);
            fcidx(ci[0], ci[1], 1);
            ci[0] -= dx * z;
            ci[1] -= dy * z;
            if (ci[0] < maxl) {
              ci[0] = maxr - maxl + ci[0] + 1;
            }
            if (ci[0] > maxr) {
              ci[0] = maxl + ci[0] - maxr - 1;
            }
            if (ci[1] < maxb) {
              ci[1] = maxt - maxb + ci[1] + 1;
            }
            if (ci[1] > maxt) {
              ci[1] = maxb + ci[1] - maxt - 1;
            }
            fcidx(ci[0], ci[1], v);
          }
        }
      }
      histp -= z * pp;
      gennum -= z * pp;
      histgp -= z * pp;
      histgn += z * pp;
      i = 0;
      while ((x < 0 || gennum - 1 !== x) && i < pp) {
        q = rlHist(histh, histi, histp);
        prevGen2(hist[q[0]][0][q[1]], s = histp%pp === 1, pp, dx, dy);
        if (s) {
          q = prevHist(histh, histi);
          prevGen2(hist[q[0]][0][q[1]], false, pp, dx, dy);
        }
        histp--;
        gennum--;
        histgp--;
        histgn++;
        i++;
      }
    }
    if (histp > 0) {
      q0 = rlHist(histh, histi, histp);
    }
    if (histp < 2) {
      q = prevHist(histh, histi);
      histh = q[0];
      histi = q[1];
      hi = hist[histh][0][histi];
      if (hi[1]) {
        hlcrcd3 = performance.now();
        hlcrcd = null;
        hlcrcd2 = null;
        cruleb = hi[1][1][0];
        crules = hi[1][1][1];
        histcr = [cruleb,crules];
        crulecomp();
      }
    }
    if (histp > 0) {
      prevGen2(hist[q0[0]][0][q0[1]], s = histp%pp === 1, pp, dx, dy);
      if (histp > 1) {
        hi = hist[q0[0]][0][q0[1]];
      }
      if (s) {
        if (histp > 1) {
          q = prevHist(histh, histi);
          prevGen2(hist[q[0]][0][q[1]], false, pp, dx, dy);
        } else {
          prevGen2(hi, false, 0, 0, 0);
        }
      }
      histp--;
      calcWrld3();
    } else {
      prevGen2(hi, false, 0, 0, 0);
      mingen = hi[5];
    }
    gennum--;
    histgp--;
    histgn++;
    if (histp === 0) {
      gennum -= hi[2];
      histgp -= hi[2];
      histgn += hi[2];
    }
    cellst = hi[6];
    cellsr = hi[7];
    cellsb = hi[8];
    cellsl = hi[9];
    if (histp > 0) {
      cellst += Math.ceil(histp/pp)*dy;
      cellsr += Math.ceil(histp/pp)*dx;
      cellsb += Math.ceil(histp/pp)*dy;
      cellsl += Math.ceil(histp/pp)*dx;
      if (cellst < maxb) {
        cellst = maxt - maxb + cellst + 1;
      }
      if (cellst > maxt) {
        cellst = maxb + cellst - maxt - 1;
      }
      if (cellsr < maxl) {
        cellsr = maxr - maxl + cellsr + 1;
      }
      if (cellsr > maxr) {
        cellsr = maxl + cellsr - maxr - 1;
      }
      if (cellsb < maxb) {
        cellsb = maxt - maxb + cellsb + 1;
      }
      if (cellsb > maxt) {
        cellsb = maxb + cellsb - maxt - 1;
      }
      if (cellsl < maxl) {
        cellsl = maxr - maxl + cellsl + 1;
      }
      if (cellsl > maxr) {
        cellsl = maxl + cellsl - maxr - 1;
      }
    } else {
      calcWrld2();
    }
    if (histp === 0 && histgp > 0) {
      q = prevHist(histh, histi);
      if (hist[q[0]][0][q[1]][11][0] > 0) {
        histp = hist[q[0]][0][q[1]][11][1];
      }
    }
    if (gennum === 0 && msgf1 === 0) {
      swstmsg("G \u22C5 e \u22C5 n  \u22C5 ", "\\ \u22C5 Z \u22C5 /  \u22C5  ");
      msgf1 = 11;
    }
    if (x >= 0 && x < pg && x >= gennum) {
      return true;
    }
  }
  return false;
}

function prevGen2(hi, s, pp, dx, dy) {
  var i, c, r, g, z, v, x;
  i = hi[0].length - 1;
  while (i >= 0) {
    if (hi[0][i][4] !== 1) {
      c = hi[0][i][0] + (histp===0||pp===0?0:Math.ceil(histp/pp)*dx);
      r = hi[0][i][1] + (histp===0||pp===0?0:Math.ceil(histp/pp)*dy);
      if (c < maxl) {
        c = maxr - maxl + c + 1;
      }
      if (c > maxr) {
        c = maxl + c - maxr - 1;
      }
      if (r < maxb) {
        r = maxt - maxb + r + 1;
      }
      if (r > maxt) {
        r = maxb + r - maxt - 1;
      }
      g = hi[0][i][2];
      z = ((v = fcidx(c,r)) ? v[0] === 1 ? v[2] : null : null);
      if (g >= 0) {
        if (histp > 0 && pp && g > gennum - histp) {
          g += Math.ceil(histp/pp);
        }
        if (z) {
          z--;
        } else {
          z = addCell(c,r);
          cells[z][3] = 0;
          fcidx(c,r,(v=[1,0,z+1,0]));
        }
        if (!cells[z] || cells[z][3] !== 1) {
          cellsn++;
        }
        if (cells[z]) {
          cells[z][0] = c;
          cells[z][1] = r;
          cells[z][2] = g;
          cells[z][3] = 1;
          cells[z][4] = v;
        } else {
          cells[z] = [c,r,g,1,v];
        }
      } else if (g === -1) {
        if (z) {
          z--;
          fcidx(c,r,1);
          if (cells[z] && cells[z][3] === 1) {
            cellsn--;
          }
          rmvCell(z);
        }
      } else if (g === -2 && !s) {
        if (z) {
          z--;
          cells[z][2] = 0;
        }
      }
    }
    i--;
  }
}

function nextGen() {
  var i, c, r, g, z, u, q, hi, v, p0, pp, s, dx, dy, pg, x;
  u = null;
  if ((u = hupdates()).length > 0
      || histgn < 1
      || cruleb !== histcr[0]
      || crules !== histcr[1]) {
    calcGen(u);
  } else {
    clrcellsx();
    pg = gennum;
    x = stpga ? stpgnm === 0 ? stpgn : stpgnc + stpgn * stpgnm : -1;
    pp = 0;
    p0 = 0;
    dx = 0;
    dy = 0;
    if (histp > 0) {
      q = prevHist(histh, histi);
      pp = hist[q[0]][0][q[1]][11][0];
      p0 = hist[q[0]][0][q[1]][11][1];
      dx = hist[q[0]][0][q[1]][11][2];
      dy = hist[q[0]][0][q[1]][11][3];
    }
    gennum++;
    histgp++;
    histgn--;
    s = false;
    if (histp === p0) {
      hi = hist[histh][0][histi];
      gennum += hi[2];
      histgp += hi[2];
      histgn -= hi[2];
      cruleb = histcr[0];
      crules = histcr[1];
      if (hi[1]) {
        hlcrcd = performance.now();
        hlcrcd2 = null;
        hlcrcd3 = null;
        cruleb = hi[1][1][0];
        crules = hi[1][1][1];
        histcr = [cruleb,crules];
        crulecomp();
      }
      histp = 0;
      nextGen2(hi, false, 0, 0, 0);
      pp = 0;
      p0 = 0;
      dx = 0;
      dy = 0;
      if ((pp = hi[11][0]) > 0) {
        p0 = hi[11][1];
        dx = hi[11][2];
        dy = hi[11][3];
        histp = 1;
        s = true;
      }
      nextHist();
    } else {
      histp++;
      if (s = histp%pp === 1) {
        q = prevHist(histh, histi);
        nextGen2(hist[q[0]][0][q[1]], false, pp, dx, dy);
      }
    }
    if (histp > 0) {
      q = rlHist(histh, histi, histp);
      hi = hist[q[2][0]][0][q[2][1]];
      nextGen2(hist[q[0]][0][q[1]], s, pp, dx, dy);
    }
    if ((x < 0 || x !== gennum) && ffw === 1 && (ffwm === -1 || ffwm === 1) && histp > 0 && histp < p0 - pp * 2 - 1) {
      i = Math.floor((p0 - histp) / pp) - (pp===2?2:1);
      z = x >= 0 && x > gennum && x - gennum <= i * pp ? Math.floor((x - gennum - 1) / pp) : i;
      if (z > 0 && (dx || dy)) {
        for (i = 0; i < cellslen; i++) {
          if ((ci = cells[i])[3] === 1) {
            v = fcidx(ci[0], ci[1]);
            fcidx(ci[0], ci[1], 1);
            ci[0] += dx * z;
            ci[1] += dy * z;
            if (ci[0] < maxl) {
              ci[0] = maxr - maxl + ci[0] + 1;
            }
            if (ci[0] > maxr) {
              ci[0] = maxl + ci[0] - maxr - 1;
            }
            if (ci[1] < maxb) {
              ci[1] = maxt - maxb + ci[1] + 1;
            }
            if (ci[1] > maxt) {
              ci[1] = maxb + ci[1] - maxt - 1;
            }
            fcidx(ci[0], ci[1], v);
          }
        }
      }
      histp += z * pp;
      gennum += z * pp;
      histgp += z * pp;
      histgn -= z * pp;
      i = 0;
      while (i < pp && x !== gennum) {
        histp++;
        gennum++;
        histgp++;
        histgn--;
        if (s = histp%pp === 1) {
          q = prevHist(histh, histi);
          nextGen2(hist[q[0]][0][q[1]], false, pp, dx, dy);
        }
        q = rlHist(histh, histi, histp);
        hi = hist[q[2][0]][0][q[2][1]];
        nextGen2(hist[q[0]][0][q[1]], s, pp, dx, dy);
        i++;
      }
    }
    if (histp === p0) {
      hi = hist[histh][0][histi];
      i = 0;
      while (i < hi[0].length) {
        if (hi[0][i][4] === 1) {
          c = hi[0][i][0];
          r = hi[0][i][1];
          g = hi[0][i][2];
          z = ((v = fcidx(c,r)) ? v[0] === 1 ? v[2] : null : null);
          if (g >= 0) {
            if (z) {
              z--;
              fcidx(c,r,1);
              if (cells[z] && cells[z][3] === 1) {
                cellsn--;
              }
              rmvCell(z);
            }
          } else if (g === -1) {
            if (z) {
              z--;
            } else {
              z = addCell(c,r);
              cells[z][3] = 0;
              fcidx(c,r,(v=[1,0,z+1,0]));
            }
            if (!cells[z] || !cells[z][3] !== 1) {
              cellsn++;
            }
            if (cells[z]) {
              cells[z][0] = c;
              cells[z][1] = r;
              cells[z][2] = 0;
              cells[z][3] = 1;
              cells[z][4] = v;
            } else {
              cells[z] = [c,r,0,1,v];
            }
          } else if (g === -2) {
            if (z) {
              z--;
              cells[z][2] = gennum;
            }
          }
        }
        i++;
      }
      mingen = hi[5];
    } else {
      calcWrld3();
    }
    cellst = hi[6];
    cellsr = hi[7];
    cellsb = hi[8];
    cellsl = hi[9];
    if (histp > 0) {
      if (histgn > 0) {
        cellst += Math.ceil(histp/pp)*dy;
        cellsr += Math.ceil(histp/pp)*dx;
        cellsb += Math.ceil(histp/pp)*dy;
        cellsl += Math.ceil(histp/pp)*dx;
        if (cellst < maxb) {
          cellst = maxt - maxb + cellst + 1;
        }
        if (cellst > maxt) {
          cellst = maxb + cellst - maxt - 1;
        }
        if (cellsr < maxl) {
          cellsr = maxr - maxl + cellsr + 1;
        }
        if (cellsr > maxr) {
          cellsr = maxl + cellsr - maxr - 1;
        }
        if (cellsb < maxb) {
          cellsb = maxt - maxb + cellsb + 1;
        }
        if (cellsb > maxt) {
          cellsb = maxb + cellsb - maxt - 1;
        }
        if (cellsl < maxl) {
         cellsl = maxr - maxl + cellsl + 1;
        }
        if (cellsl > maxr) {
          cellsl = maxl + cellsl - maxr - 1;
        }
      } else {
        calcWrld();
      }
    } else {
      calcWrld2();
    }
    if (x >= 0 && x > pg && x <= gennum) {
      return true;
    }
  }
  return false;
}

function nextGen2(hi, s, pp, dx, dy) {
  var i, c, r, g, z, v;
  i = 0;
  while (i < hi[0].length) {
    if (hi[0][i][4] !== 1) {
      c = hi[0][i][0] + (histp===0||pp===0?0:Math.ceil(histp/pp)*dx);
      r = hi[0][i][1] + (histp===0||pp===0?0:Math.ceil(histp/pp)*dy);
      if (c < maxl) {
        c = maxr - maxl + c + 1;
      }
      if (c > maxr) {
        c = maxl + c - maxr - 1;
      }
      if (r < maxb) {
        r = maxt - maxb + r + 1;
      }
      if (r > maxt) {
        r = maxb + r - maxt - 1;
      }
      g = hi[0][i][2];
      z = ((v = fcidx(c,r)) ? v[0] === 1 ? v[2] : null : null);
      if (g >= 0) {
        if (z) {
          z--;
          fcidx(c,r,1);
          if (cells[z] && cells[z][3] === 1) {
            cellsn--;
          }
          rmvCell(z);
        }
      } else if (g === -1) {
        if (z) {
          z--;
        } else {
          z = addCell(c,r);
          cells[z][3] = 0;
          fcidx(c,r,(v=[1,0,z+1,0]));
        }
        if (!cells[z] || cells[z][3] !== 1) {
          cellsn++;
        }
        if (cells[z]) {
          cells[z][0] = c;
          cells[z][1] = r;
          cells[z][2] = 0;
          cells[z][3] = 1;
          cells[z][4] = v;
        } else {
          cells[z] = [c,r,0,1,v];
        }
      } else if (g === -2 && !s) {
        if (z) {
          z--;
          cells[z][2] = gennum;
        }
      }
    }
    i++;
  }
}

function appendHUpd(a, b, c) {
  for (var i = 0; i < b.length; i++) {
    b[i][b[i].length] = c;
    a.push(b[i]);
  }
}

function fcidx(c, r, v, vx) {
  var n = Math.pow(2,cidxb[cidxbi][0].length+1), c2, r2, v2, d, c0 = c, r0 = r, u;
  if (c0 < maxl) {
    c0 = maxr - maxl + c0 + 1;
  }
  if (c0 > maxr) {
    c0 = maxl + c0 - maxr - 1;
  }
  if (r0 < maxb) {
    r0 = maxt - maxb + r0 + 1;
  }
  if (r0 > maxt) {
    r0 = maxb + r0 - maxt - 1;
  }
  if (!cidxbb || cidxbb[1] === 3 || c0 < cidxbx1 || c0 > cidxbx2 || r0 < cidxby1 || r0 > cidxby2) {
    cidxbb = fcidxb(cidxbi, cidxb[cidxbi][0].length-1, (c2 = Math.floor(c0/n)), (r2 = Math.floor(r0/n)));
    cidxbx1 = c2 * n;
    cidxby1 = r2 * n;
    cidxbx2 = cidxbx1 + n - 1;
    cidxby2 = cidxby1 + n - 1;
  }
  if (cidxbb[1] === 2) {
    cidxbb[2] = performance.now();
  }
  v2 = (cidxbb[1] === 1 ? cidxbb[0][c0-cidxbx1][r0-cidxby1] : null);
  if (v) {
    if (v === 3) {
      if (v2 && v2[0] === 1) {
        v2[1] = 0;
        v2[3] = 0;
        v = v2;
      } else {
        v = null;
      }
    }
    if (cellsxf) {
      u = 0;
      if (v === 1) {
        if (v2) {
          u = v2[0] === 1 ? -1 : 0;
          v2[0] = 0;
          v2[2] = 0;
          v = v2;
          if (v[3] === 0 && v[1] !== 2 && v[1] !== 3) {
            v[1] = 3;
            cellsx2l++;
            if (cellsx2l > cellsx2.length) {
              cellsx2[cellsx2l-1] = [v, c0, r0];
            } else {
              cellsx2[cellsx2l-1][0] = v;
              cellsx2[cellsx2l-1][1] = c0;
              cellsx2[cellsx2l-1][2] = r0;
            }
          }
        } else {
          v = null;
        }
      } else if (v === 2) {
        if (v2) {
          u = v2[0] === 1 ? 0 : 1;
          v2[0] = 1;
          v2[2] = vx;
          v = v2;
        } else {
          u = 1;
          v = [1, 0, vx, 0];
        }
      }
    }
    v = (cidxbb[0][c0-cidxbx1][r0-cidxby1] = (v === 1 ? null : v));
    if ((d = (v2 === null ? v === null ? 0 : 1 : v === null ? -1 : 0)) !== 0) {
      cidxbb[2] = (cidxbb[1] === 1 ? cidxbb[2] + d : d);
      if (cidxbb[1] === 1 && cidxbb[2] === 0) {
        fcidxafrl(cidxbb);
      } else if (cidxbb[1] === 2 && cidxbb[2] > 0) {
        frl[cidxbb[3]] = null;
        frlfs[frlfsl++] = cidxbb[3];
        cidxbb[1] = 1;
      }
    }
    if (cellsxf) {
      updnb(c0, r0, u);
    }
    return v;
  }
  return v2;
}

function fcidxb(bi, l, c, r) {
  var b, k, c2, r2, n, b1, b2, b3, b4, t, n2, k2, i, j, l2, c3, r3, k3;
  t = l === cidxb[bi][0].length - 1 && cidxb[bi][2] === -1;
  if (!t && (!cidxb[bi][0][l] || cidxb[bi][0][l][1] < 1)) {
    if (l === 0 && cidxb[bi][1] === -1) {
      cidxb[bi][0][l] = true;
      return null;
    } else if (l > 0) {
      if (cidxb[bi][0][l-1] === true) {
        cidxb[bi][0][l] = true;
        return null;
      } else {
        cidxb[bi][0][l] = null;
      }
    }
  }
  k = crkey(c,r);
  if (b = (cidxb[bi][0][l] && cidxb[bi][0][l] !== true ? cidxb[bi][0][l][0][k] : null)) {
    if (t) {
      return b;
    }
    cidxb[bi][0][l][0][k] = null;
    cidxb[bi][0][l][1]--;
    if (b[2] === 2) {
      frl[b[3]] = null;
      frlfs[frlfsl++] = b[3];
    }
    if (cidxb[bi][0][l][1] < 1) {
      if (l === 0 && cidxb[bi][1] === -1) {
        cidxb[bi][0][l] = true;
      } else if (l > 0) {
        if (cidxb[bi][0][l-1] === true) {
          cidxb[bi][0][l] = true;
        } else {
          cidxb[bi][0][l] = null;
        }
      }
    }
    if (b[1] === 1) {
      return b;
    }
    b = null;
  }
  if (cidxb[bi][0][l] === true) {
    return null;
  }
  if (l === 0) {
    if (cidxb[bi][1] > -1) {
      l2 = cidxb[cidxb[bi][1]][0].length-1;
      if (cidxb[cidxb[bi][1]][0][l2] === true) {
        cidxb[bi][1] = -1;
        cidxb[bi][3] = null;
      } else {
        n2 = Math.pow(2, l2+2);
        if (!cidxb[bi][3]) {
          cidxb[bi][3] = {};
        }
        c2 = Math.floor(c/(n2/4));
        r2 = Math.floor(r/(n2/4));
        k2 = crkey(c2,r2);
        if (!cidxb[bi][3][k2]) {
          cidxb[bi][3][k2] = true;
          if (b1 = fcidxb(cidxb[bi][1],l2,c2,r2)) {
            i = 0;
            while (i < n2) {
              j = 0;
              while (j < n2) {
                if (t || b1[0][i][j] || b1[0][i][j+1] || b1[0][i][j+2] || b1[0][i][j+3] || b1[0][i+1][j] || b1[0][i+1][j+1] || b1[0][i+1][j+2] || b1[0][i+1][j+3]|| b1[0][i+2][j] || b1[0][i+2][j+1] || b1[0][i+2][j+2] || b1[0][i+2][j+3]|| b1[0][i+3][j] || b1[0][i+3][j+1] || b1[0][i+3][j+2] || b1[0][i+3][j+3]) {
                  c3 = c2*n2/4+i;
                  r3 = r2*n2/4+j;
                  k3 = crkey(c3,r3);
                  b2 = [[[b1[0][i][j],b1[0][i][j+1],b1[0][i][j+2],b1[0][i][j+3]],[b1[0][i+1][j],b1[0][i+1][j+1],b1[0][i+1][j+2],b1[0][i+1][j+3]],[b1[0][i+2][j],b1[0][i+2][j+1],b1[0][i+2][j+2],b1[0][i+2][j+3]],[b1[0][i+3][j],b1[0][i+3][j+1],b1[0][i+3][j+2],b1[0][i+3][j+3]]],1,0,-1,null];
                  if (t || c3 !== c || r3 !== r) {
                    if (!cidxb[bi][0][l]) {
                      cidxb[bi][0][l] = [{},0];
                    }
                    cidxb[bi][0][l][0][k3] = b2;
                    cidxb[bi][0][l][1]++;
                  }
                  if (t) {
                    b2[4] = [k3,cidxb[bi][0][l]];
                  }
                  if (c3 === c && r3 === r) {
                    b = b2;
                  }
                  if (b1[0][i][j]) {
                    b2[2]++;
                  }
                  if (b1[0][i][j+1]) {
                    b2[2]++;
                  }
                  if (b1[0][i][j+2]) {
                    b2[2]++;
                  }
                  if (b1[0][i][j+3]) {
                    b2[2]++;
                  }
                  if (b1[0][i+1][j]) {
                    b2[2]++;
                  }
                  if (b1[0][i+1][j+1]) {
                    b2[2]++;
                  }
                  if (b1[0][i+1][j+2]) {
                    b2[2]++;
                  }
                  if (b1[0][i+1][j+3]) {
                    b2[2]++;
                  }
                  if (b1[0][i+2][j]) {
                    b2[2]++;
                  }
                  if (b1[0][i+2][j+1]) {
                    b2[2]++;
                  }
                  if (b1[0][i+2][j+2]) {
                    b2[2]++;
                  }
                  if (b1[0][i+2][j+3]) {
                    b2[2]++;
                  }
                  if (b1[0][i+3][j]) {
                    b2[2]++;
                  }
                  if (b1[0][i+3][j+1]) {
                    b2[2]++;
                  }
                  if (b1[0][i+3][j+2]) {
                    b2[2]++;
                  }
                  if (b1[0][i+3][j+3]) {
                    b2[2]++;
                  }
                }
                j += 4;
              }
              i += 4;
            }
          }
        }
      }
    }
    if (t && !b) {
      if (!cidxb[bi][0][l]) {
        cidxb[bi][0][l] = [{},0];
      }
      cidxb[bi][0][l][0][k] = (b = [[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],1,0,-1,[k,cidxb[bi][0][l]]]);
      cidxb[bi][0][l][1]++;
      fcidxafrl(b);
    }
  } else {
    n = Math.pow(2, l+2);
    if (cidxb[bi][0][l-1] !== true) {
      if (c < 0) {
        c2 = (c+1)*2-2;
      } else {
        c2 = c*2;
      }
      if (r < 0) {
        r2 = (r+1)*2-2;
      } else {
        r2 = r*2;
      }
      b1 = fcidxb(bi,l-1,c2,r2);
      b2 = fcidxb(bi,l-1,c2,r2+1);
      b3 = fcidxb(bi,l-1,c2+1,r2+1);
      b4 = fcidxb(bi,l-1,c2+1,r2);
      if (b1 || b2 || b3 || b4) {
        b = [[],1,0,-1,null];
        fcidxbc(n/2,b1,b,0,0);
        fcidxbc(n/2,b2,b,0,n/2);
        fcidxbc(n/2,b4,b,n/2,0);
        fcidxbc(n/2,b3,b,n/2,n/2);
      }
      if (!t && b && b[2] === 0) {
        b = null;
      }
    }
    if (t) {
      if (!b) {
        b = [[],1,0,-1,null];
        fcidxbc(n,null,b,0,0);
      }
      if (!cidxb[bi][0][l]) {
        cidxb[bi][0][l] = [{},0];
      }
      cidxb[bi][0][l][0][k] = b;
      cidxb[bi][0][l][1]++;
      b[4] = [k,cidxb[bi][0][l]];
      if (b[2] === 0) {
        fcidxafrl(b);
      }
    } else if (cidxb[bi][0][l-1] === true) {
      cidxb[bi][0][l] = true;
    }
  }
  return b;
}

function fcidxbc(n, s, t, c, r) {
  var i, j;
  i = 0;
  while (i < n) {
    if (!t[0][c+i]) {
      t[0][c+i] = [];
    }
    j = 0;
    while (j < n) {
      t[0][c+i][r+j] = s ? s[0][i][j] : null;
      j++;
    }
    i++;
  }
  if (s) {
    t[2] += s[2];
  }
}

function fcidxafrl(b) {
  b[1] = 2;
  b[2] = performance.now();
  b[3] = (frlfsl === 0 ? frll++ : frlfs[--frlfsl]);
  frl[b[3]] = b;
}

function crkey(c, r) {
  return (c-maxl) * 100000000 + r-maxb;
}

function updnb(c, r, n) {
  if (n !== 0) {
    updnb0(c-1,r+1,n);
    updnb0(c,r+1,n);
    updnb0(c+1,r+1,n);
    updnb0(c+1,r,n);
    updnb0(c+1,r-1,n);
    updnb0(c,r-1,n);
    updnb0(c-1,r-1,n);
    updnb0(c-1,r,n);
  }
}

function updnb0(c, r, n) {
  var v;
  if (!(v = fcidx(c, r))) {
    v = fcidx(c, r, [0, 2, 0, 0]);
    cellsxl++;
    if (cellsxl > cellsx.length) {
      cellsx[cellsxl-1] = [v, c, r];
    } else {
      cellsx[cellsxl-1][0] = v;
      cellsx[cellsxl-1][1] = c;
      cellsx[cellsxl-1][2] = r;
    }
  } else if (v[1] !== 2) {
    v[1] = 2;
    cellsxl++;
    if (cellsxl > cellsx.length) {
      cellsx[cellsxl-1] = [v, c, r];
    } else {
      cellsx[cellsxl-1][0] = v;
      cellsx[cellsxl-1][1] = c;
      cellsx[cellsxl-1][2] = r;
    }
  }
  v[3] += n;
}

function clrcellsx(f) {
  var i, v, cxi, ci;
  if (!f) {
    hbcksll = 0;
  }
  if (!cellsxf) {
    return;
  }
  cellsxf = false;
  for (i = 0; i < cellsxl; i++) {
    cxi = cellsx[i];
    if (cxi[0][0] !== 1 && cxi[0][3] === 0) {
      fcidx(cxi[1], cxi[2], 1);
    } else {
      cxi[0][1] = 0;
      cxi[0] = null;
    }
  }
  cellsxl = 0;
  for (i = 0; i < cellsx2l; i++) {
    if ((cxi = cellsx2[i])[0][1] === 3) {
      if (cxi[0][1] === 3 && cxi[0][0] !== 1 && cxi[0][3] === 0) {
        fcidx(cxi[1], cxi[2], 1);
      } else {
        cxi[0][1] = 0;
        cxi[0] = null;
      }
    }
  }
  cellsx2l = 0;
  if (!f) {
    for (i = 0; i < cellslen; i++) {
      if ((ci = cells[i])[3] === 1) {
        fcidx(ci[0],ci[1],3);
        fcidx(ci[0]-1,ci[1]+1,3);
        fcidx(ci[0],ci[1]+1,3);
        fcidx(ci[0]+1,ci[1]+1,3);
        fcidx(ci[0]+1,ci[1],3);
        fcidx(ci[0]+1,ci[1]-1,3);
        fcidx(ci[0],ci[1]-1,3);
        fcidx(ci[0]-1,ci[1]-1,3);
        fcidx(ci[0]-1,ci[1],3);
      }
    }
  }
}

function nextHist() {
  histi++;
  if (histi >= histmax) {
    histi = 0;
  }
  if (histi === hist[histh][1]) {
    if (histgn > 0 ) {
      histh = hist[histh][2];
      histi = hist[histh][1];
    } else if (histhm > hist.length - 1) {
      hist[histh][2] = hist.length;
      hist[hist.length] = [[],0,-1,histh];
      histh = hist.length - 1;
      histi = 0;
    } else {
      histh = histod;
      histi = hist[histh][1];
      histgp -= 1 + hist[histh][0][histi][2];
      if (hist[histh][0][histi][11][0] > 0) {
        histgp -= hist[histh][0][histi][11][1] - 1;
      }
      hist[histh][1]++;
      if (hist[histh][1] >= histmax) {
        hist[histh][1] = 0;
        if (hist[histh][2] === -1) {
          histod = 0;
        } else {
          histod = hist[histh][2];
        }
      }
    }
  }
}

function prevHist(h, i) {
  var h2, i2;
  h2 = h;
  i2 = i;
  if (i2 === hist[h2][1]) {
    if (hist[h2][3] === -1) {
      return [h2,i2];
    }
    h2 = hist[h2][3];
    i2 = hist[h2][1];
  };
  if (i2 > 0) {
    i2--;
  } else {
    i2 = histmax - 1;
  }
  return [h2,i2];
}

function rlHist(h, i, p, qx) {
  var q0, q1, q2, pp, m;
  q0 = null;
  q1 = qx ? qx : prevHist(h, i);
  q2 = prevHist(q1[0], q1[1]);
  pp = hist[q1[0]][0][q1[1]][11][0];
  m = p%pp;
  if (m > 0) {
    m = pp - m;
  }
  while (m >= 0) {
    if (hist[q2[0]][0][q2[1]][11][0] > 0) {
      q1 = rlHist(0, 0, hist[q2[0]][0][q2[1]][11][1], q2);
      q0 = q1[2];
    } else {
      q0 = q1;
      q1 = q2;
    }
    q2 = prevHist(q1[0], q1[1]);
    m--;
  }
  return [q1[0],q1[1],q0];
}

function rmvCell(i) {
  cellsfs[cellsfsl++] = i;
  cells[i][3] = 0 - cellsfsl + 1;
  cells[i][4] = null;
}

function addCell(c, r) {
  var i;
  while (cellsfsl > 0 && cellsfs[cellsfsl-1] === -1) {
    cellsfsl--;
  }
  if (cellsfsl === 0) {
    i=cellslen++;
    if (cellslen > cells.length) {
      cells[i] = [c,r,0,1,null];
    } else {
      cells[i][0] = c;
      cells[i][1] = r;
      cells[i][2] = 0;
      cells[i][3] = 1;
      cells[i][4] = null;
    }
  } else {
    i=cellsfs[--cellsfsl];
    cells[i][0] = c;
    cells[i][1] = r;
    cells[i][2] = 0;
    cells[i][3] = 1;
    cells[i][4] = null;
  }
  return i;
}

function revert() {
  if (hupdc === 0 && histp > 0) {
    q = prevHist(histh, histi);
    if (hist[q[0]][0][q[1]][11][0] > 0 && histp < hist[q[0]][0][q[1]][11][1]) {
      return false;
    }
  }
  var u = hupdates(), i, a, hi = hist[histh][0][histi], v, f, q;
  if ((f = u.length === 0) && hi[3][1] > 0) {
    hi[3][1]--;
    a = [];
    i = 0;
    while (i < hi[0].length) {
      if (hi[0][i][4] === 1 && hi[0][i][hi[0][i].length-1] === hi[3][1]) {
        u.push(hi[0][i]);
      } else {
        a.push(hi[0][i]);
      }
      i++;
    }
    hi[0] = a;
  }
  if ((i = u.length - 1) >= 0) {
    if (f) {
      capHist();
    }
    clrcellsx();
  }
  while (i >= 0) {
    c = u[i][0];
    r = u[i][1];
    g = u[i][2];
    z = ((v = fcidx(c,r)) ? v[0] === 1 ? v[2] : null : null);
    if (g >= 0) {
      if (z) {
        z--;
      } else {
        z = addCell(c,r);
        cells[z][3] = 0;
        fcidx(c,r,(v=[1,0,z+1,0]));
      }
      if (!cells[z] || cells[z][3] !== 1) {
        cellsn++;
      }
      if (cells[z]) {
        cells[z][0] = c;
        cells[z][1] = r;
        cells[z][2] = g;
        cells[z][3] = 1;
        cells[z][4] = v;
      } else {
        cells[z] = [c,r,g,1,v];
      }
    } else if (g === -1) {
      if (z) {
        z--;
        fcidx(c,r,1);
        if (cells[z] && cells[z][3] === 1) {
          cellsn--;
        }
        rmvCell(z);
      }
    } else if (g === -2) {
      if (z) {
        z--;
        cells[z][2] = 0;
      }
    }
    i--;
  }
  calcWrld();
  return true;
}

function dspmsg(m, d, f) {
  var i, j, tm;
  if (!dmsgs || !f && m[0] == msgl1 && m[1] == msgl2 && m[2] == msgl3) {
    drawMsgsStm(m[0], m[2]);
    return;
  }
  msgl1 = m[0];
  msgl2 = m[1];
  msgl3 = m[2];
  i = 0;
  j = 0;
  while (i < msgll) {
    while (i < msgll && msgl[i][0]) {
      i++;
    }
    if (i < msgll) {
      if (j < i) {
        j = i + 1;
      }
      while (j < msgll && !msgl[j][0]) {
        j++;
      }
      if (j < msgll) {
        msgl[i][0] = msgl[j][0];
        msgl[i][1] = msgl[j][1];
        msgl[i][2] = msgl[j][2];
        msgl[i][3] = msgl[j][3];
        msgl[i][4] = msgl[j][4];
        msgl[j][0] = null;
        msgl[j][4] = null;
      }
    }
    while (msgll > 0 && !msgl[msgll-1][0]) {
      msgll--;
    }
  }
  tm = [];
  for (i = 0; i < m.length; i++) {
    tm.push(ctx2.measureText(m[i]));
  }
  if (msgll < msgl.length) {
    msgl[msgll][0] = m;
    msgl[msgll][1] = d?d:3500;
    msgl[msgll][2] = performance.now();
    msgl[msgll][3] = 0;
    msgl[msgll][4] = tm;
    msgll++;
  } else {
    msgl[msgll++] = [m,d?d:3500,performance.now(),0,tm];
  }
}

function hbckhac() {
  var i, k, h, hb = [];
  if (cellsn === 0) {
    return 0;
  }
  for (i = 0; i < 256; i++) {
    hb[i] = 0;
  }
  for (i = 0; i < cellslen; i++) {
    if ((ci = cells[i])[3] === 1) {
      k = crkey(ci[0]-cellsl,ci[1]-cellsb);
      h = 0;
      h = ((h<<5)-h) + (k & 0xFF);
      h = h & h;
      h = ((h<<5)-h) + ((k>>>8) & 0xFF);
      h = h & h;
      h = ((h<<5)-h) + ((k>>>16) & 0xFF);
      h = h & h;
      h = ((h<<5)-h) + ((k>>>24) & 0xFF);
      h = h & h;
      hb[h & 0xFF] += ((h>>>24) & 0xF);
      hb[(h>>>8) & 0xFF] += ((h>>>16) & 0xF0);
      hb[(h>>>16) & 0xFF] += ((h>>>8) & 0xF);
      hb[(h>>>24) & 0xFF] += (h & 0xF0);
    }
  }
  h = 0;
  for (i = 0; i < hb.length; i++) {
    k = hb[i];
    h = ((h<<5)-h) + (k & 0xFF);
    h = h & h;
    h = ((2<<5)-h) + ((k>>>8) & 0xFF);
    h = h & h;
    h = ((h<<5)-h) + ((k>>>16) & 0xFF);
    h = h & h;
    h = ((h<<5)-h) + ((k>>>24) & 0xFF);
    h = h & h;
  }
  return h;
}

function hbckcheck(hi0) {
  var p, i, h, x, ci, n, hi, q, j, c, r, g, z, k, p0, q1, pp, dx, dy;
  if (!hbcksl || hbcksll < 3 || hbcksm && !hbcksm.has(hbcksl[hbckslf])) {
    return;
  }
  p = 0;
  h = hbcksl[hbckslf];
  i = hbckslf;
  while (p < 2 || p < hbcksll && h !== hbcksl[i]) {
    p++;
    i++;
    if (i >= hbcksl.length) {
      i = 0;
    }
  }
  if (p < hbcksll) {
    x = {};
    for (i = 0; i < cellslen; i++) {
      if ((ci = cells[i])[3] === 1) {
        x[crkey(ci[0],ci[1])] = true;
      }
    }
    p0 = 0;
    n = cellsn;
    q = [histh,histi];
    q0 = prevHist(q[0], q[1]);
    for (j = 1; j <= p; j++) {
      if (p0 > 0) {
        q1 = rlHist(q[0], q[1], p0--);
        hi = hist[q1[0]][0][q1[1]];
      } else {
        q = q0;
        q0 = prevHist(q[0], q[1]);
        hi = hist[q[0]][0][q[1]];
        if ((pp = hist[q0[0]][0][q0[1]][11][0]) > 0) {
          p0 = hist[q0[0]][0][q0[1]][11][1];
          dx = hist[q0[0]][0][q0[1]][11][2];
          dy = hist[q0[0]][0][q0[1]][11][3];
        }
      }
      i = hi[0].length - 1;
      while (i >= 0) {
        if (hi[0][i][4] !== 1) {
          c = hi[0][i][0] + (p0===0||pp===0?0:Math.ceil(p0/pp)*dx);
          r = hi[0][i][1] + (p0===0||pp===0?0:Math.ceil(p0/pp)*dy);
          if (c < maxl) {
            c = maxr - maxl + c + 1;
          }
          if (c > maxr) {
            c = maxl + c - maxr - 1;
          }
          if (r < maxb) {
            r = maxt - maxb + r + 1;
          }
          if (r > maxt) {
            r = maxb + r - maxt - 1;
          }
          g = hi[0][i][2];
          k = crkey(c,r);
          z = x[k];
          if (g >= 0) {
            if (!z) {
              x[k] = true;
              n++;
            }
          } else if (g === -1) {
            if (z) {
              x[k] = false;
              n--;
            }
          }
        }
        i--;
      }
    }
    if (n === cellsn) {
      dx = cellsl - hi[9];
      dy = cellsb - hi[8];
      i = 0;
      while (i < cellslen && ((ci = cells[i])[3] !== 1 || x[crkey(ci[0]-dx,ci[1]-dy)])) {
        i++;
      }
      if (i < cellslen) {
        n = -1;
      }
    } else {
      n = -1;
    }
    if (n === -1) {
      drawMsgsStm("\\  \\  \\  \\  \\", "/  /  /  /  /"); // false positive
      msgf1 = 911;
    } else {
      clrcellsx();
      hist[histh][0][histi][11][0] = p;
      hist[histh][0][histi][11][1] = 0;
      hist[histh][0][histi][11][2] = dx;
      hist[histh][0][histi][11][3] = dy;      
      if (dx === 0 && dy === 0) {
        dspmsg(["Oscillator!   ","\u22C5      \u22C5","p"+p+" "], 4500, true);
        msgf1 = 21;
      } else {
        dspmsg(["Spaceship!        ","\u22C5      \u22C5",spcshtxt(p,dx,dy)+"    "], 4500, true);
        msgf1 = 22;
      }
      histp = 1;
    }
  }
}

function spcshtxt(p, x, y) {
  var k, x0, y0, p0, n;
  x0 = Math.abs(x);
  y0 = Math.abs(y);
  k = Math.max(x0, y0);
  p0 = p;
  n = Math.min(k, p0);
  while (n > 1) {
    if (k / n === Math.floor(k / n) && p0 / n === Math.floor(p0 / n)) {
      break;
    }
    n--;
  }
  return ((k/n)>1?k/n:"")+"c/"+(p0/n)+" p"+p0+(x===0?"":" "+(x<0?"\u21E0":"\u21E2")+x0)+(y===0?"":(x===0?" ":"")+(y<0?"\u21E3":"\u21E1")+y0);
}

function swstmsg(s1, s2) {
  var i;
  if (!s1 && !s2) {
    s1 = "Y \u22C5 a \u22C5 g \u22C5 o \u22C5 l \u22C5 s \u22C5";
    s2 = "";
    for (i = 0; i < 7; i++) {
      if (Math.random() < 0.33) {
        s2 += "\u22C5  ";
      } else {
        s2 += "   ";
      }
    }
    s2 += "  \u22C5";
  }
  stmsgn1 = s1;
  stmsgn2 = s2;
  stmsgntm1 = null;
  stmsgntm2 = null; 
  if (stmsgcd2) {
    stmsgo1 = s1;
    stmsgo2 = s2;
    stmsgotm1 = null;
    stmsgotm2 = null;
  }
  if (!stmsgcd && !stmsgcd2) {
    stmsgcd = performance.now();
    stmsgcd2 = null;
  }
}

function updc() {
  var a, b, q;
  a = 0;
  b = hupdc > 0 ? 1 : 0;
  if (histp > 0) {
    q = prevHist(histh, histi);
  }
  if (histp === 0 || hist[q[0]][0][q[1]][11][0] === 0 || histp === hist[q[0]][0][q[1]][11][1]) {
    a += hist[histh][0][histi][3][0] + (cruleb !== histcr[0] || crules !== histcr[1] ? 1:0);
    b += hist[histh][0][histi][3][1];
  }
  return [a,b];
}

</script>
</html>